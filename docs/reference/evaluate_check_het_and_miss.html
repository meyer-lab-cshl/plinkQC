<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Evaluate results from PLINK missing genotype and heterozygosity rate check. — evaluate_check_het_and_miss • plinkQC</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Evaluate results from PLINK missing genotype and heterozygosity rate check. — evaluate_check_het_and_miss"><meta name="description" content="Evaluates and depicts results from plink –missing (missing genotype rates
per individual) and plink –het (heterozygosity rates per individual) via
run_check_heterozygosity and
run_check_missingness or externally conducted check.)
Non-systematic failures in genotyping and outlying heterozygosity (hz) rates
per individual are often proxies for DNA sample quality. Larger than expected
heterozygosity can indicate possible DNA contamination.
The mean heterozygosity in PLINK is computed as hz_mean = (N-O)/N, where
N: number of non-missing genotypes and O:observed number of homozygous
genotypes for a given individual.
Mean heterozygosity can differ between populations and SNP genotyping panels.
Within a population and genotyping panel, a reduced heterozygosity rate can
indicate inbreeding - these individuals will then be returned by
check_relatedness as individuals that fail the relatedness filters.
evaluate_check_het_and_miss creates a scatter plot with the
individuals' missingness rates on x-axis and their heterozygosity rates on
the y-axis."><meta property="og:description" content="Evaluates and depicts results from plink –missing (missing genotype rates
per individual) and plink –het (heterozygosity rates per individual) via
run_check_heterozygosity and
run_check_missingness or externally conducted check.)
Non-systematic failures in genotyping and outlying heterozygosity (hz) rates
per individual are often proxies for DNA sample quality. Larger than expected
heterozygosity can indicate possible DNA contamination.
The mean heterozygosity in PLINK is computed as hz_mean = (N-O)/N, where
N: number of non-missing genotypes and O:observed number of homozygous
genotypes for a given individual.
Mean heterozygosity can differ between populations and SNP genotyping panels.
Within a population and genotyping panel, a reduced heterozygosity rate can
indicate inbreeding - these individuals will then be returned by
check_relatedness as individuals that fail the relatedness filters.
evaluate_check_het_and_miss creates a scatter plot with the
individuals' missingness rates on x-axis and their heterozygosity rates on
the y-axis."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="standard" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plinkQC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="ho"><span class="fa fa-home"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-documentation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Documentation"><span class="fa fa-file"></span> Documentation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-documentation"><li><a class="dropdown-item" href="../articles/plinkQC.html">Step-by-step QC</a></li>
    <li><a class="dropdown-item" href="../articles/AncestryCheck.html">Ancestry</a></li>
    <li><a class="dropdown-item" href="../articles/HapMap.html">HapMap III reference</a></li>
    <li><a class="dropdown-item" href="../articles/Genomes1000.html">1000 Genomes reference</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> news</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/meyer-lab-cshl/plinkQC"><span class="fa fa-github fa-lg"></span> github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Evaluate results from PLINK missing genotype and heterozygosity rate check.</h1>
      <small class="dont-index">Source: <a href="https://github.com/meyer-lab-cshl/plinkQC/blob/HEAD/R/individualQC.R" class="external-link"><code>R/individualQC.R</code></a></small>
      <div class="d-none name"><code>evaluate_check_het_and_miss.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Evaluates and depicts results from plink –missing (missing genotype rates
per individual) and plink –het (heterozygosity rates per individual) via
<code><a href="run_check_heterozygosity.html">run_check_heterozygosity</a></code> and
<code><a href="run_check_missingness.html">run_check_missingness</a></code> or externally conducted check.)
Non-systematic failures in genotyping and outlying heterozygosity (hz) rates
per individual are often proxies for DNA sample quality. Larger than expected
heterozygosity can indicate possible DNA contamination.
The mean heterozygosity in PLINK is computed as hz_mean = (N-O)/N, where
N: number of non-missing genotypes and O:observed number of homozygous
genotypes for a given individual.
Mean heterozygosity can differ between populations and SNP genotyping panels.
Within a population and genotyping panel, a reduced heterozygosity rate can
indicate inbreeding - these individuals will then be returned by
check_relatedness as individuals that fail the relatedness filters.
<code>evaluate_check_het_and_miss</code> creates a scatter plot with the
individuals' missingness rates on x-axis and their heterozygosity rates on
the y-axis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">evaluate_check_het_and_miss</span><span class="op">(</span></span>
<span>  <span class="va">qcdir</span>,</span>
<span>  <span class="va">name</span>,</span>
<span>  imissTh <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>  hetTh <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  label_fail <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  highlight_samples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  highlight_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="st">"label"</span>, <span class="st">"color"</span>, <span class="st">"shape"</span><span class="op">)</span>,</span>
<span>  highlight_text_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  highlight_color <span class="op">=</span> <span class="st">"#c51b8a"</span>,</span>
<span>  highlight_shape <span class="op">=</span> <span class="fl">17</span>,</span>
<span>  legend_text_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  legend_title_size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  axis_text_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  axis_title_size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  title_size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  highlight_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-qcdir">qcdir<a class="anchor" aria-label="anchor" href="#arg-qcdir"></a></dt>
<dd><p>[character] path/to/directory/with/QC/results containing
name.imiss and name.het results as returned by plink –missing and plink
–het.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>[character] Prefix of PLINK files, i.e. name.bed, name.bim,
name.fam, name.het and name.imiss.</p></dd>


<dt id="arg-imissth">imissTh<a class="anchor" aria-label="anchor" href="#arg-imissth"></a></dt>
<dd><p>[double] Threshold for acceptable missing genotype rate in any
individual; has to be proportion between (0,1)</p></dd>


<dt id="arg-hetth">hetTh<a class="anchor" aria-label="anchor" href="#arg-hetth"></a></dt>
<dd><p>[double] Threshold for acceptable deviation from mean
heterozygosity in any individual. Expressed as multiples of standard
deviation of heterozygosity (het), i.e. individuals outside mean(het) +/-
hetTh*sd(het) will be returned as failing heterozygosity check; has to be
larger than 0.</p></dd>


<dt id="arg-label-fail">label_fail<a class="anchor" aria-label="anchor" href="#arg-label-fail"></a></dt>
<dd><p>[logical] Set TRUE, to add fail IDs as text labels in
scatter plot.</p></dd>


<dt id="arg-highlight-samples">highlight_samples<a class="anchor" aria-label="anchor" href="#arg-highlight-samples"></a></dt>
<dd><p>[character vector] Vector of sample IIDs to
highlight in the plot (p_het_imiss); all highlight_samples IIDs have to
be present in the IIDs of the name.fam file.</p></dd>


<dt id="arg-highlight-type">highlight_type<a class="anchor" aria-label="anchor" href="#arg-highlight-type"></a></dt>
<dd><p>[character]  Type of sample highlight, labeling
by IID ("text"/"label") and/or highlighting data points in different "color"
and/or "shape". "text" and "label" use ggrepel for minimal
overlap of text labels ("text) or label boxes ("label").  Only one of "text"
and "label" can be specified.Text/Label size can be specified with
highlight_text_size, highlight color with highlight_color,
or highlight shape with highlight_shape.</p></dd>


<dt id="arg-highlight-text-size">highlight_text_size<a class="anchor" aria-label="anchor" href="#arg-highlight-text-size"></a></dt>
<dd><p>[integer] Text/Label size for samples specified to
be highlighted (highlight_samples) by "text" or "label" (highlight_type).</p></dd>


<dt id="arg-highlight-color">highlight_color<a class="anchor" aria-label="anchor" href="#arg-highlight-color"></a></dt>
<dd><p>[character] Color for samples specified to
be highlighted (highlight_samples) by "color" (highlight_type).</p></dd>


<dt id="arg-highlight-shape">highlight_shape<a class="anchor" aria-label="anchor" href="#arg-highlight-shape"></a></dt>
<dd><p>[integer] Shape for samples specified to
be highlighted (highlight_samples) by "shape" (highlight_type). Possible
shapes and their encoding can be found at:
<a href="https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#sec:shape-spec" class="external-link">https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#sec:shape-spec</a></p></dd>


<dt id="arg-legend-text-size">legend_text_size<a class="anchor" aria-label="anchor" href="#arg-legend-text-size"></a></dt>
<dd><p>[integer] Size for legend text.</p></dd>


<dt id="arg-legend-title-size">legend_title_size<a class="anchor" aria-label="anchor" href="#arg-legend-title-size"></a></dt>
<dd><p>[integer] Size for legend title.</p></dd>


<dt id="arg-axis-text-size">axis_text_size<a class="anchor" aria-label="anchor" href="#arg-axis-text-size"></a></dt>
<dd><p>[integer] Size for axis text.</p></dd>


<dt id="arg-axis-title-size">axis_title_size<a class="anchor" aria-label="anchor" href="#arg-axis-title-size"></a></dt>
<dd><p>[integer] Size for axis title.</p></dd>


<dt id="arg-title-size">title_size<a class="anchor" aria-label="anchor" href="#arg-title-size"></a></dt>
<dd><p>[integer] Size for plot title.</p></dd>


<dt id="arg-highlight-legend">highlight_legend<a class="anchor" aria-label="anchor" href="#arg-highlight-legend"></a></dt>
<dd><p>[logical] Should a separate legend for the
highlighted samples be provided; only relevant for highlight_type == "color"
or highlight_type == "shape".</p></dd>


<dt id="arg-interactive">interactive<a class="anchor" aria-label="anchor" href="#arg-interactive"></a></dt>
<dd><p>[logical] Should plots be shown interactively? When
choosing this option, make sure you have X-forwarding/graphical interface
available for interactive plotting. Alternatively, set interactive=FALSE and
save the returned plot object (p_het_imiss) via ggplot2::ggsave(p=p_het_imiss
, other_arguments) or pdf(outfile) print(p_het_imiss) dev.off().</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>named [list] with i) fail_imiss dataframe containing FID (Family ID),
IID (Within-family ID), MISS_PHENO (Phenotype missing? (Y/N)), N_MISS (Number
of missing genotype call(s), not including obligatory missings), N_GENO (
Number of potentially valid call(s)), F_MISS (Missing call rate) of
individuals failing missing genotype check and ii) fail_het dataframe
containing FID (Family ID), IID (Within-family ID), O(HOM) (Observed number
of homozygotes), E(HOM) (Expected number of homozygotes), N(NM) (Number of
non-missing autosomal genotypes), F (Method-of-moments F coefficient
estimate) of individuals failing  outlying heterozygosity check; iii)
p_het_imiss, a ggplot2-object 'containing' a scatter plot with the samples'
missingness rates on x-axis and their heterozygosity rates on the y-axis,
which can be shown by print(p_het_imiss) and iv) plot_data, a data.frame with
the data visualised in p_het_imiss (iii).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>All, <code><a href="run_check_heterozygosity.html">run_check_heterozygosity</a></code>,
<code><a href="run_check_missingness.html">run_check_missingness</a></code> and
<code>evaluate_check_het_and_miss</code> can simply be invoked by
<code><a href="check_het_and_miss.html">check_het_and_miss</a></code>.</p>
<p>For details on the output data.frame fail_imiss and fail_het, check the
original description on the PLINK output format page:
<a href="https://www.cog-genomics.org/plink/1.9/formats#imiss" class="external-link">https://www.cog-genomics.org/plink/1.9/formats#imiss</a> and
<a href="https://www.cog-genomics.org/plink/1.9/formats#het" class="external-link">https://www.cog-genomics.org/plink/1.9/formats#het</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">qcdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"plinkQC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">name</span> <span class="op">&lt;-</span> <span class="st">"data"</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">fail_het_miss</span> <span class="op">&lt;-</span> <span class="fu">evaluate_check_het_and_miss</span><span class="op">(</span>qcdir<span class="op">=</span><span class="va">qcdir</span>, name<span class="op">=</span><span class="va">name</span>,</span></span>
<span class="r-in"><span>interactive<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#' # highlight samples</span></span></span>
<span class="r-in"><span><span class="va">highlight_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"keep_individuals"</span>,</span></span>
<span class="r-in"><span>package<span class="op">=</span><span class="st">"plinkQC"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fail_het_miss</span> <span class="op">&lt;-</span> <span class="fu">evaluate_check_het_and_miss</span><span class="op">(</span>qcdir<span class="op">=</span><span class="va">qcdir</span>, name<span class="op">=</span><span class="va">name</span>,</span></span>
<span class="r-in"><span>interactive<span class="op">=</span><span class="cn">FALSE</span>, highlight_samples <span class="op">=</span> <span class="va">highlight_samples</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>highlight_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="st">"color"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hannah Meyer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

