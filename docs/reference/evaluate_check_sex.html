<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Evaluate results from PLINK sex check. — evaluate_check_sex • plinkQC</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Evaluate results from PLINK sex check. — evaluate_check_sex"><meta property="og:description" content="Evaluates and depicts results from plink --check-sex (via
run_check_sex or externally conducted sex check).
Takes file qcdir/name.sexcheck and returns IIDs for samples whose
SNPSEX != PEDSEX (where the SNPSEX is determined by the heterozygosity rate
across X-chromosomal variants).
Mismatching SNPSEX and PEDSEX IDs can indicate plating errors, sample-mixup
or generally samples with poor genotyping. In the latter case, these IDs are
likely to fail other QC steps as well.
Optionally, an extra data.frame (externalSex) with sample IDs and sex can be
provided to double check if external and PEDSEX data (often processed at
different centers) match. If a mismatch between PEDSEX and SNPSEX was
detected while SNPSEX == Sex, PEDSEX of these individuals can optionally be
updated (fixMixup=TRUE).
evaluate_check_sex depicts the X-chromosomal heterozygosity (SNPSEX)
of the samples split by their (PEDSEX)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-standard navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plinkQC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-file"></span>
     
    documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/plinkQC.html">Step-by-step QC</a>
    </li>
    <li>
      <a href="../articles/AncestryCheck.html">Ancestry</a>
    </li>
    <li>
      <a href="../articles/HapMap.html">HapMap III reference</a>
    </li>
    <li>
      <a href="../articles/Genomes1000.html">1000 Genomes reference</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-code"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/meyer-lab-cshl/plinkQC" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evaluate results from PLINK sex check.</h1>
    <small class="dont-index">Source: <a href="https://github.com/meyer-lab-cshl/plinkQC/blob/HEAD/R/individualQC.R" class="external-link"><code>R/individualQC.R</code></a></small>
    <div class="hidden name"><code>evaluate_check_sex.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Evaluates and depicts results from plink --check-sex (via
<code><a href="run_check_sex.html">run_check_sex</a></code> or externally conducted sex check).
Takes file qcdir/name.sexcheck and returns IIDs for samples whose
SNPSEX != PEDSEX (where the SNPSEX is determined by the heterozygosity rate
across X-chromosomal variants).
Mismatching SNPSEX and PEDSEX IDs can indicate plating errors, sample-mixup
or generally samples with poor genotyping. In the latter case, these IDs are
likely to fail other QC steps as well.
Optionally, an extra data.frame (externalSex) with sample IDs and sex can be
provided to double check if external and PEDSEX data (often processed at
different centers) match. If a mismatch between PEDSEX and SNPSEX was
detected while SNPSEX == Sex, PEDSEX of these individuals can optionally be
updated (fixMixup=TRUE).
<code>evaluate_check_sex</code> depicts the X-chromosomal heterozygosity (SNPSEX)
of the samples split by their (PEDSEX).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">evaluate_check_sex</span><span class="op">(</span></span>
<span>  <span class="va">qcdir</span>,</span>
<span>  <span class="va">name</span>,</span>
<span>  maleTh <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  femaleTh <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  externalSex <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fixMixup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  indir <span class="op">=</span> <span class="va">qcdir</span>,</span>
<span>  externalFemale <span class="op">=</span> <span class="st">"F"</span>,</span>
<span>  externalMale <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>  externalSexSex <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>  externalSexID <span class="op">=</span> <span class="st">"IID"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  label_fail <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  highlight_samples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  highlight_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="st">"label"</span>, <span class="st">"color"</span>, <span class="st">"shape"</span><span class="op">)</span>,</span>
<span>  highlight_text_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  highlight_color <span class="op">=</span> <span class="st">"#c51b8a"</span>,</span>
<span>  highlight_shape <span class="op">=</span> <span class="fl">17</span>,</span>
<span>  highlight_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  legend_text_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  legend_title_size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  axis_text_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  axis_title_size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  title_size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  path2plink <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep_individuals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  remove_individuals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exclude_markers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extract_markers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  showPlinkOutput <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>qcdir</dt>
<dd><p>[character] /path/to/directory containing name.sexcheck as
returned by plink --check-sex.</p></dd>


<dt>name</dt>
<dd><p>[character] Prefix of PLINK files, i.e. name.bed, name.bim,
name.fam and name.sexcheck.</p></dd>


<dt>maleTh</dt>
<dd><p>[double] Threshold of X-chromosomal heterozygosity rate for
males.</p></dd>


<dt>femaleTh</dt>
<dd><p>[double] Threshold of X-chromosomal heterozygosity rate for
females.</p></dd>


<dt>externalSex</dt>
<dd><p>[data.frame, optional] with sample IDs [externalSexID] and
sex [externalSexSex] to double check if external and PEDSEX data (often
processed at different centers) match.</p></dd>


<dt>fixMixup</dt>
<dd><p>[logical] Should PEDSEX of individuals with mismatch between
PEDSEX and Sex, with Sex==SNPSEX automatically corrected: this will directly
change the name.bim/.bed/.fam files!</p></dd>


<dt>indir</dt>
<dd><p>[character] /path/to/directory containing the basic PLINK data
files name.bim, name.bed, name.fam files; only required of fixMixup==TRUE.
User needs writing permission to indir.</p></dd>


<dt>externalFemale</dt>
<dd><p>[integer/character] Identifier for 'female' in
externalSex.</p></dd>


<dt>externalMale</dt>
<dd><p>[integer/character] Identifier for 'male' in externalSex.</p></dd>


<dt>externalSexSex</dt>
<dd><p>[character] Column identifier for column containing sex
information in externalSex.</p></dd>


<dt>externalSexID</dt>
<dd><p>[character] Column identifier for column containing ID
information in externalSex.</p></dd>


<dt>verbose</dt>
<dd><p>[logical] If TRUE, progress info is printed to standard out.</p></dd>


<dt>label_fail</dt>
<dd><p>[logical] Set TRUE, to add fail IDs as text labels in
scatter plot.</p></dd>


<dt>highlight_samples</dt>
<dd><p>[character vector] Vector of sample IIDs to
highlight in the plot (p_sexcheck); all highlight_samples IIDs have to
be present in the IIDs of the name.fam file.</p></dd>


<dt>highlight_type</dt>
<dd><p>[character]  Type of sample highlight, labeling
by IID ("text"/"label") and/or highlighting data points in different "color"
and/or "shape". "text" and "label" use ggrepel for minimal
overlap of text labels ("text) or label boxes ("label").  Only one of "text"
and "label" can be specified. Text/Label size can be specified with
highlight_text_size, highlight color with highlight_color,
or highlight shape with highlight_shape.</p></dd>


<dt>highlight_text_size</dt>
<dd><p>[integer] Text/Label size for samples specified to
be highlighted (highlight_samples) by "text" or "label" (highlight_type).</p></dd>


<dt>highlight_color</dt>
<dd><p>[character] Color for samples specified to
be highlighted (highlight_samples) by "color" (highlight_type).</p></dd>


<dt>highlight_shape</dt>
<dd><p>[integer] Shape for samples specified to
be highlighted (highlight_samples) by "shape" (highlight_type). Possible
shapes and their encoding can be found at:
<a href="https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#sec:shape-spec" class="external-link">https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#sec:shape-spec</a></p></dd>


<dt>highlight_legend</dt>
<dd><p>[logical] Should a separate legend for the
highlighted samples be provided; only relevant for highlight_type == "color"
or highlight_type == "shape".</p></dd>


<dt>legend_text_size</dt>
<dd><p>[integer] Size for legend text.</p></dd>


<dt>legend_title_size</dt>
<dd><p>[integer] Size for legend title.</p></dd>


<dt>axis_text_size</dt>
<dd><p>[integer] Size for axis text.</p></dd>


<dt>axis_title_size</dt>
<dd><p>[integer] Size for axis title.</p></dd>


<dt>title_size</dt>
<dd><p>[integer] Size for plot title.</p></dd>


<dt>path2plink</dt>
<dd><p>[character] Absolute path to PLINK executable
(<a href="https://www.cog-genomics.org/plink/1.9/" class="external-link">https://www.cog-genomics.org/plink/1.9/</a>) i.e.
plink should be accessible as path2plink -h. The full name of the executable
should be specified: for windows OS, this means path/plink.exe, for unix
platforms this is path/plink. If not provided, assumed that PATH set-up works
and PLINK will be found by <code><a href="https://rdrr.io/pkg/sys/man/exec.html" class="external-link">exec</a></code>('plink').</p></dd>


<dt>keep_individuals</dt>
<dd><p>[character] Path to file with individuals to be
retained in the analysis. The file has to be a space/tab-delimited text file
with family IDs in the first column and within-family IDs in the second
column. All samples not listed in this file will be removed from the current
analysis. See <a href="https://www.cog-genomics.org/plink/1.9/filter#indiv" class="external-link">https://www.cog-genomics.org/plink/1.9/filter#indiv</a>.
Default: NULL, i.e. no filtering on individuals.</p></dd>


<dt>remove_individuals</dt>
<dd><p>[character] Path to file with individuals to be
removed from the analysis. The file has to be a space/tab-delimited text file
with family IDs in the first column and within-family IDs in the second
column. All samples listed in this file will be removed from the current
analysis. See <a href="https://www.cog-genomics.org/plink/1.9/filter#indiv" class="external-link">https://www.cog-genomics.org/plink/1.9/filter#indiv</a>.
Default: NULL, i.e. no filtering on individuals.</p></dd>


<dt>exclude_markers</dt>
<dd><p>[character] Path to file with makers to be
removed from the analysis. The file has to be a text file with a list of
variant IDs (usually one per line, but it's okay for them to just be
separated by spaces). All listed variants will be removed from the current
analysis. See <a href="https://www.cog-genomics.org/plink/1.9/filter#snp" class="external-link">https://www.cog-genomics.org/plink/1.9/filter#snp</a>.
Default: NULL, i.e. no filtering on markers.</p></dd>


<dt>extract_markers</dt>
<dd><p>[character] Path to file with makers to be
included in the analysis. The file has to be a text file with a list of
variant IDs (usually one per line, but it's okay for them to just be
separated by spaces). All unlisted variants will be removed from the current
analysis. See <a href="https://www.cog-genomics.org/plink/1.9/filter#snp" class="external-link">https://www.cog-genomics.org/plink/1.9/filter#snp</a>.
Default: NULL, i.e. no filtering on markers.</p></dd>


<dt>showPlinkOutput</dt>
<dd><p>[logical] If TRUE, plink log and error messages are
printed to standard out.</p></dd>


<dt>interactive</dt>
<dd><p>[logical] Should plots be shown interactively? When
choosing this option, make sure you have X-forwarding/graphical interface
available for interactive plotting. Alternatively, set interactive=FALSE and
save the returned plot object (p_sexcheck) via ggplot2::ggsave(p=p_sexcheck,
other_arguments) or pdf(outfile) print(p_sexcheck) dev.off().</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>named list with i) fail_sex: dataframe with FID, IID, PEDSEX, SNPSEX
and Sex (if externalSex was provided) of individuals failing sex check;
ii) mixup: dataframe with FID, IID, PEDSEX, SNPSEX and Sex (if externalSex
was provided) of individuals whose PEDSEX != Sex and Sex == SNPSEX; iii)
p_sexcheck, a ggplot2-object 'containing' a scatter plot of the X-chromosomal
heterozygosity (SNPSEX) of the individuals split by their (PEDSEX), which can
be shown by print(p_sexcheck) and iv) plot_data, a data.frame with the data
visualised in p_sexcheck (iii).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Both <code><a href="run_check_sex.html">run_check_sex</a></code> and <code>evaluate_check_sex</code> can
simply be invoked by <code><a href="check_sex.html">check_sex</a></code>.</p>
<p>For details on the output data.frame fail_sex, check the original
description on the PLINK output format page:
<a href="https://www.cog-genomics.org/plink/1.9/formats#sexcheck" class="external-link">https://www.cog-genomics.org/plink/1.9/formats#sexcheck</a>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">qcdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"plinkQC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">name</span> <span class="op">&lt;-</span> <span class="st">"data"</span></span></span>
<span class="r-in"><span><span class="va">path2plink</span> <span class="op">&lt;-</span> <span class="st">'/path/to/plink'</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">fail_sex</span> <span class="op">&lt;-</span> <span class="fu">evaluate_check_sex</span><span class="op">(</span>qcdir<span class="op">=</span><span class="va">qcdir</span>, name<span class="op">=</span><span class="va">name</span>, interactive<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>verbose<span class="op">=</span><span class="cn">FALSE</span>, path2plink<span class="op">=</span><span class="va">path2plink</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># highlight samples</span></span></span>
<span class="r-in"><span><span class="va">highlight_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"keep_individuals"</span>,</span></span>
<span class="r-in"><span>package<span class="op">=</span><span class="st">"plinkQC"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fail_sex</span> <span class="op">&lt;-</span> <span class="fu">evaluate_check_sex</span><span class="op">(</span>qcdir<span class="op">=</span><span class="va">qcdir</span>, name<span class="op">=</span><span class="va">name</span>, interactive<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>verbose<span class="op">=</span><span class="cn">FALSE</span>, path2plink<span class="op">=</span><span class="va">path2plink</span>,</span></span>
<span class="r-in"><span>highlight_samples <span class="op">=</span> <span class="va">highlight_samples</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>highlight_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"label"</span>, <span class="st">"color"</span><span class="op">)</span>, highlight_color <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hannah Meyer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

