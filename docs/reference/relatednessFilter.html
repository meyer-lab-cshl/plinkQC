<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Remove related individuals while keeping maximum number of individuals — relatednessFilter • plinkQC</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Remove related individuals while keeping maximum number of individuals — relatednessFilter"><meta name="description" content="relatednessFilter takes a data.frame with pair-wise relatedness
measures of samples and returns pairs of individual IDs that are related as
well as a list of suggested individual IDs to remove.
relatednessFilter finds pairs of samples whose relatedness estimate
is larger than the specified relatednessTh. Subsequently, for pairs of
individual that do not have additional relatives in the dataset, the
individual with the worse otherCriterionMeasure (if provided) or arbitrarily
individual 1 of that pair is selected and returned as the individual failing
the relatedness check. For more complex family structures, the unrelated
individuals per family are selected (e.g. in a simple case of a
parents-offspring trio, the offspring will be marked as fail, while the
parents will be kept in the analysis). Selection is achieved by constructing
subgraphs of clusters of individuals that are related.
relatednessFilter then finds the maximum independent set of vertices
in the subgraphs of related individuals. If all individuals are related (i.e.
all maximum independent sets are 0), one individual of that cluster will be
kept and all others listed as failIDs."><meta property="og:description" content="relatednessFilter takes a data.frame with pair-wise relatedness
measures of samples and returns pairs of individual IDs that are related as
well as a list of suggested individual IDs to remove.
relatednessFilter finds pairs of samples whose relatedness estimate
is larger than the specified relatednessTh. Subsequently, for pairs of
individual that do not have additional relatives in the dataset, the
individual with the worse otherCriterionMeasure (if provided) or arbitrarily
individual 1 of that pair is selected and returned as the individual failing
the relatedness check. For more complex family structures, the unrelated
individuals per family are selected (e.g. in a simple case of a
parents-offspring trio, the offspring will be marked as fail, while the
parents will be kept in the analysis). Selection is achieved by constructing
subgraphs of clusters of individuals that are related.
relatednessFilter then finds the maximum independent set of vertices
in the subgraphs of related individuals. If all individuals are related (i.e.
all maximum independent sets are 0), one individual of that cluster will be
kept and all others listed as failIDs."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="standard" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plinkQC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="ho"><span class="fa fa-home"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-documentation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Documentation"><span class="fa fa-file"></span> Documentation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-documentation"><li><a class="dropdown-item" href="../articles/plinkQC.html">Step-by-step QC</a></li>
    <li><a class="dropdown-item" href="../articles/AncestryCheck.html">Ancestry</a></li>
    <li><a class="dropdown-item" href="../articles/HapMap.html">HapMap III reference</a></li>
    <li><a class="dropdown-item" href="../articles/Genomes1000.html">1000 Genomes reference</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> news</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/meyer-lab-cshl/plinkQC"><span class="fa fa-github fa-lg"></span> github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Remove related individuals while keeping maximum number of individuals</h1>
      <small class="dont-index">Source: <a href="https://github.com/meyer-lab-cshl/plinkQC/blob/HEAD/R/utils.R" class="external-link"><code>R/utils.R</code></a></small>
      <div class="d-none name"><code>relatednessFilter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>relatednessFilter</code> takes a data.frame with pair-wise relatedness
measures of samples and returns pairs of individual IDs that are related as
well as a list of suggested individual IDs to remove.
<code>relatednessFilter</code> finds pairs of samples whose relatedness estimate
is larger than the specified relatednessTh. Subsequently, for pairs of
individual that do not have additional relatives in the dataset, the
individual with the worse otherCriterionMeasure (if provided) or arbitrarily
individual 1 of that pair is selected and returned as the individual failing
the relatedness check. For more complex family structures, the unrelated
individuals per family are selected (e.g. in a simple case of a
parents-offspring trio, the offspring will be marked as fail, while the
parents will be kept in the analysis). Selection is achieved by constructing
subgraphs of clusters of individuals that are related.
<code>relatednessFilter</code> then finds the maximum independent set of vertices
in the subgraphs of related individuals. If all individuals are related (i.e.
all maximum independent sets are 0), one individual of that cluster will be
kept and all others listed as failIDs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">relatednessFilter</span><span class="op">(</span></span>
<span>  <span class="va">relatedness</span>,</span>
<span>  otherCriterion <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">relatednessTh</span>,</span>
<span>  otherCriterionTh <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  otherCriterionThDirection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gt"</span>, <span class="st">"ge"</span>, <span class="st">"lt"</span>, <span class="st">"le"</span>, <span class="st">"eq"</span><span class="op">)</span>,</span>
<span>  relatednessIID1 <span class="op">=</span> <span class="st">"IID1"</span>,</span>
<span>  relatednessIID2 <span class="op">=</span> <span class="st">"IID2"</span>,</span>
<span>  relatednessFID1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  relatednessFID2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  relatednessRelatedness <span class="op">=</span> <span class="st">"PI_HAT"</span>,</span>
<span>  otherCriterionIID <span class="op">=</span> <span class="st">"IID"</span>,</span>
<span>  otherCriterionMeasure <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-relatedness">relatedness<a class="anchor" aria-label="anchor" href="#arg-relatedness"></a></dt>
<dd><p>[data.frame] containing pair-wise relatedness estimates
(in column [relatednessRelatedness]) for individual 1 (in column
[relatednessIID1] and individual 2 (in column [relatednessIID1]). Columns
relatednessIID1, relatednessIID2 and relatednessRelatedness have to present,
while additional columns such as family IDs can be present. Default column
names correspond to column names in output of plink –genome
(<a href="https://www.cog-genomics.org/plink/1.9/ibd" class="external-link">https://www.cog-genomics.org/plink/1.9/ibd</a>). All original
columns for pair-wise highIBDTh fails will be returned in fail_IBD.</p></dd>


<dt id="arg-othercriterion">otherCriterion<a class="anchor" aria-label="anchor" href="#arg-othercriterion"></a></dt>
<dd><p>[data.frame] containing a QC measure (in column
[otherCriterionMeasure]) per individual (in column [otherCriterionIID]).
otherCriterionMeasure and otherCriterionIID have to present, while additional
columns such as family IDs can be present. IIDs in relatednessIID1 have to
be present in otherCriterionIID.</p></dd>


<dt id="arg-relatednessth">relatednessTh<a class="anchor" aria-label="anchor" href="#arg-relatednessth"></a></dt>
<dd><p>[double] Threshold for filtering related individuals.
Individuals, whose pair-wise relatedness estimates are greater than this
threshold are considered related.</p></dd>


<dt id="arg-othercriterionth">otherCriterionTh<a class="anchor" aria-label="anchor" href="#arg-othercriterionth"></a></dt>
<dd><p>[double] Threshold for filtering individuals based on
otherCriterionMeasure. If related individuals fail this threshold they will
automatically be excluded.</p></dd>


<dt id="arg-othercriterionthdirection">otherCriterionThDirection<a class="anchor" aria-label="anchor" href="#arg-othercriterionthdirection"></a></dt>
<dd><p>[character] Used to determine the direction
for failing the otherCriterionTh. If 'gt', individuals whose
otherCriterionMeasure &gt; otherCriterionTh will automatically be excluded.
For pairs of individuals that have no other related samples in the cohort:
if both otherCriterionMeasure &lt; otherCriterionTh, the individual with the
larger otherCriterionMeasure will be excluded.</p></dd>


<dt id="arg-relatednessiid-">relatednessIID1<a class="anchor" aria-label="anchor" href="#arg-relatednessiid-"></a></dt>
<dd><p>[character] Column name of column containing the IDs
of the first individual.</p></dd>


<dt id="arg-relatednessiid-">relatednessIID2<a class="anchor" aria-label="anchor" href="#arg-relatednessiid-"></a></dt>
<dd><p>[character] Column name of column containing the IDs
of the second individual.</p></dd>


<dt id="arg-relatednessfid-">relatednessFID1<a class="anchor" aria-label="anchor" href="#arg-relatednessfid-"></a></dt>
<dd><p>[character, optional] Column name of column containing
the family IDs of the first individual; if only relatednessFID1 but not
relatednessFID2 provided, or none provided even though present in
relatedness, FIDs will not be returned.</p></dd>


<dt id="arg-relatednessfid-">relatednessFID2<a class="anchor" aria-label="anchor" href="#arg-relatednessfid-"></a></dt>
<dd><p>[character, optional] Column name of column containing
the family IDs of the second individual; if only relatednessFID2 but not
relatednessFID1 provided, or none provided even though present in
relatedness, FIDs will not be returned.</p></dd>


<dt id="arg-relatednessrelatedness">relatednessRelatedness<a class="anchor" aria-label="anchor" href="#arg-relatednessrelatedness"></a></dt>
<dd><p>[character] Column name of column containing
the relatedness estimate.</p></dd>


<dt id="arg-othercriterioniid">otherCriterionIID<a class="anchor" aria-label="anchor" href="#arg-othercriterioniid"></a></dt>
<dd><p>[character] Column name of column containing the
individual IDs.</p></dd>


<dt id="arg-othercriterionmeasure">otherCriterionMeasure<a class="anchor" aria-label="anchor" href="#arg-othercriterionmeasure"></a></dt>
<dd><p>[character] Column name of the column containing
the measure of the otherCriterion (for instance SNP missingness rate).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>[logical] If TRUE, progress info is printed to standard out.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>named [list] with i) relatednessFails, a [data.frame] containing the
data.frame relatedness after filtering for pairs of individuals in
relatednessIID1 and relatednessIID2, that fail the relatedness
QC; the data.frame is reordered with the fail individuals in column 1 and
their related individuals in column 2 and ii) failIDs, a [data.frame] with
the [IID]s (and [FID]s if provided) of the individuals that fail the
relatednessTh.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hannah Meyer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

