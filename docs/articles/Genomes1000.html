<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Processing 1000 Genomes reference data for ancestry estimation • plinkQC</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Processing 1000 Genomes reference data for ancestry estimation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="standard" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plinkQC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-documentation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-file"></span> documentation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-documentation">
<li><a class="dropdown-item" href="../articles/plinkQC.html">Step-by-step QC</a></li>
    <li><a class="dropdown-item" href="../articles/AncestryCheck.html">Ancestry</a></li>
    <li><a class="dropdown-item" href="../articles/HapMap.html">HapMap III reference</a></li>
    <li><a class="dropdown-item" href="../articles/Genomes1000.html">1000 Genomes reference</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> news</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/meyer-lab-cshl/plinkQC"><span class="fa fa-github fa-lg"></span> github</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Processing 1000 Genomes reference data for ancestry estimation</h1>
                        <h4 data-toc-skip class="author">Hannah
Meyer</h4>
            
            <h4 data-toc-skip class="date">2024-09-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/meyer-lab-cshl/plinkQC/blob/HEAD/vignettes/Genomes1000.Rmd" class="external-link"><code>vignettes/Genomes1000.Rmd</code></a></small>
      <div class="d-none name"><code>Genomes1000.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Genotype quality control for genetic association studies often
includes the need for selecting samples of the same ethnic background.
To identify individuals of divergent ancestry based on genotypes, the
genotypes of the study population can be combined with genotypes of a
reference dataset consisting of individuals from known ethnicities.
Principal component analysis (PCA) on this combined genotype panel can
then be used to detect population structure down to the level of the
reference dataset.</p>
<p>The following vignette shows the processing steps required to use
samples of the 1000 Genomes study <span class="citation">[1]</span>,<span class="citation">[2]</span> as a
reference dataset. Using the 1000 Genomes reference, population
structure down to large-scale continental ancestry can be detected. A
step-by-step instruction on how to conduct this ancestry analysis is
described in this <a href="https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html">Ancestry
estimation vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<div class="section level3">
<h3 id="set-up">Set-up<a class="anchor" aria-label="anchor" href="#set-up"></a>
</h3>
<p>We will first set up some bash variables and create directories
needed; storing the names and directories of the reference will make it
easy to use updated versions of the reference in the future. Is is also
useful to keep the PLINK log-files for future reference. In order to
keep the data directory tidy, we’ll create a directory for the log files
and move them to the log directory here after each analysis step.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="va">refdir</span><span class="op">=</span>~/reference</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$refdir</span>/plink_log</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plink-software">PLINK software<a class="anchor" aria-label="anchor" href="#plink-software"></a>
</h3>
<p>In addition to <a href="https://www.cog-genomics.org/plink/1.9/" class="external-link">PLINK v1.9</a>, which is
a requirment for the <code>plinkQC</code> package, we will also need <a href="https://www.cog-genomics.org/plink/2.0/" class="external-link">PLINK v2</a> for
processing the downloaded the dataset. In the following, when
<code>plink</code> is invoked, this corresponds to v1.9, whereas
<code>plink2</code> corresponds to v2.</p>
</div>
<div class="section level3">
<h3 id="download-and-decompress-1000-genomes-phase-3-data">Download and decompress 1000 Genomes phase 3 data<a class="anchor" aria-label="anchor" href="#download-and-decompress-1000-genomes-phase-3-data"></a>
</h3>
<p>1000 Genomes phase III (1000GenomesIII) is available in <a href="https://www.cog-genomics.org/plink/2.0/input#pgen" class="external-link">PLINK 2 binary
format</a> at <a href="https://www.cog-genomics.org/plink/2.0/resources#1kg_phase3" class="external-link uri">https://www.cog-genomics.org/plink/2.0/resources#1kg_phase3</a>.
In addition, a sample file with information about the individuals’
ancestry is available and should be downloaded as in input for
<code><a href="../reference/check_ancestry.html">plinkQC::check_ancestry()</a></code>. The following code chunk
downloads and decompresses the data. The genome build of these files is
the same as the original release of the 1000GenomesIII, namely
CGRCh37.</p>
<p>NB: CGRCh38 positions in vcf format can be found <a href="http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/supporting/GRCh38_positions/" class="external-link">here</a>.
The remainder of this vignette will however look at the data processing
required for the 1000GenomesIII available in <a href="https://www.cog-genomics.org/plink/2.0/input#pgen" class="external-link">PLINK 2 binary
format</a>.</p>
<p>NB: the links to the files below are the three boldfaced links on
this page: <a href="https://www.cog-genomics.org/plink/2.0/resources#1kg_phase3" class="external-link uri">https://www.cog-genomics.org/plink/2.0/resources#1kg_phase3</a>.
The dropbox links have been updated in the past, which means the links
below where outdated. Please refer to the original site and open an
issue on github if you notice a change. Thank you!</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="bu">cd</span> <span class="va">$refdir</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="va">pgen</span><span class="op">=</span>https://www.dropbox.com/s/j72j6uciq5zuzii/all_hg38.pgen.zst<span class="pp">?</span>dl=1</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="va">pvar</span><span class="op">=</span>https://www.dropbox.com/s/vx09262b4k1kszy/all_hg38.pvar.zst<span class="pp">?</span>dl=1</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="va">sample</span><span class="op">=</span>https://www.dropbox.com/s/2e87z6nc4qexjjm/all_hg38.psam<span class="pp">?</span>dl=1</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">wget</span> <span class="va">$pgen</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">mv</span> <span class="st">'all_hg38.pgen.zst?dl=1'</span> all_hg38.pgen.zst</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="ex">plink2</span> <span class="at">--zst-decompress</span> all_hg38.pgen.zst <span class="op">&gt;</span> all_hg38.pgen</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">wget</span> <span class="va">$pvar</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="fu">mv</span> <span class="st">'all_hg38.pvar.zst?dl=1'</span> all_hg38.pvar.zst</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="fu">wget</span> <span class="va">$sample</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="fu">mv</span> <span class="st">'all_hg38.psam?dl=1'</span> all_hg38.psam</span></code></pre></div>
<p>fter these steps, the 1000 Genomes dataset can be used for inferring
study ancestry as described in the corresponding <a href="https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html">Ancestry
estimation vignette</a>.</p>
<p>I think I should delete this? ## Convert 1000 Genomes phase 3 data to
plink 1 binary format We then convert the <a href="https://www.cog-genomics.org/plink/2.0/input#pgen" class="external-link">PLINK 2 binary
format</a> to the (at the moment) more standardly used <a href="https://www.cog-genomics.org/plink/1.9/inputbped" class="external-link">PLINK 1 binary
format</a>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">plink2</span> <span class="at">--pfile</span> <span class="va">$refdir</span>/all_hg38 vzs<span class="dt">\</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>      <span class="at">--max-alleles</span> 2 <span class="dt">\</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>      <span class="at">--make-bed</span> <span class="dt">\</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>      <span class="at">--allow-extra-chr</span> 0 <span class="dt">\</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>      <span class="at">--out</span> <span class="va">$refdir</span>/all_hg38</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">mv</span> <span class="va">$refdir</span>/all_hg38.log <span class="va">$refdir</span>/plink_log/all_hg38_convert.log</span></code></pre></div>
<p>A # References</p>
<div id="refs" class="references csl-bib-body">
<div id="ref-a1000Genomes2015" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">1000
Genomes Project Consortium. <span class="nocase">An integrated map of
structural variation in 2,504 human genomes</span>. Nature. 2015;526:
75–81. doi:<a href="https://doi.org/10.1038/nature15394" class="external-link">10.1038/nature15394</a>
</div>
</div>
<div id="ref-b1000Genomes2015" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">1000
Genomes Project Consortium. <span class="nocase">A global reference for
human genetic variation</span>. Nature. 2015;526: 75–81. doi:<a href="https://doi.org/10.1038/nature15393" class="external-link">10.1038/nature15393</a>
</div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hannah Meyer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
