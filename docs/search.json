[{"path":"https://meyer-lab-cshl.github.io/plinkQC/CODE_OF_CONDUCT.html","id":null,"dir":"","previous_headings":"","what":"Code of conduct","title":"Code of conduct","text":"contributors maintainers project, pledge respect people contribute reporting issues, posting feature requests, updating documentation, submitting pull requests, activities. committed making participation project harassment-free experience everyone, regardless level experience, gender, gender identity expression, sexual orientation, disability, personal appearance, body size, race, ethnicity, age, religion. Examples unacceptable behavior participants include use sexual language imagery, derogatory comments personal attacks, trolling, public private harassment, insults, unprofessional conduct. Project maintainers right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct. Project maintainers follow Code Conduct may removed project team. Code Conduct adapted Contributor Covenant (http://contributor-covenant.org), version 1.4.0, please refer Contributor Covenant Code Conduct.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"running-random-forest-classification","dir":"Articles","previous_headings":"","what":"Running Random Forest Classification","title":"Ancestry estimation based on reference samples of known ethnicities","text":"package contains function predict ancestry samples. works random forest algorithm trained principal components cleaned genomics data 1000 genomes dataset. method based ancestry identification scheme used Pan-UK BioBank analysis. Plink v2 needed portion package. addition, data repository containing necessary files running provided pre-trained classier : https://github.com/meyer-lab-cshl/plinkQCAncestryData/tree/main. Git Large File Storage extention needs pre-installed get correct files. can downloaded github : zip folder downloaded smaller size expected 251.3MB, run git lfs fetch make sure correct file gets downloaded. Unzip file future use.","code":"git clone git@github.com:meyer-lab-cshl/plinkQCAncestryData.git"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"workflow","dir":"Articles","previous_headings":"Running Random Forest Classification","what":"Workflow","title":"Ancestry estimation based on reference samples of known ethnicities","text":"begin example run classifier provided test data set. set temporary directory qcdir. use, study data new hg38 annotation. USCS’s liftOver tool may needed map variants one annotation another. details use tool can found processing HapMap III reference data vignette. addition, data PLINK 2.0 format (.e pgen, pvar, psam files), variants identifiers formatted similar following example: 1:12345[hg38]. can use included functions convert_to_plink2() rename_variant_identifiers() correctly format genomic data hg38 annotation. correctly formatting data, can use provided function return sample ids predicted ancestry.","code":"package.dir <- find.package('plinkQC') indir <- file.path(package.dir, 'extdata') qcdir <- tempdir() name <- 'data.hg38' path2plink2 <- \"/Users/syed/bin/plink2\" path2load_mat <- \"/Users/syed/Documents/loading_matrix\" convert_to_plink2(indir=indir, qcdir=qcdir, name=name,                    path2plink2 = path2plink2) rename_variant_identifiers(indir=qcdir, qcdir=qcdir, name=name,                             path2plink2 = path2plink2) name <- paste0(name, \".renamed\") ancestries <- superpop_classification(indir=qcdir, qcdir=qcdir, name=name,                                        path2plink2 = path2plink2,                                        path2load_mat = path2load_mat)  head(ancestries)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"training-your-own-random-forest-classifier","dir":"Articles","previous_headings":"","what":"Training Your Own Random Forest Classifier","title":"Ancestry estimation based on reference samples of known ethnicities","text":"Sometimes might enough overlap SNPs study dataset trained random forest algorithm accurate prediction. case, recommend training random forest. , first need set needed bash variables download 1000 genomes dataset qcdir described detail Processing 1000 Genomes reference data ancestry estimation. use test study dataset included package example workflow.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"setting-up-bash-script","dir":"Articles","previous_headings":"Training Your Own Random Forest Classifier","what":"Setting up Bash Script","title":"Ancestry estimation based on reference samples of known ethnicities","text":"","code":"qcdir='~/qcdir' name='data.hg38' refdir=~/reference  mkdir -r $qcdir/plink_log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"putting-study-data-in-qcdir","dir":"Articles","previous_headings":"Training Your Own Random Forest Classifier","what":"Putting study data in qcdir","title":"Ancestry estimation based on reference samples of known ethnicities","text":"Copy study dataset qcdir folder. example, assuming provided test dataset included package moved.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"renaming-variant-identifiers","dir":"Articles","previous_headings":"Training Your Own Random Forest Classifier","what":"Renaming variant identifiers","title":"Ancestry estimation based on reference samples of known ethnicities","text":"Variant identifiers can vary studies. ensure data can properly processed, rename variant identifiers common scheme based chromosome number basepair location.","code":"plink2 --bfile  $qcdir/all_hg38 \\       --set-all-var-ids \"@:#[hg38]\" \\       --rm-dup exclude-all \\       --make-pgen \\       --out $qcdir/all_hg38.renamed        plink2 --bfile  $qcdir/$name \\       --set-all-var-ids \"@:#[hg38]\" \\       --rm-dup exclude-all \\       --make-pgen \\       --out $qcdir/$name.renamed  mv $qcdir/all_hg38.renamed.log $qcdir/plink_log mv $qcdir/$name.renamed.log $qcdir/plink_log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"filtering-out-the-shared-snps-between-the-study-dataset-and-reference-1000g-dataset","dir":"Articles","previous_headings":"Training Your Own Random Forest Classifier","what":"Filtering out the shared SNPs between the study dataset and reference 1000G dataset","title":"Ancestry estimation based on reference samples of known ethnicities","text":", remove variants low minor allele count –maf function plink 2. conduct principal component analysis genetic variants pruned variants linkage disequilibrium (LD) r2>0.2r^2 >0.2 50kb window. LD-pruned dataset generated , using plink --indep-pairwise compute LD-variants; additionally exclude range used remove genomic ranges known high-LD structure. file originally provided [1] available file.path(find.package('plinkQC'),'extdata',' high-LD-regions-hg38-GRCh38.txt'). update reference data, need updated well. filtering low minor allele frequency pruning, extract principal components data. running PCA, project original dataset onto principal components. , used train random forest algorithm R. divide data 70% training portion 30% testing portion. ensure balanced model, sample data ensure even representation ancestral superpopulation group testing portion data. roughly 70% split data, 448 samples five ancestral groups. , can train random forest.","code":"cd $qcdir awk '{print $3}' $name.pvar > $name.varids.txt  plink2 --pfile all_hg38 --keep $name.varids.txt --make-pgen --out filtered_hg38 plink2 --pfile $qcdir/filtered_hg38\\        --maf \\        --nonfounders \\        --make-pgen \\        --out $qcdir/filtered_hg38.maf highld='high-LD-regions-hg38-GRCh38.txt'  plink2 --pfile filtered_hg38.renamed\\        --exclude range $qcdir/$highld \\        --indep-pairwise 50 5 0.2 \\        --out filtered_hg38.renamed  plink2 --pfile filtered_hg38.renamed \\        --extract filtered_hg38.renamed.prune.in \\        --make-pgen \\        --out filtered_hg38.pruned plink2 --pfile filtered_hg38.pruned \\        --nonfounders \\        --freq counts \\        --pca allele-wts 20 \\        --out filtered_hg38.pruned.pca plink2 --pfile filtered_hg38.pruned         --read-freq all_hg38.pca.acount         --score all_hg38.pca.eigenvec.allele 2 6 header-read no-mean-imputation variance-standardize         --score-col-nums 7-26 --out filtered_hg38.projection library(tidyverse) library(randomForest)  filepath <- '~/qcdir/filtered_hg38.projection.sscore' proj <- read.csv(   file= filepath,   sep='\\t', header = TRUE)  package.dir <- find.package('plinkQC') ancestry_info <-    read_delim(file.path(package.dir,\"extdata/Genomes1000_ID2Pop.txt\")) superpop <-    read_delim(file.path(package.dir,\"extdata/AncestryGeoLocations.csv\")) proj <- proj %>%   select(-c(ALLELE_CT, NAMED_ALLELE_DOSAGE_SUM)) colnames(proj) <- c(\"IID\", paste0(\"PC\", 1:20))  #turning ancestry info to have the superpopulation labeled_proj <- merge(proj, superpop_id)  n_individuals <- 448 set.seed(123) idx <- split(seq(nrow(labeled_proj)), labeled_proj$Ancestry)  train.ids <- lapply(idx, function(i) {   sample(i, n_individuals) })  ids_to_keeps<- unlist(train.ids, use.names = FALSE, recursive = FALSE) train_proj_1000g <- labeled_proj[ids_to_keeps,] train_proj_1000g$Ancestry <- factor(train_proj_1000g$Ancestry)  ancestry_rf <- randomForest(Ancestry ~ .,                         data = train_proj_1000g[,-c(2,23)],                          method = \"rf\",                          ntree = 750,                         importance = TRUE) ancestry_rf"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"predicting-ancestries-of-new-study-data","dir":"Articles","previous_headings":"Training Your Own Random Forest Classifier","what":"Predicting ancestries of new study data","title":"Ancestry estimation based on reference samples of known ethnicities","text":"predict ancestries new study dataset trained random forest, need project newdata onto principal components reference dataset. done –score function plink2. projection used input random forest. can clean data preparation used training random forest algorithm.","code":"plink2 --pfile newdata         --read-freq all_hg38.pca.acount         --score all_hg38.pca.eigenvec.allele 2 6 header-read no-mean-imputation variance-standardize         --score-col-nums 7-26 --out newdata.projection filepath <- \"Insert path to newdata.sscore here\" newdata <- read.csv(   file= filepath,    sep='\\t', header = TRUE)  newdata <- newdata %>%   select(-c(ALLELE_CT, NAMED_ALLELE_DOSAGE_SUM)) colnames(newdata) <- c(\"ID\", paste0(\"PC\", 1:20))  predictions <- predict(ancestry_rf, newdata)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"evalulating-and-tuning-classification","dir":"Articles","previous_headings":"Training Your Own Random Forest Classifier","what":"Evalulating and Tuning Classification","title":"Ancestry estimation based on reference samples of known ethnicities","text":"evaluate accuracy model, commonly used metric --bag error rate confusion matrix. confusion matrix displays number correct classifications ancestry along diagonal. values outside diagonal misclassifications ancestry. summary metrics can seen : can visualize confusion matrix heatmap.","code":"ancestry_rf my_rf <- ancestry_rf$confusion heatmap(my_rf[,-c(27)], scale = 'column', trace = 'none')"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"parameter-tuning","dir":"Articles","previous_headings":"","what":"Parameter Tuning","title":"Ancestry estimation based on reference samples of known ethnicities","text":"Tuning parameters random forest crucial building machine-learning model produce best forest, case highest accuracy.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"number-of-trees","dir":"Articles","previous_headings":"Parameter Tuning","what":"Number of Trees","title":"Ancestry estimation based on reference samples of known ethnicities","text":"random forest model comprised building several trees ‘Number trees’ parameter decides exactly many decision trees constitute random forest. Although exists positive relationship number trees predictive performance model, exists point continuing increase number trees longer find better prediction elongating computational efficiency. also exists tradeoff predictive performance computational efficiency. Excess trees also pose possible issue overfitting trees trained. important dataset test find point diminishing returns. example 1000 Genomes set, 500-1000 trees allows accurate predictions made, also staying computationally efficient.","code":"rf_100_trees <- randomForest(Ancestry ~ .,                    data = g_1000[,-c(1,21,22)],                     ntree = 100,                     method = \"rf\",                     importance = TRUE)  rf_500_trees <- randomForest(Ancestry ~ .,                    data = g_1000[,-c(1,21,22)],                     ntree = 500,                     method = \"rf\",                     importance = TRUE)    rf_10000_trees <- randomForest(Ancestry ~ .,                    data = g_1000[,-c(1,21,22)],                     ntree = 10000,                     method = \"rf\",                     mtry = best_mtry,                    importance = TRUE)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"mtry","dir":"Articles","previous_headings":"Parameter Tuning","what":"Mtry","title":"Ancestry estimation based on reference samples of known ethnicities","text":"mrty parameter controls number variables tried split. decision tree construcrion process, confirmation two trees look exactly must investiagted. specifically, mtry parameter controls number input features decision tree able consider moment tree construction controls much randomness added process. Testing different values mtry crucial can greatly impact model’s performance. every new split added node decision tree, mtry controls many PC variables allowed considered successive split. value mtry large model access features every split, much randomness model decision trees may look similar , reducing benefits building multiple independent decision trees. Two common heuristics choosing mtry value value parameter either square root log base 2 total number features. example , values end 4.47 4.32, respectively; 4 chosen avoid effect large mtry diminishes randomness model. , three mtry values tested best found value one smallest OOB error, saved best_mtry variable. iteration, mtry inflated deflated stepFactor value. improve specifies relative improvement OOB error rate must improved much search continue. trace specifies whether print progress search, plot says whether plot OOB error function mtry. can build random forest model using best saved mtry value.","code":"# This first line will provide the best mtry  mtry<- tuneRF(x = g_1000[,-c(1,21,22)], y = g_1000$Ancestry,                stepFactor = 1.5, improve = 0.01, trace = TRUE, plot = TRUE) best_mtry <- mtry[mtry[, 2] == min(mtry[, 2]), 1]  set.seed(123) rf_mtry <- randomForest(Ancestry ~ .,                         data = g_1000[,-c(1,21,22)],                          mtry = best_mtry,                          ntree = 1500,                         method = \"rf\",                          importance = TRUE) rf_mtry"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"k-fold-cross-validation","dir":"Articles","previous_headings":"Parameter Tuning > Mtry","what":"K-fold Cross Validation","title":"Ancestry estimation based on reference samples of known ethnicities","text":"Cross-validation used estimate skill machine learning model unseen data. tuning RF model, k-fold cross validation used split bootstrapped datasets random groups, holding one group test data training different models (individual decision trees) remaining groups, ‘k’ number folds/groups dataset. Using k=5 k=10 common usually arbitrarily chosen, depending size dataset. higher number folds tends lead accurate model splitting. example , k=10 10-fold cross-validation used, meaning 10 iterations model 500 decision trees, using different group test set remaining 9 groups training data model. 10 iterations complete, resulting iterations averaged find final cross-validation model random forest model. important test different values k exists tradeoff model accuracy computational expense. iteration requires entire model run, can get computationally expensive depending size dataset. documentation two different values k k-fold cross validation.","code":"set.seed(123) trainControl_5 <- trainControl(method = \"cv\",                           number = 5,                            search = \"grid\")                            forest_5 <- train(Ancestry ~ .,                data=g_1000[,-c(1,21,22)],                 method = \"rf\",                metric = \"Accuracy\",                trControl = trainControl_5                ) # Print out the model details                 forest_5$finalModel                        # Now for 10-fold cross validation     trainControl_10 <- trainControl(method = \"cv\",                           number = 10,                            search = \"grid\") forest_10 <- train(Ancestry ~ .,                data=g_1000[,-c(1,21,22)],                 method = \"rf\",                metric = \"Accuracy\",                trControl = trainControl_10                )                    # Print out model details rf_10_fold_cv <- forest_10$finalModel"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"evaluatinginterpretting-the-rf","dir":"Articles","previous_headings":"Parameter Tuning","what":"Evaluating/Interpretting the RF","title":"Ancestry estimation based on reference samples of known ethnicities","text":"found successful OOB error rate, can use package find important information regarding tree. documentation builds decision tree using categorical aspects classify data. PC values sample provided 1000 Genomes reference dataset file, sample values 20 distinct PCs. ask certain sample’s value specific PC less greater given number. Based answer, either classified specific ancestry needs undergo investigation classify correctly. comprehensability, subset decision tree random forest builds classifying 26 ancestries builds quite complicated cluttered plot.","code":"# This is a visual of the random forest being made.  # https://github.com/araastat/reprtree reprtree:::plot.getTree(rf_mtry) # Two different plots  reprtree:::plot.getTree(rf_mtry, k=1, d=5)  reprtree:::plot.getTree(rf_mtry, k=1, d=6)"},{"path":[]},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"ancestry-estimation","dir":"Articles","previous_headings":"","what":"Ancestry estimation","title":"Ancestry estimation based on reference samples of known ethnicities","text":"identification individuals divergent ancestry can achieved combining genotypes study population genotypes reference dataset consisting individuals known ethnicities (instance individuals Hapmap 1000 genomes study [6]). Principal componeanalysis (PCA) combined genotype panel can used detect population structure level reference dataset (Hapmap 1000 Genomes, large-scale continental ancestry). following, workflow combining study dataset reference samples, conducting PCA estimating ancestry demonstrated. study dataset consists 200 individuals 10,000 genetic markers provided plinkQCplinkQC file.path(find.package('plinkQC'),'extdata').","code":""},{"path":[]},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"download-reference-data","dir":"Articles","previous_headings":"Workflow","what":"Download reference data","title":"Ancestry estimation based on reference samples of known ethnicities","text":"suitable reference dataset downloaded necessary, re-formated PLINK format. Vignettes ‘Processing HapMap III reference data ancestry estimation’ ‘Processing 1000Genomes reference data ancestry estimation’, show download processing HapMap phase III 1000Genomes phase III dataset, respectively. example, use 1000Genomes data reference dataset.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"set-up","dir":"Articles","previous_headings":"Workflow","what":"Set-up","title":"Ancestry estimation based on reference samples of known ethnicities","text":"first set bash variables create directories needed; storing names directories reference study make easy use updated versions reference new datasets future. create directory named ‘qcdir’ study data. order keep data directory tidy, ’ll create directory log files move log directory analysis step. useful keep PLINK log-files future reference. created ‘qcdir’, sure copy data.bim, data.bed, data.fam files directory. using HapMap III reference data, sure use correct variable name; refname=‘HapMapIII’.","code":"qcdir=~/qcdir refdir=~/reference name='data' refname='all_hg38'  mkdir -p $qcdir/plink_log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"match-study-genotypes-and-reference-data","dir":"Articles","previous_headings":"Workflow","what":"Match study genotypes and reference data","title":"Ancestry estimation based on reference samples of known ethnicities","text":"order compute joint principal components reference study population, need combine two datasets. plink –merge function enables merge, requires variants datasets matching chromosome, position alleles. following sections show extract relevant data reference study dataset filter matching variants.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"filter-reference-and-study-data-for-non-a-t-or-g-c-snps","dir":"Articles","previous_headings":"Workflow > Match study genotypes and reference data","what":"Filter reference and study data for non A-T or G-C SNPs","title":"Ancestry estimation based on reference samples of known ethnicities","text":"use awk script find non-/T non-G/C SNPs, SNPs difficult align, remove reference study data sets. addition, keep autosomes (chr 1-22), keep snps (snps-), , keep biallelic ones (max-alleles 2), remove duplicates (rm-dup).","code":"awk 'BEGIN {OFS=\"\\t\"}  ($5$6 == \"GC\" || $5$6 == \"CG\" \\                         || $5$6 == \"AT\" || $5$6 == \"TA\")  {print $2}' \\     $qcdir/$name.bim  > \\     $qcdir/$name.ac_gt_snps awk 'BEGIN {OFS=\"\\t\"}  ($5$6 == \"GC\" || $5$6 == \"CG\" \\                         || $5$6 == \"AT\" || $5$6 == \"TA\")  {print $2}' \\     $refdir/$refname.bim  > \\     $qcdir/$refname.ac_gt_snps     plink2 --bfile  $refdir/$refname \\       --rm-dup exclude-all \\       --max-alleles 2 \\       --snps-only just-acgt \\       --exclude $qcdir/$refname.ac_gt_snps \\       --chr 1-22 \\       --make-bed \\       --out $qcdir/$refname.no_ac_gt_snps mv  $qcdir/$refname.no_ac_gt_snps.log $qcdir/plink_log/$refname.no_ac_gt_snps.log  plink2 --bfile  $qcdir/$name \\       --rm-dup exclude-all \\       --max-alleles 2 \\       --snps-only just-acgt \\       --exclude $qcdir/$name.ac_gt_snps \\       --make-bed \\       --chr 1-22 \\       --allow-extra-chr \\       --out $qcdir/$name.no_ac_gt_snps mv  $qcdir/$name.no_ac_gt_snps.log $qcdir/plink_log/$name.no_ac_gt_snps.log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"rename-variant-identifiers-to-common-scheme","dir":"Articles","previous_headings":"Workflow > Match study genotypes and reference data","what":"Rename Variant Identifiers to common scheme","title":"Ancestry estimation based on reference samples of known ethnicities","text":"Variant identifiers can vary studies /reference sets. computing genetic PC, annotation important, however, merging files via PLINK work variants perfectly matching attributes. instance, commonly used identifiers either rsIDs name constructed chr-position-alleles. , must ensure study reference sets use identifiers order merge renaming variants using chromosome position, followed genome build. might introduce additional duplicates (e.g. identifiers now identical tri-allelic variants caught previous step), also remove duplicates .","code":"plink2 --bfile  $qcdir/$name.no_ac_gt_snps \\       --set-all-var-ids @:#[hg38] \\       --rm-dup exclude-all \\       --make-bed \\       --out $qcdir/$name.renamed mv  $qcdir/$name.renamed.log $qcdir/plink_log  plink2 --bfile  $qcdir/$refname.no_ac_gt_snps \\       --set-all-var-ids @:#[hg38] \\       --rm-dup exclude-all \\       --make-bed \\       --out $qcdir/$refname.renamed mv  $qcdir/$refname.renamed.log $qcdir/plink_log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"prune-study-data","dir":"Articles","previous_headings":"Workflow > Match study genotypes and reference data","what":"Prune study data","title":"Ancestry estimation based on reference samples of known ethnicities","text":"conduct principal component analysis genetic variants pruned variants linkage disequilibrium (LD) r2>0.2r^2 >0.2 50kb window. LD-pruned dataset generated , using plink --indep-pairwise compute LD-variants; additionally exclude range used remove genomic ranges known high-LD structure. file originally provided [1] available file.path(find.package('plinkQC'),'extdata',' high-LD-regions-hg38-GRCh38.txt'). update reference data, need updated well.","code":"highld='high-LD-regions-hg38-GRCh38.txt'  plink --bfile  $qcdir/$name.renamed \\       --exclude range  $qcdir/$highld \\       --indep-pairwise 50 5 0.2 \\       --out $qcdir/$name.renamed mv  $qcdir/$name.renamed.log $qcdir/plink_log/$name.renamed.prune.log plink --bfile  $qcdir/$name.renamed \\       --extract $qcdir/$name.renamed.prune.in \\       --make-bed \\       --out $qcdir/$name.pruned mv  $qcdir/$name.pruned.log $qcdir/plink_log/$name.pruned.log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"filter-reference-data-for-the-same-snp-set-as-in-study","dir":"Articles","previous_headings":"Workflow > Match study genotypes and reference data","what":"Filter reference data for the same SNP set as in study","title":"Ancestry estimation based on reference samples of known ethnicities","text":"use list pruned variants study sample reduce reference dataset size study samples:","code":"plink --bfile  $qcdir/$refname.renamed \\       --extract $qcdir/$name.renamed.prune.in \\       --make-bed \\       --out $qcdir/$refname.pruned mv  $qcdir/$refname.pruned.log $qcdir/plink_log/$refname.pruned.log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"merge-study-genotypes-and-reference-data","dir":"Articles","previous_headings":"Workflow","what":"Merge study genotypes and reference data","title":"Ancestry estimation based on reference samples of known ethnicities","text":"matching study reference dataset can now merged combined dataset plink –bmerge. steps outlined conducted successfully, mismatch errors occur.","code":"plink --bfile $qcdir/$name.pruned \\       --bmerge $qcdir/$refname.pruned \\       --out $qcdir/$name.merge.$refname \\       --merge-mode 6 mv $qcdir/$name.merge.$refname.log $qcdir/plink_log/$name.merge.$refname.missnp.log  plink --bfile $qcdir/$name.pruned  \\       --bmerge $qcdir/$refname.pruned \\       --exclude $qcdir/$name.merge.$refname.missnp \\       --make-bed \\       --out $qcdir/$name.merge.$refname mv $qcdir/$name.merge.$refname.log $qcdir/plink_log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"pca-on-the-merged-data","dir":"Articles","previous_headings":"Workflow","what":"PCA on the merged data","title":"Ancestry estimation based on reference samples of known ethnicities","text":"can now run principal component analysis combined dataset using plink --pca returns .eigenvec file family individual ID columns 1 2, followed first 20 principal components.","code":"plink --bfile $qcdir/$name.merge.$refname \\       --pca \\       --out $qcdir/$name.$refname mv $qcdir/$name.$refname.log $qcdir/plink_log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"check-ancestry","dir":"Articles","previous_headings":"Workflow","what":"Check ancestry","title":"Ancestry estimation based on reference samples of known ethnicities","text":"can use .eigenvec file estimate ancestry study samples. Identifying individuals divergent ancestry implemented check_ancestry. Currently, check ancestry supports automatic selection individuals European descent. uses principal components 1 2 find center known European reference samples. study samples whose Euclidean distance centre falls outside radius specified maximum Euclidean distance reference samples multiplied chosen europeanTh considered non-European. check_ancestry shows result ancestry analysis scatter plot PC1 versus PC2, colour-coded samples reference populations study population. Reminder, using HapMapIII reference data, refname reference name used previously. Also, files use “/HapMap_ID2Pop.txt” instead Genomes1000_ID2Pop “HapMap_PopColors.txt” instead Genomes1000_PopColors.txt. Note: vignette provides 1000Genomes annotation files, HapMapIII annotation files. choose use either 1000Genomes HapMapIII reference population data, can simply use color mapping files work. , must provide function. example color scheme 1000 Genomes reference data found ‘1000Genomes_PopColors.txt’. within R, run following command ancestry check. 1000 Genomes Data.  steps, .eigenvec file can used build random forest. steps process described [link next vignette]. now, putting Random Forest documentation .","code":"library(plinkQC) indir <- system.file(\"extdata\", package=\"plinkQC\") qcdir <- \"~/qcdir\" name <- 'data' refname <- 'all_hg38' prefixMergedDataset <- paste(name, \".\", refname, sep=\"\")  exclude_ancestry <-     evaluate_check_ancestry(indir=qcdir, name=name,                             prefixMergedDataset=prefixMergedDataset,                             refSamplesFile=paste(indir,                                                   \"/Genomes1000_ID2Pop.txt\",                                                  sep=\"\"),                              refColorsFile=paste(indir,                                                  \"/Genomes1000_PopColors.txt\",                                                 sep=\"\"),                             interactive=TRUE)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"random-forest-classification","dir":"Articles","previous_headings":"Workflow","what":"Random Forest Classification","title":"Ancestry estimation based on reference samples of known ethnicities","text":"previous Ancestry estimation vignette performed PCA combined study reference dataset identified individuals European descent based clustering data first second PC space. two dimensional space, adequate identification individuals ancestries. vignette, train random forest classifier uses 20 PCs sufficiently estimate study samples’ ancestry based ancestry reference dataset. use .eigenvec file created preparing files ancestry estimation, read dataframe. file contains eigenvectors PCA LD-pruned genotype data. .eigenvec file included eigenvalues per PC individual include information regarding individual’s ancestries. Therefore, file available plinkQC download, contains dataframe individual’s ID, family ID, associated ancestry must obtained read , obtained 1000 Genomes database. two files joined ID filtered remove IDs genetic data available. file paths must change!!! , read files corresponding data frames. PC, training data, ancestry files correctly formatted, ancestry file filtered remove IDs corresponding genetic data, files joined ID. documentation provides visuals ancestry data understanding making histogram, hist, individuals per ancestry data set. random forest classification, original data set split training testing subsets. , 20 individuals ancestry chosen random avoid representation one ancestry split, shown test_hist. 20 individuals saved removed data set create two distinct sets, ancestries converted factor instead categorical value. Now files correctly formatted, able run random forest classification Ancestry data object. documentation . provides documentation heatmap ancestries. heatmap, may see false estimations. next section allow us tune random forest attempt improve accuracy.","code":"Definitely do not need all of these:   library(plinkQC) library(readr) library(dplyr) library(ggplot2) library(randomForest) require(caTools) library(caret) library(tidyverse) library(pipeR) library(rlist) # Read in both data frames  g_1000 <- read_delim('~/Ancestry/build_forest/train_data', col_names = FALSE) ancestry_info <- read_delim(\"~/Ancestry/build_forest/Genomes1000_ID2Pop.txt\") g_1000 <- g_1000 %>%   select(-X1) colnames(g_1000) <- c(\"ID\", paste0(\"PC\", 1:20)) colnames(ancestry_info) <- c(\"Fam_ID\", \"ID\", \"Ancestry\") ancestry_info <- ancestry_info %>% filter(ancestry_info$ID %in% g_1000$ID) g_1000 <- g_1000 %>%    left_join(ancestry_info) ancestries <- as.factor(g_1000$Ancestry) hist <- ggplot(data.frame(ancestries), aes(x = ancestries)) + geom_bar()  # Sample 20 ancestry sepcific individuals n_individuals <- 20 set.seed(123) idx <- split(seq(nrow(ancestry_info)), ancestry_info$Ancestry)  # I changed this to use g_1000 instead of ancestry_info, because ancestry_info # was creating samples that were above the 2584 samples that are in g_1000  test.ids <- lapply(idx, function(i) {   sample(i, n_individuals) })  # For each population, it extracts the ids that were sampled above ancestry.test <- ancestry_info$Ancestry[unlist(test.ids)] # Histogram of testing set to show sampling was successful.  test_hist <- ggplot(data.frame(ancestry.test), aes(x = ancestry.test)) + geom_bar()  # Remove the `test.ids` from `g_1000` and `ancestry_info` data objects.  ids_to_remove <- unlist(test.ids, use.names = FALSE, recursive = FALSE) g_1000 <- g_1000[-ids_to_remove,] ancestry_info <- ancestry_info[-ids_to_remove,]  # Covert Ancestry value to a factor instead of categorical value.  g_1000$Ancestry <- factor(g_1000$Ancestry) rf <- randomForest(Ancestry ~ .,                    data = g_1000[,-c(1,21,22)],                     method = \"rf\",                     ntree = 750,                    importance = TRUE) rf my_rf <- rf$confusion heatmap(my_rf[,-c(27)], scale = 'column', trace = 'none')"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"parameter-tuning-1","dir":"Articles","previous_headings":"","what":"Parameter Tuning","title":"Ancestry estimation based on reference samples of known ethnicities","text":"Tuning parameters random forest crucial building machine-learning model produce best forest, case highest accuracy.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"number-of-trees-1","dir":"Articles","previous_headings":"Parameter Tuning","what":"Number of Trees","title":"Ancestry estimation based on reference samples of known ethnicities","text":"random forest model comprised building several trees ‘Number trees’ parameter decides exactly many decision trees constitute random forest. Although exists positive relationship number trees predictive performance model, exists point continuing increase number trees longer find better prediction elongating computational efficiency. also exists tradeoff predictive performance computational efficiency. Excess trees also pose possible issue overfitting trees trained. important dataset test find point diminishing returns. example 1000 Genomes set, 500-1000 trees allows accurate predictions made, also staying computationally efficient.","code":"rf_100_trees <- randomForest(Ancestry ~ .,                    data = g_1000[,-c(1,21,22)],                     ntree = 100,                     method = \"rf\",                     importance = TRUE)  rf_500_trees <- randomForest(Ancestry ~ .,                    data = g_1000[,-c(1,21,22)],                     ntree = 500,                     method = \"rf\",                     importance = TRUE)    rf_10000_trees <- randomForest(Ancestry ~ .,                    data = g_1000[,-c(1,21,22)],                     ntree = 10000,                     method = \"rf\",                     mtry = best_mtry,                    importance = TRUE)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"mtry-1","dir":"Articles","previous_headings":"Parameter Tuning","what":"Mtry","title":"Ancestry estimation based on reference samples of known ethnicities","text":"mrty parameter controls number variables tried split. decision tree construcrion process, confirmation two trees look exactly must investiagted. specifically, mtry parameter controls number input features decision tree able consider moment tree construction controls much randomness added process. Testing different values mtry crucial can greatly impact model’s performance. every new split added node decision tree, mtry controls many PC variables allowed considered successive split. value mtry large model access features every split, much randomness model decision trees may look similar , reducing benefits building multiple independent decision trees. Two common heuristics choosing mtry value value parameter either square root log base 2 total number features. example , values end 4.47 4.32, respectively; 4 chosen avoid effect large mtry diminishes randomness model. , three mtry values tested best found value one smallest OOB error, saved best_mtry variable. iteration, mtry inflated deflated stepFactor value. improve specifies relative improvement OOB error rate must improved much search continue. trace specifies whether print progress search, plot says whether plot OOB error function mtry. can build random forest model using best saved mtry value.","code":"# This first line will provide the best mtry  mtry<- tuneRF(x = g_1000[,-c(1,21,22)], y = g_1000$Ancestry,                stepFactor = 1.5, improve = 0.01, trace = TRUE, plot = TRUE) best_mtry <- mtry[mtry[, 2] == min(mtry[, 2]), 1]  set.seed(123) rf_mtry <- randomForest(Ancestry ~ .,                         data = g_1000[,-c(1,21,22)],                          mtry = best_mtry,                          ntree = 1500,                         method = \"rf\",                          importance = TRUE) rf_mtry"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"k-fold-cross-validation-1","dir":"Articles","previous_headings":"Parameter Tuning > Mtry","what":"K-fold Cross Validation","title":"Ancestry estimation based on reference samples of known ethnicities","text":"Cross-validation used estimate skill machine learning model unseen data. tuning RF model, k-fold cross validation used split bootstrapped datasets random groups, holding one group test data training different models (individual decision trees) remaining groups, ‘k’ number folds/groups dataset. Using k=5 k=10 common usually arbitrarily chosen, depending size dataset. higher number folds tends lead accurate model splitting. example , k=10 10-fold cross-validation used, meaning 10 iterations model 500 decision trees, using different group test set remaining 9 groups training data model. 10 iterations complete, resulting iterations averaged find final cross-validation model random forest model. important test different values k exists tradeoff model accuracy computational expense. iteration requires entire model run, can get computationally expensive depending size dataset. documentation two different values k k-fold cross validation.","code":"set.seed(123) trainControl_5 <- trainControl(method = \"cv\",                           number = 5,                            search = \"grid\")                            forest_5 <- train(Ancestry ~ .,                data=g_1000[,-c(1,21,22)],                 method = \"rf\",                metric = \"Accuracy\",                trControl = trainControl_5                ) # Print out the model details                 forest_5$finalModel                        # Now for 10-fold cross validation     trainControl_10 <- trainControl(method = \"cv\",                           number = 10,                            search = \"grid\") forest_10 <- train(Ancestry ~ .,                data=g_1000[,-c(1,21,22)],                 method = \"rf\",                metric = \"Accuracy\",                trControl = trainControl_10                )                    # Print out model details rf_10_fold_cv <- forest_10$finalModel"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"evaluatinginterpretting-the-rf-1","dir":"Articles","previous_headings":"Parameter Tuning","what":"Evaluating/Interpretting the RF","title":"Ancestry estimation based on reference samples of known ethnicities","text":"found successful OOB error rate, can use package find important information regarding tree. documentation builds decision tree using categorical aspects classify data. PC values sample provided 1000 Genomes reference dataset file, sample values 20 distinct PCs. ask certain sample’s value specific PC less greater given numer. Based answer, either classified specific ancestry needs undergo investigation classify correctly. comprehensability, subset decision tree random forest builds classifying 26 ancestries builds quite complicated cluttered plot.","code":"# This is a visual of the random forest being made.  # https://github.com/araastat/reprtree reprtree:::plot.getTree(rf_mtry) # Two different plots  reprtree:::plot.getTree(rf_mtry, k=1, d=5)  reprtree:::plot.getTree(rf_mtry, k=1, d=6)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"making-a-random-forest-to-classify-superpopulation","dir":"Articles","previous_headings":"Parameter Tuning","what":"Making a random forest to classify superpopulation","title":"Ancestry estimation based on reference samples of known ethnicities","text":"","code":"g_1000 <- read_delim('~/Ancestry/build_forest/train_data', col_names = FALSE) ancestry_info <- read_delim(\"~/Ancestry/build_forest/Genomes1000_ID2Pop.txt\") broader_ancestries <- read_delim(\"~/Ancestry/build_forest/AncestryGeoLocations.csv\") # This line below is for the map construction visual broader_ancestries$latitude <- as.numeric(as.character(broader_ancestries$latitude))  g_1000 <- g_1000 %>%   select(-X1)  colnames(g_1000) <- c(\"ID\", paste0(\"PC\", 1:20))  colnames(ancestry_info) <- c(\"Fam_ID\", \"ID\", \"Ancestry\") ancestry_info <- ancestry_info %>% filter(ancestry_info$ID %in% g_1000$ID)  g_1000 <- g_1000 %>%  #t    raining data   left_join(ancestry_info)  # These are again for the map construction - but also useful in building rf for superpopulation df_superpop <- g_1000 %>%   right_join(broader_ancestries, by=c(\"Ancestry\")) df_superpop$superpopulation <- as.factor(df_superpop$superpopulation)  # Ignore - this needs to be fixed rf_superpop <- randomForest(superpopulation ~ .,                    data = df2[,-c(1, 22, 23, 24, 25, 26, 27, 29)],                     method = \"rf\",                     importance = TRUE)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryCheck.html","id":"more-plots-and-visuals-of-the-data","dir":"Articles","previous_headings":"Parameter Tuning","what":"More Plots and Visuals of the data","title":"Ancestry estimation based on reference samples of known ethnicities","text":"information building useful visuals/plots show data objects sets working . ### 1000 Genomes Population Database Map","code":"## This portion is the documentation for the map visual in Figure 1 of my thesis.    install.packages(\"rnaturalearthdata\") install.packages(\"sf\") library(dplyr) library(\"tidyverse\") library(\"sf\") library(\"rnaturalearth\") library(\"RColorBrewer\") library(\"rnaturalearthdata\")  g_1000 <- read_delim('~/Ancestry/build_forest/train_data', col_names = FALSE) ancestry_info <- read_delim(\"~/Ancestry/build_forest/Genomes1000_ID2Pop.txt\") broader_ancestries <- read_delim(\"~/Ancestry/build_forest/AncestryGeoLocations.csv\") broader_ancestries$latitude <- as.numeric(as.character(broader_ancestries$latitude))  g_1000 <- g_1000 %>%   select(-X1)  colnames(g_1000) <- c(\"ID\", paste0(\"PC\", 1:20))  colnames(ancestry_info) <- c(\"Fam_ID\", \"ID\", \"Ancestry\") ancestry_info <- ancestry_info %>% filter(ancestry_info$ID %in% g_1000$ID)  g_1000 <- g_1000 %>%  #training data   left_join(ancestry_info)  df2 <- g_1000 %>%   right_join(broader_ancestries, by=c(\"Ancestry\"))  df2 <- df2 %>%   select(-PC1, -PC2, -PC3, -PC4, -PC5, -PC6, -PC7, -PC8, -PC9, -PC10, -PC11,          -PC12, -PC13, -PC14, -PC15, -PC16, -PC17, -PC18, -PC19, -PC20)  world <- ne_countries(scale = \"medium\", returnclass = \"sf\")  g <- ggplot() g + geom_sf(data = world) +    geom_point(data = df2, aes(x = longitude, y=latitude, color = superpopulation)) +   scale_color_brewer(type=\"qual\", palette = \"Set3\")  g + geom_sf(data = world) +    geom_point(data = df2, aes(x = longitude, y=latitude, color = Ancestry)) +   scale_color_brewer(type=\"qual\", palette = \"Set3\") library(pheatmap) install.packages(\"pheatmap\") confusion_mat <- (rf_mtry$confusion[,-c(27)])"},{"path":[]},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryRF.html","id":"random-forest-classification","dir":"Articles","previous_headings":"","what":"Random Forest Classification","title":"Build Random Forest for Ancestry estimation","text":"previous Ancestry estimation vignette performed PCA combined study reference dataset identified individuals European descent based clustering data first second PC space. two dimensional space, adequate identification individuals ancestries. vignette train random forest classifier uses 20 PCs sufficiently estimate study samples’ ancestry based ancestry reference dataset. use .eigenvec file created preparing files ancestry estimation, read dataframe. file contains eigenvectors PCA LD-pruned genotype data. .eigenvec file included eigenvalues per PC individual include information regarding individual’s ancestries. Therefore, file available plinkQC download, contains dataframe individual’s ID, family ID, associated ancestry must obtained read , obtained 1000 Genomes database. two files joined ID filtered remove IDs genetic data available.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryRF.html","id":"parameters","dir":"Articles","previous_headings":"","what":"Parameters","title":"Build Random Forest for Ancestry estimation","text":"Tuning parameters random forest crucial building machine-learning model produce best forest, case highest accuracy.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryRF.html","id":"number-of-trees","dir":"Articles","previous_headings":"Parameters","what":"Number of Trees","title":"Build Random Forest for Ancestry estimation","text":"random forest model comprised building several trees ‘Number trees’ parameter decides exactly many decision trees constitute random forest. Although exists positive relationship number trees predictive performance model, exists point continuing increase number trees longer find better prediction elongating computational efficiency. also exists tradeoff predictive performance computational efficiency. Excess trees also pose possible issue overfitting trees trained. important dataset test find point diminishing returns. example 1000 Genomes set, 500 trees allows accurate predictions made, also computational eficient.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryRF.html","id":"k-fold-cross-validation","dir":"Articles","previous_headings":"Parameters","what":"K-fold Cross Validation","title":"Build Random Forest for Ancestry estimation","text":"Cross-validation used estimate skill machine learning model unseen data. tuning RF model, k-fold cross validation used split bootstrapped datasets random groups, holding one group test data training different models (individual decision trees) remaining groups, ‘k’ number folds/groups dataset. Using k=5 k=10 common usually arbitrarily chosen, depending size dataset. higher number folds tends lead accurate model splitting. example , k=10 10-fold cross-validation used, meaning 10 iterations model 500 decision trees, using different group test set remaining 9 groups training data model. 10 iterations complete, resulting iterations averaged find final cross-validation model random forest model. important test different values k exists tradeoff model accuracy computational expense. iteration requires entire model run, can get computationally expensive depending size dataset.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/AncestryRF.html","id":"mtry","dir":"Articles","previous_headings":"Parameters","what":"mtry","title":"Build Random Forest for Ancestry estimation","text":"mrty parameter controls number variables tried split. tre decision tree construcrion process, confirmation two trees look exactly must investiagted. specifically, mtry parameter controls number input features decision tree ablw consider momnet tree construction controls much randomness added process. Testing different values mtry crucial can greatly impact model’s performance. every new split added node decision tree, mtry controls many principle component variables allowed considered successive split. value mtry large model access features every split, much randomness model decision trees may look similar , reducing benefits building multiple independent decision trees. Two common heuristics choosing mtry value value parameter either square root log base 2 total number features. example , values end 4.47 4.32, respectively; 4 chosen avoid effect large mtry diminishes randomness model.","code":""},{"path":[]},{"path":[]},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/Genomes1000.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Processing 1000 Genomes reference data for ancestry estimation","text":"Genotype quality control genetic association studies often includes need selecting samples ethnic background. identify individuals divergent ancestry based genotypes, genotypes study population can combined genotypes reference dataset consisting individuals known ethnicities. Principal component analysis (PCA) combined genotype panel can used detect population structure level reference dataset. following vignette shows processing steps required use samples 1000 Genomes study [1],[2] reference dataset. Using 1000 Genomes reference, population structure large-scale continental ancestry can detected. step--step instruction conduct ancestry analysis described Ancestry estimation vignette.","code":""},{"path":[]},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/Genomes1000.html","id":"set-up","dir":"Articles","previous_headings":"Workflow","what":"Set-up","title":"Processing 1000 Genomes reference data for ancestry estimation","text":"first set bash variables create directories needed; storing names directories reference make easy use updated versions reference future. also useful keep PLINK log-files future reference. order keep data directory tidy, ’ll create directory log files move log directory analysis step.","code":"refdir=~/reference mkdir -p $refdir/plink_log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/Genomes1000.html","id":"plink-software","dir":"Articles","previous_headings":"Workflow","what":"PLINK software","title":"Processing 1000 Genomes reference data for ancestry estimation","text":"addition PLINK v1.9, requirment plinkQC package, also need PLINK v2 processing downloaded dataset. following, plink invoked, corresponds v1.9, whereas plink2 corresponds v2.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/Genomes1000.html","id":"download-and-decompress-1000-genomes-phase-3-data","dir":"Articles","previous_headings":"Workflow","what":"Download and decompress 1000 Genomes phase 3 data","title":"Processing 1000 Genomes reference data for ancestry estimation","text":"1000 Genomes phase III (1000GenomesIII) available PLINK 2 binary format https://www.cog-genomics.org/plink/2.0/resources#1kg_phase3. addition, sample file information individuals’ ancestry available downloaded input plinkQC::check_ancestry(). following code chunk downloads decompresses data. genome build files original release 1000GenomesIII, namely CGRCh37. NB: CGRCh38 positions vcf format can found . remainder vignette however look data processing required 1000GenomesIII available PLINK 2 binary format. NB: links files three boldfaced links page: https://www.cog-genomics.org/plink/2.0/resources#1kg_phase3. dropbox links updated past, means links outdated. Please refer original site open issue github notice change. Thank ! fter steps, 1000 Genomes dataset can used inferring study ancestry described corresponding Ancestry estimation vignette. think delete ? ## Convert 1000 Genomes phase 3 data plink 1 binary format convert PLINK 2 binary format (moment) standardly used PLINK 1 binary format. # References","code":"cd $refdir  pgen=https://www.dropbox.com/s/j72j6uciq5zuzii/all_hg38.pgen.zst?dl=1 pvar=https://www.dropbox.com/s/vx09262b4k1kszy/all_hg38.pvar.zst?dl=1 sample=https://www.dropbox.com/s/2e87z6nc4qexjjm/all_hg38.psam?dl=1  wget $pgen mv 'all_hg38.pgen.zst?dl=1' all_hg38.pgen.zst plink2 --zst-decompress all_hg38.pgen.zst > all_hg38.pgen  wget $pvar mv 'all_hg38.pvar.zst?dl=1' all_hg38.pvar.zst  wget $sample mv 'all_hg38.psam?dl=1' all_hg38.psam plink2 --pfile $refdir/all_hg38 vzs\\       --max-alleles 2 \\       --make-bed \\       --allow-extra-chr 0 \\       --out $refdir/all_hg38 mv $refdir/all_hg38.log $refdir/plink_log/all_hg38_convert.log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/HapMap.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Processing HapMap III reference data for ancestry estimation","text":"Genotype quality control genetic association studies often includes need selecting samples ethnic background. identify individuals divergent ancestry based genotypes, genotypes study population can combined genotypes reference dataset consisting individuals known ethnicities. Principal component analysis (PCA) combined genotype panel can used detect population structure level reference dataset. following vignette shows processing steps required use samples HapMap study [[1]][2][3] reference dataset. Using reference, population structure large-scale continental ancestry can detected. step--step instruction conduct analysis described Ancestry estimation vignette.","code":""},{"path":[]},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/HapMap.html","id":"set-up","dir":"Articles","previous_headings":"Workflow","what":"Set-up","title":"Processing HapMap III reference data for ancestry estimation","text":"first set bash variables create directories needed; storing names directories reference make easy use updated versions reference future. also useful keep PLINK log-files future reference. order keep data directory tidy, ’ll create directory log files move log directory analysis step.","code":"refdir='~/reference' mkdir -r $qcdir/plink_log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/HapMap.html","id":"download-and-convert-hapmap-phase-iii-data","dir":"Articles","previous_headings":"Workflow","what":"Download and convert Hapmap phase III data","title":"Processing HapMap III reference data for ancestry estimation","text":"Hapmap phase 3 data (HapMapIII) available PLINK text format ncbi. addition, sample file information individuals’ ancestry available downloaded input plinkQC::chec_Ancestry(). following code chunk downloads unzips data. convert PLINK text format standardly used PLINK binary format.","code":"cd $refdir  ftp=ftp://ftp.ncbi.nlm.nih.gov/hapmap/genotypes/2009-01_phaseIII/plink_format/ prefix=hapmap3_r2_b36_fwd.consensus.qc.poly  wget $ftp/$prefix.map.bz2 bunzip2 $prefix.map.bz2  wget $ftp/$prefix.ped.bz2 bunzip2 $prefix.per.bz2  wget $ftp/relationships_w_pops_121708.txt plink --file $refdir/$prefix \\       --make-bed \\       --out $refdir/HapMapIII_NCBI36 mv $refdir/HapMapIII_NCBI36.log $refdir/log"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/HapMap.html","id":"update-annotation","dir":"Articles","previous_headings":"Workflow","what":"Update annotation","title":"Processing HapMap III reference data for ancestry estimation","text":"genome build HapMap III data NCBI36. Currently datasets updated CGRCh37 CGRCh38. order update HapMap III data desired build, use UCSC liftOver tool. liftOver tool takes information format similar PLINK .bim format, UCSC bed format liftover chain, containing mapping information old genome (target) new genome (query). returns updated annotation (newFile) file unmappable variants (unMapped): first need download liftOver tool https://genome.ucsc.edu/cgi-bin/hgLiftOver appropriate liftover chain http://hgdownload.soe.ucsc.edu/goldenPath/hg19/liftOver/). convert PLINK .bim format, zero-based UCSC bed format. Hapmap chromosome data encoded numerically, chrX represented chr23, chrY chr24. order match data encoded chrX chrY, rename hapmap chromosomes. Converting zero-based UCSC format re-coding chromosome codes can achieved : [Note: official HapMap release, chromosome codes described , however original download files (link ), chr24 detected. keep line completeness, note, inspecting file chr24/chrY present.] use liftOver tool UCSC bed formated annotation file together appropriate chain file lift . successful liftover, able extract ) variants mappable old new genome ii) updated positions","code":"liftOver oldFile liftover.chain newFile unMapped awk '{print \"chr\" $1, $4 -1, $4, $2 }' $refdir/HapMapIII_NCBI36.bim | \\     sed 's/chr23/chrX/' | sed 's/chr24/chrY/' > \\     $refdir/HapMapIII_NCBI36.tolift liftOver $refdir/HapMapIII_NCBI36.tolift $refdir/hg18ToHg19.over.chain \\     $refdir/HapMapIII_CGRCh37 $refdir/HapMapIII_NCBI36.unMapped # ectract mapped variants awk '{print $4}' $refdir/HapMapIII_CGRCh37 > $refdir/HapMapIII_CGRCh37.snps # ectract updated positions awk '{print $4, $3}' $refdir/HapMapIII_CGRCh37 > $refdir/HapMapIII_CGRCh37.pos"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/HapMap.html","id":"update-the-reference-data","dir":"Articles","previous_headings":"Workflow","what":"Update the reference data","title":"Processing HapMap III reference data for ancestry estimation","text":"can now use PLINK extract mappable variants old build update position. steps, HapMap III dataset can used inferring study ancestry described corresponding Ancestry estimation vignette.","code":"plink --bfile $refdir/HapMapIII_NCBI36 \\     --extract $refdir/HapMapIII_CGRCh37.snps \\     --update-map $refdir/HapMapIII_CGRCh37.pos \\     --make-bed \\     --out $refdir/HapMapIII_CGRCh37 mv $refdir/HapMapIII_CGRCh37.log $refdir/log"},{"path":[]},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Genotype quality control with plinkQC","text":"Genotyping arrays enable direct measurement individuals genotype thousands markers. Subsequent analyses genome-wide association studies rely high quality marker genotypes. Anderson colleagues introduced protocol data quality control genetic association studies heavily based summary statistics relatedness estimation functions PLINK software [1]. PLINK comprehensive, open-source command-line tool genome-wide association studies (GWAS) population genetics research [3]. ’s main functionalities include data management, computing individual- marker- level summary statistics, identity--state estimation association analysis. Integration R achieved R plugin PLINK/SEQ R Package [4]. plugin limited operations yielding simple genetic marker vectors output, PLINK/SEQ R Package limited functionalities can access. plinkQC facilitates genotype quality control genetic association studies described [1]. wraps around plink basic statistics (e.g. missing genotyping rates per individual, allele frequencies per genetic marker) relationship functions generates per-individual per-marker quality control report. Individuals markers fail quality control can subsequently removed plinkQC generate new, clean dataset. Removal individuals based relationship status optimised retain many individuals possible study. plinkQC depends PLINK (version 1.9), manually installed prior usage plinkQC. assumes genotype already determined original probe intensity data genotype array available plink format. Note: PLINK 2.0 still alpha status many re-implementations updates, including output file changes. changes ongoing, plinkQC rely users using PLINK 1.9. monitor PLINK 2.0 changes check compatibility plinkQC. users require specific PLINK 2.0 output, recommend using Step--Step approach described manually saving output files expected PLINK 1.9. protocol implemented three main functions, per-individual quality control (perIndividualQC), per-marker quality control (perMarkerQC) generation new, quality control dataset (cleanData):","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"per-individual-quality-control","dir":"Articles","previous_headings":"Introduction","what":"Per-individual quality control","title":"Genotype quality control with plinkQC","text":"per-individual quality control perIndividualQC wraps around functions: () check_sex: identification individuals discordant sex information, (ii) check_heterozygosity_and_missingness: identification individuals outlying missing genotype /heterozygosity rates, (iii) check_relatedness: identification related individuals, (iv) check_ancestry: identification individuals divergent ancestry.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"per-marker-quality-control","dir":"Articles","previous_headings":"Introduction","what":"Per-marker quality control","title":"Genotype quality control with plinkQC","text":"per-marker quality control perMarkerQC wraps around functions: () check_snp_missingnes: identifying markers excessive missing genotype rates, (ii) check_hwe: identifying markers showing significant deviation Hardy-Weinberg equilibrium (HWE), (iii) check_maf: removal markers low minor allele frequency (MAF).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"clean-data","dir":"Articles","previous_headings":"Introduction","what":"Clean data","title":"Genotype quality control with plinkQC","text":"cleanData takes results perMarkerQC perIndividualQC creates new dataset individuals markers passed quality control checks.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"workflow","dir":"Articles","previous_headings":"","what":"Workflow","title":"Genotype quality control with plinkQC","text":"following, genotype quality control plinkQC applied small example dataset 200 individuals 10,000 markers (provided package). quality control demonstrated three easy steps, per-individual per-marker quality control followed generation new dataset. addition, functionality functions underlying perMarkerQC perIndividualQC demonstrated end vignette.","code":"package.dir <- find.package('plinkQC') indir <- file.path(package.dir, 'extdata') qcdir <- tempdir() name <- 'data' path2plink <- \"/Users/hannah/bin/plink\""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"per-individual-quality-control-1","dir":"Articles","previous_headings":"Workflow","what":"Per-individual quality control","title":"Genotype quality control with plinkQC","text":"perIndividualQC, one simply specifies directory data stored (qcdir) prefix plink files (.e. prefix.bim, prefix.bed, prefix.fam). addition, names files containing information reference population merged dataset used check_ancestry provided: refSamplesFile, refColorsFile prefixMergedDataset. Per default, quality control checks conducted. addition running check, perIndividualQC writes list fail individual IDs qcdir. IDs removed computation perMarkerQC. list present, perMarkerQC send message conducting quality control entire dataset. NB: reduce data size example data plinkQC, data.genome already reduced individuals related. Thus relatedness plots C show counts related individuals . NB: demonstrate results ancestry check, required eigenvector file combined study reference datasets precomputed purpose example copied qcdir. practice, qcdir often indir step required. perIndividualQC displays results quality control steps multi-panel plot.  overviewperIndividualQC depicts overview plots quality control failures intersection quality control failures ancestry exclusion.","code":"file.copy(file.path(package.dir, 'extdata/data.HapMapIII.eigenvec'), qcdir) #> [1] TRUE fail_individuals <- perIndividualQC(indir=indir, qcdir=qcdir, name=name,                             refSamplesFile=paste(indir, \"/HapMap_ID2Pop.txt\",                                                  sep=\"\"),                              refColorsFile=paste(indir, \"/HapMap_PopColors.txt\",                                                  sep=\"\"),                             prefixMergedDataset=\"data.HapMapIII\",                             path2plink=path2plink, do.run_check_ancestry = FALSE,                             interactive=TRUE, verbose=TRUE) overview_individuals <- overviewPerIndividualQC(fail_individuals,                                                 interactive=TRUE)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"per-marker-quality-control-1","dir":"Articles","previous_headings":"Workflow","what":"Per-marker quality control","title":"Genotype quality control with plinkQC","text":"perMarkerQC applies checks data specified directory (qcdir), starting specified prefix plink files (.e. prefix.bim, prefix.bed, prefix.fam). Optionally, user can specify different thresholds quality control checks check conduct. Per default, quality control checks conducted. perMarkerQC displays results QC step multi-panel plot.  overviewPerMarkerQC depicts overview marker quality control failures overlaps.","code":"fail_markers <- perMarkerQC(indir=indir, qcdir=qcdir, name=name,                             path2plink=path2plink,                             verbose=TRUE, interactive=TRUE,                             showPlinkOutput=FALSE) overview_marker <- overviewPerMarkerQC(fail_markers, interactive=TRUE)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"create-qc-ed-dataset","dir":"Articles","previous_headings":"Workflow","what":"Create QC-ed dataset","title":"Genotype quality control with plinkQC","text":"checking results per-individual per-marker quality control, individuals markers fail chosen criteria can automatically removed dataset cleanData, resulting new dataset qcdir/data.clean.bed,qcdir/data.clean.bim, qcdir/data.clean.fam. convenience, cleanData returns list individuals study split keep remove individuals.","code":"Ids  <- cleanData(indir=indir, qcdir=qcdir, name=name, path2plink=path2plink,                             verbose=TRUE, showPlinkOutput=FALSE)"},{"path":[]},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"individuals-with-discordant-sex-information","dir":"Articles","previous_headings":"Step-by-step","what":"Individuals with discordant sex information","title":"Genotype quality control with plinkQC","text":"identification individuals discordant sex information helps detect sample mix-ups samples poor genotyping rates. sample, homozygosity rates across X-chromosomal genetic markers computed compared expected rates (typically $<$0.2 females $>$0.8 males). samples assigned sex (PEDSEX .fam file) contradicts sex inferred homozygosity rates (SNPSEX), checked sex correctly recorded (genotyping often occurs different locations phenotyping misrecording might occur). Samples discordant sex information accounted removed study. Identifying individuals discordant sex information implemented check_sex. finds individuals whose SNPSEX != PEDSEX. Optionally, extra data.frame sample IDs sex can provided double check external PEDSEX data (often processed different centers) match. mismatch PEDSEX SNPSEX detected, SNPSEX == Sex, PEDSEX individuals can optionally updated. check_sex depicts X-chromosomal heterozygosity (SNPSEX) samples split (PEDSEX).","code":"fail_sex <- check_sex(indir=indir, qcdir=qcdir, name=name, interactive=TRUE,                       verbose=TRUE, path2plink=path2plink)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"individuals-with-outlying-missing-genotype-andor-heterozygosity-rates","dir":"Articles","previous_headings":"Step-by-step","what":"Individuals with outlying missing genotype and/or heterozygosity rates","title":"Genotype quality control with plinkQC","text":"identification individuals outlying missing genotype /heterozygosity rates helps detect samples poor DNA quality /concentration excluded study. Typically, individuals 3-7% genotype calls missing removed. Outlying heterozygosity rates judged relative overall heterozygosity rates study, individuals whose rates standard deviations (sd) mean heterozygosity rate removed. typical quality control outlying heterozygosity rates remove individuals three sd away mean rate. Identifying related individuals outlying missing genotype /heterozygosity rates implemented check_het_and_miss. finds individuals genotyping heterozygosity rates fail set thresholds depicts results scatter plot samples’ missingness rates x-axis heterozygosity rates y-axis.","code":"fail_het_imiss <- check_het_and_miss(indir=indir, qcdir=qcdir, name=name,                                      interactive=TRUE, path2plink=path2plink)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"related-individuals","dir":"Articles","previous_headings":"Step-by-step","what":"Related individuals","title":"Genotype quality control with plinkQC","text":"Depending future use genotypes, might required remove related individuals study. Related individuals can identified proportion shared alleles genotyped markers (identity descend, IBD). Standardly, individuals second-degree relatedness higher excluded. Identifying related individuals implemented check_relatedness. finds pairs samples whose proportion IBD larger specified highIBDTh. Subsequently, pairs individual additional relatives dataset, individual greater genotype missingness rate selected returned individual failing relatedness check. complex family structures, unrelated individuals per family selected (e.g. parents-offspring trio, offspring marked fail, parents kept analysis). NB: reduce data size example data plinkQC, data.genome already reduced individuals related. Thus relatedness plots C show counts related individuals .","code":"exclude_relatedness <- check_relatedness(indir=indir, qcdir=qcdir, name=name,                                          interactive=TRUE,                                          path2plink=path2plink)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"individuals-of-divergent-ancestry","dir":"Articles","previous_headings":"Step-by-step","what":"Individuals of divergent ancestry","title":"Genotype quality control with plinkQC","text":"identification individuals divergent ancestry can achieved combining genotypes study population genotypes reference dataset consisting individuals known ethnicities (instance individuals Hapmap 1000 genomes study [9]). Principal component analysis combined genotype panel can used detect population structure level reference dataset (Hapmap 1000 Genomes, large-scale continental ancestry). Identifying individuals divergent ancestry implemented check_ancestry. Currently, check ancestry supports automatic selection individuals European descent. uses information principal components 1 2 find center European reference samples. study samples whose euclidean distance centre falls outside specified radius considered non-European. check_ancestry creates scatter plot PC1 versus PC2 color-coded samples reference populations study population.","code":"exclude_ancestry <- check_ancestry(indir=indir, qcdir=qcdir, name=name,                             refSamplesFile=paste(indir, \"/HapMap_ID2Pop.txt\",                                                  sep=\"\"),                              refColorsFile=paste(indir, \"/HapMap_PopColors.txt\",                                                  sep=\"\"),                             prefixMergedDataset=\"data.HapMapIII\",                             path2plink=path2plink, run.check_ancestry = FALSE,                             interactive=TRUE)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"markers-with-excessive-missingness-rate","dir":"Articles","previous_headings":"Step-by-step","what":"Markers with excessive missingness rate","title":"Genotype quality control with plinkQC","text":"Markers excessive missingness rate removed considered unreliable. Typically, thresholds marker exclusion based missingness range 1%-5%. Identifying markers high missingness rates implemented snp_missingness. calculates rates missing genotype calls frequency variants individuals passed perIndividualQC.","code":"fail_snpmissing <- check_snp_missingness(indir=indir, qcdir=qcdir, name=name,                                          interactive=TRUE,                                          path2plink=path2plink,                                           showPlinkOutput=FALSE)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"markers-with-deviation-from-hwe","dir":"Articles","previous_headings":"Step-by-step","what":"Markers with deviation from HWE","title":"Genotype quality control with plinkQC","text":"Markers strong deviation HWE might indicative genotyping genotype-calling errors. serious genotyping errors often yield low p-values (order 10−5010^-50), recommended choose reasonably low threshold avoid filtering many variants (might slight, non-critical deviations). Identifying markers deviation HWE implemented check_hwe. calculates observed expected heterozygote frequencies per SNP individuals passed perIndividualQC computes deviation frequencies Hardy-Weinberg equilibrium (HWE) HWE exact test.","code":"fail_hwe <- check_hwe(indir=indir, qcdir=qcdir, name=name, interactive=TRUE,                       path2plink=path2plink, showPlinkOutput=FALSE)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/articles/plinkQC.html","id":"markers-with-low-minor-allele-frequency","dir":"Articles","previous_headings":"Step-by-step","what":"Markers with low minor allele frequency","title":"Genotype quality control with plinkQC","text":"Markers low minor allele count often removed actual genotype calling (via calling algorithm) difficult due small sizes heterozygote rare-homozygote clusters. Identifying markers low minor allele count implemented check_maf. calculates minor allele frequencies variants individuals passed perIndividualQC.","code":"fail_maf <- check_maf(indir=indir, qcdir=qcdir, name=name, interactive=TRUE,                       path2plink=path2plink, showPlinkOutput=FALSE)"},{"path":[]},{"path":"https://meyer-lab-cshl.github.io/plinkQC/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Hannah Meyer. Author, maintainer. Caroline Walter. Contributor. Maha Syed. Contributor.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Meyer H (2024). plinkQC: Genotype Quality Control 'PLINK'. R package version 0.3.4, https://meyer-lab-cshl.github.io/plinkQC/.","code":"@Manual{,   title = {plinkQC: Genotype Quality Control with 'PLINK'},   author = {Hannah Meyer},   year = {2024},   note = {R package version 0.3.4},   url = {https://meyer-lab-cshl.github.io/plinkQC/}, }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/index.html","id":"id_-plinkqc","dir":"","previous_headings":"","what":"plinkQC","title":"Genotype Quality Control with PLINK","text":"plinkQC R/CRAN package genotype quality control genetic association studies. makes PLINK basic statistics (e.g.missing genotyping rates per individual, allele frequencies per genetic marker) relationship functions easily accessible within R allows automatic evaluation results. plinkQC generates per-individual per-marker quality control report. step--step guide run analyses can found . Individuals markers fail quality control can subsequently removed plinkQC generate new, clean dataset. plinkQC facilitates ancestry check study individuals based comparison reference datasets. processing reference datasets documented detail . Removal individuals based relationship status via plinkQC optimised retain many individuals possible study.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/index.html","id":"id_-installation","dir":"","previous_headings":"","what":"Installation","title":"Genotype Quality Control with PLINK","text":"current github version plinkQC : 0.3.4 can installed via current CRAN version plinkQC : 0.3.4 can installed via log version changes can found .","code":"library(devtools) install_github(\"meyer-lab-cshl/plinkQC\") install.packages(\"plinkQC\")"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/index.html","id":"id_-citation","dir":"","previous_headings":"","what":"Citation","title":"Genotype Quality Control with PLINK","text":"Meyer HV (2020) plinkQC: Genotype quality control genetic association studies.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkFiltering.html","id":null,"dir":"Reference","previous_headings":"","what":"Check and construct PLINK sample and marker filters — checkFiltering","title":"Check and construct PLINK sample and marker filters — checkFiltering","text":"checkFiltering checks file names individuals markers filtered can found. , constructs command filtering","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkFiltering.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check and construct PLINK sample and marker filters — checkFiltering","text":"","code":"checkFiltering(   keep_individuals = NULL,   remove_individuals = NULL,   extract_markers = NULL,   exclude_markers = NULL )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkFiltering.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check and construct PLINK sample and marker filters — checkFiltering","text":"keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkFiltering.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check and construct PLINK sample and marker filters — checkFiltering","text":"Vector containing args sys::exec_wait format enable filtering individuals /markers.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkPlink.html","id":null,"dir":"Reference","previous_headings":"","what":"Check PLINK software access — checkPlink","title":"Check PLINK software access — checkPlink","text":"checkPlink checks PLINK software (https://www.cog-genomics.org/plink/1.9/) can found system call.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkPlink.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check PLINK software access — checkPlink","text":"","code":"checkPlink(path2plink = NULL)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkPlink.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check PLINK software access — checkPlink","text":"path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink').","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkPlink.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check PLINK software access — checkPlink","text":"Path PLINK 1.9 executable.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkPlink2.html","id":null,"dir":"Reference","previous_headings":"","what":"Check PLINK2 software access — checkPlink2","title":"Check PLINK2 software access — checkPlink2","text":"checkPlink checks PLINK software version 2.0 (https://www.cog-genomics.org/plink/2.0/) can found system call.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkPlink2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check PLINK2 software access — checkPlink2","text":"","code":"checkPlink2(path2plink2 = NULL)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkPlink2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check PLINK2 software access — checkPlink2","text":"path2plink2 [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/2.0/) .e. plink 2 accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink').","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkPlink2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check PLINK2 software access — checkPlink2","text":"Path PLINK version 2.0 executable.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkRemoveIDs.html","id":null,"dir":"Reference","previous_headings":"","what":"Check and construct individual IDs to be removed — checkRemoveIDs","title":"Check and construct individual IDs to be removed — checkRemoveIDs","text":"checkRemoveIDs checks file names individuals filtered can found. reads corresponding files, combines selected individuals one data.frame compares individuals analysis.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkRemoveIDs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check and construct individual IDs to be removed — checkRemoveIDs","text":"","code":"checkRemoveIDs(prefix, remove_individuals = NULL, keep_individuals)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkRemoveIDs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check and construct individual IDs to be removed — checkRemoveIDs","text":"prefix [character] Prefix PLINK files, .e. path/2/name.bed, path/2/name.bim path/2/name.fam. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/checkRemoveIDs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check and construct individual IDs to be removed — checkRemoveIDs","text":"data.frame containing family (FID) individual (IID) IDs individuals removed analysis.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_ancestry.html","id":null,"dir":"Reference","previous_headings":"","what":"Identification of individuals of divergent ancestry — check_ancestry","title":"Identification of individuals of divergent ancestry — check_ancestry","text":"Runs evaluates results plink –pca merged genotypes individuals QCed individuals reference population known genotypes. Currently, check ancestry supports automatic selection individuals European descent. uses information principal components 1 2 returned plink –pca find center European reference samples (mean(PC1_europeanRef), mean(PC2_europeanRef). computes maximum Euclidean distance (maxDist) European reference samples centre. study samples whose Euclidean distance centre falls outside circle described radius r=europeanTh* maxDist considered non-European IDs returned failing ancestry check. check_ancestry creates scatter plot PC1 versus PC2 colour-coded samples reference populations study population.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_ancestry.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identification of individuals of divergent ancestry — check_ancestry","text":"","code":"check_ancestry(   indir,   name,   qcdir = indir,   prefixMergedDataset,   europeanTh = 1.5,   defaultRefSamples = c(\"HapMap\", \"1000Genomes\"),   refPopulation = c(\"CEU\", \"TSI\"),   refSamples = NULL,   refColors = NULL,   refSamplesFile = NULL,   refColorsFile = NULL,   refSamplesIID = \"IID\",   refSamplesPop = \"Pop\",   refColorsColor = \"Color\",   refColorsPop = \"Pop\",   studyColor = \"#2c7bb6\",   legend_labels_per_row = 6,   run.check_ancestry = TRUE,   interactive = FALSE,   verbose = verbose,   highlight_samples = NULL,   highlight_type = c(\"text\", \"label\", \"color\", \"shape\"),   highlight_text_size = 3,   highlight_color = \"#c51b8a\",   highlight_shape = 17,   highlight_legend = FALSE,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   title_size = 9,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   path2plink = NULL,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_ancestry.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identification of individuals of divergent ancestry — check_ancestry","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] prefix plink files, .e. name.bed, name.bim, name.fam. qcdir [character] /path//directory prefixMergedDataset.eigenvec results returned plink –pca saved. Per default qcdir=indir. run.check_ancestry FALSE, assumed plink –pca prefixMergedDataset run qcdir/prefixMergedDataset.eigenvec exists.User needs writing permission qcdir. prefixMergedDataset [character] Prefix merged dataset (study reference samples) used plink –pca, resulting prefixMergedDataset.eigenvec. europeanTh [double] Scaling factor radius drawn around center European reference samples, study samples inside radius considered European descent samples outside radius non-European descent. radius computed maximum Euclidean distance European reference samples centre European reference samples. defaultRefSamples [character] Option use pre-downloaded individual population identifiers either 1000Genomes HapMap project. refSamples refSamplesFile provided, HapMap identifiers (1000Genomes specified) used default function fail reference samples prefixMergedDataset match reference samples. refColors refColorsFile provided, also sets default colors reference populations. refPopulation [vector] Vector population identifiers European reference population. Identifiers corresponding population IDs [refColorsPop] refColorsfile/refColors. refSamples [data.frame] Dataframe sample identifiers [refSamplesIID] corresponding IIDs prefixMergedDataset.eigenvec population identifier [refSamplesPop] corresponding population IDs [refColorsPop] refColorsfile/refColors. Either refSamples refSamplesFile specified. refColors [data.frame, optional] Dataframe population IDs column [refColorsPop] corresponding colour-code PCA plot column [refColorsColor]. provided .null(refColorsFile) default colors used. refSamplesFile [character] /path//File//reference samples. Needs columns sample identifiers [refSamplesIID] corresponding IIDs prefixMergedDataset.eigenvec population identifier [refSamplesPop] corresponding population IDs [refColorsPop] refColorsfile/refColors. refColorsFile [character, optional] /path//File//Population/Colors containing population IDs column [refColorsPop] corresponding colour-code PCA plot column [refColorsColor].provided .null(refColors) default colors used. refSamplesIID [character] Column name reference sample IDs refSamples/refSamplesFile. refSamplesPop [character] Column name reference sample population IDs refSamples/refSamplesFile. refColorsColor [character] Column name population colors refColors/refColorsFile refColorsPop [character] Column name reference sample population IDs refColors/refColorsFile. studyColor [character] Colour used study population. legend_labels_per_row [integer] Number population names per row PCA plot. run.check_ancestry [logical] plink –pca run determine principal components merged dataset; FALSE, assumed plink –pca run successfully qcdir/prefixMergedDataset.eigenvec present; check_ancestry fail missing file error otherwise. interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_ancestry) via ggplot2::ggsave(p=p_ancestry, other_arguments) pdf(outfile) print(p_ancestry) dev.(). verbose [logical] TRUE, progress info printed standard . highlight_samples [character vector] Vector sample IIDs highlight plot (p_ancestry); highlight_samples IIDs present IIDs prefixMergedDataset.fam file. highlight_type [character]  Type sample highlight, labeling IID (\"text\"/\"label\") /highlighting data points different \"color\" /\"shape\". \"text\" \"label\" use ggrepel minimal overlap text labels (\"text) label boxes (\"label\").  one \"text\" \"label\" can specified.Text/Label size can specified highlight_text_size, highlight color highlight_color, highlight shape highlight_shape. highlight_text_size [integer] Text/Label size samples specified highlighted (highlight_samples) \"text\" \"label\" (highlight_type). highlight_color [character] Color samples specified highlighted (highlight_samples) \"color\" (highlight_type). highlight_shape [integer] Shape samples specified highlighted (highlight_samples) \"shape\" (highlight_type). Possible shapes encoding can found : https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#sec:shape-spec highlight_legend [logical] separate legend highlighted samples provided; relevant highlight_type == \"color\" highlight_type == \"shape\". legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. title_size [integer] Size plot title. keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_ancestry.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identification of individuals of divergent ancestry — check_ancestry","text":"Named [list] ) fail_ancestry, containing [data.frame] FID IID non-European individuals ii) p_ancestry, ggplot2-object 'containing' scatter plot PC1 versus PC2 colour-coded samples reference populations study population, can shown print(p_ancestry).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_ancestry.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identification of individuals of divergent ancestry — check_ancestry","text":"","code":"if (FALSE) { # \\dontrun{ indir <- system.file(\"extdata\", package=\"plinkQC\") name <- \"data\" fail_ancestry <- check_ancestry(indir=indir, name=name, refSamplesFile=paste(indir, \"/HapMap_ID2Pop.txt\",sep=\"\"), refColorsFile=paste(indir, \"/HapMap_PopColors.txt\", sep=\"\"), prefixMergedDataset=\"data.HapMapIII\", interactive=FALSE, run.check_ancestry=FALSE)  # highlight samples highlight_samples <- read.table(system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\")) fail_ancestry <- check_ancestry(indir=qcdir, name=name, refSamplesFile=paste(qcdir, \"/HapMap_ID2Pop.txt\",sep=\"\"), refColorsFile=paste(qcdir, \"/HapMap_PopColors.txt\", sep=\"\"), prefixMergedDataset=\"data.HapMapIII\", interactive=FALSE, highlight_samples = highlight_samples[,2], run.check_ancestry=FALSE, highlight_type = c(\"text\", \"shape\")) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_het_and_miss.html","id":null,"dir":"Reference","previous_headings":"","what":"Identification of individuals with outlying missing genotype or heterozygosity rates — check_het_and_miss","title":"Identification of individuals with outlying missing genotype or heterozygosity rates — check_het_and_miss","text":"Runs evaluates results plink –missing (missing genotype rates per individual) plink –het (heterozygosity rates per individual). Non-systematic failures genotyping outlying heterozygosity (hz) rates per individual often proxies DNA sample quality. Larger expected heterozygosity can indicate possible DNA contamination. mean heterozygosity PLINK computed hz_mean = (N-O)/N, N: number non-missing genotypes O:observed number homozygous genotypes given individual. Mean heterozygosity can differ populations SNP genotyping panels. Within population genotyping panel, reduced heterozygosity rate can indicate inbreeding - individuals likely returned check_relatedness individuals fail relatedness filters. check_het_and_miss creates scatter plot individuals' missingness rates x-axis heterozygosity rates y-axis.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_het_and_miss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identification of individuals with outlying missing genotype or heterozygosity rates — check_het_and_miss","text":"","code":"check_het_and_miss(   indir,   name,   qcdir = indir,   imissTh = 0.03,   hetTh = 3,   run.check_het_and_miss = TRUE,   label_fail = TRUE,   highlight_samples = NULL,   highlight_type = c(\"text\", \"label\", \"color\", \"shape\"),   highlight_text_size = 3,   highlight_color = \"#c51b8a\",   highlight_shape = 17,   highlight_legend = FALSE,   interactive = FALSE,   verbose = FALSE,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   title_size = 9,   path2plink = NULL,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_het_and_miss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identification of individuals with outlying missing genotype or heterozygosity rates — check_het_and_miss","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam, name.het name.imiss. qcdir [character] /path//directory name.het returned plink –het name.imiss returned plink –missing saved. Per default qcdir=indir. run.check_het_and_miss FALSE, assumed plink –missing plink –het run qcdir/name.imiss qcdir/name.het present. User needs writing permission qcdir. imissTh [double] Threshold acceptable missing genotype rate per individual; proportion (0,1) hetTh [double] Threshold acceptable deviation mean heterozygosity per individual. Expressed multiples standard deviation heterozygosity (het), .e. individuals outside mean(het) +/- hetTh*sd(het) returned failing heterozygosity check; larger 0. run.check_het_and_miss [logical] plink –missing plink –het run determine genotype missingness heterozygosity rates; FALSE, assumed plink –missing plink –het run qcdir/name.imiss qcdir/name.het present; check_het_and_miss fail missing file error otherwise. label_fail [logical] Set TRUE, add fail IDs text labels scatter plot. highlight_samples [character vector] Vector sample IIDs highlight plot (p_het_imiss); highlight_samples IIDs present IIDs name.fam file. highlight_type [character]  Type sample highlight, labeling IID (\"text\"/\"label\") /highlighting data points different \"color\" /\"shape\". \"text\" \"label\" use ggrepel minimal overlap text labels (\"text) label boxes (\"label\").  one \"text\" \"label\" can specified.Text/Label size can specified highlight_text_size, highlight color highlight_color, highlight shape highlight_shape. highlight_text_size [integer] Text/Label size samples specified highlighted (highlight_samples) \"text\" \"label\" (highlight_type). highlight_color [character] Color samples specified highlighted (highlight_samples) \"color\" (highlight_type). highlight_shape [integer] Shape samples specified highlighted (highlight_samples) \"shape\" (highlight_type). Possible shapes encoding can found : https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#sec:shape-spec highlight_legend [logical] separate legend highlighted samples provided; relevant highlight_type == \"color\" highlight_type == \"shape\". interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_het_imiss) via ggplot2::ggsave(p=p_het_imiss , other_arguments) pdf(outfile) print(p_het_imiss) dev.(). verbose [logical] TRUE, progress info printed standard . keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. title_size [integer] Size plot title. path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_het_and_miss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identification of individuals with outlying missing genotype or heterozygosity rates — check_het_and_miss","text":"Named [list] ) fail_imiss [data.frame] containing FID (Family ID), IID (Within-family ID), MISS_PHENO (Phenotype missing? (Y/N)), N_MISS (Number missing genotype call(s), including obligatory missings), N_GENO (Number potentially valid call(s)), F_MISS (Missing call rate) individuals failing missing genotype check ii) fail_het [data.frame] containing FID (Family ID), IID (Within-family ID), O(HOM) (Observed number homozygotes), E(HOM) (Expected number homozygotes), N(NM) (Number non-missing autosomal genotypes), F (Method--moments F coefficient estimate) individuals failing  outlying heterozygosity check iii) p_het_imiss, ggplot2-object 'containing' scatter plot samples' missingness rates x-axis heterozygosity rates y-axis, can shown print(p_het_imiss).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_het_and_miss.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identification of individuals with outlying missing genotype or heterozygosity rates — check_het_and_miss","text":"check_het_and_miss wraps around run_check_missingness, run_check_heterozygosity evaluate_check_het_and_miss. run.check_het_and_miss TRUE, run_check_heterozygosity run_check_missingness executed ; otherwise assumed plink –missing plink –het run externally qcdir/name.het qcdir/name.imiss exist. check_het_and_miss fail missing file error otherwise. details output data.frame fail_imiss fail_het, check original description PLINK output format page: https://www.cog-genomics.org/plink/1.9/formats#imiss https://www.cog-genomics.org/plink/1.9/formats#het","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_het_and_miss.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identification of individuals with outlying missing genotype or heterozygosity rates — check_het_and_miss","text":"","code":"if (FALSE) { # \\dontrun{ indir <- system.file(\"extdata\", package=\"plinkQC\") name <- \"data\" path2plink <- \"path/to/plink\"  # whole dataset fail_het_miss <- check_het_and_miss(indir=indir, name=name, interactive=FALSE,path2plink=path2plink)  # subset of dataset with sample highlighting highlight_samples <- read.table(system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\")) remove_individuals_file <- system.file(\"extdata\", \"remove_individuals\", package=\"plinkQC\") fail_het_miss <- check_het_and_miss(indir=indir, name=name, interactive=FALSE,path2plink=path2plink, remove_individuals=remove_individuals_file, highlight_samples=highlight_samples[,2], highlight_type = c(\"text\", \"shape\")) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_hwe.html","id":null,"dir":"Reference","previous_headings":"","what":"Identification of SNPs showing a significant deviation from Hardy-Weinberg- equilibrium (HWE) — check_hwe","title":"Identification of SNPs showing a significant deviation from Hardy-Weinberg- equilibrium (HWE) — check_hwe","text":"Runs evaluates results plink –hardy. calculates observed expected heterozygote frequencies variants individuals passed perIndividualQC computes deviation frequencies Hardy-Weinberg equilibrium (HWE) HWE exact test. p-values HWE exact test displayed histograms (stratified low p-values), hweTh used depict quality control cut-SNPs.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_hwe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identification of SNPs showing a significant deviation from Hardy-Weinberg- equilibrium (HWE) — check_hwe","text":"","code":"check_hwe(   indir,   name,   qcdir = indir,   hweTh = 1e-05,   interactive = FALSE,   path2plink = NULL,   verbose = FALSE,   showPlinkOutput = TRUE,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   title_size = 9 )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_hwe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identification of SNPs showing a significant deviation from Hardy-Weinberg- equilibrium (HWE) — check_hwe","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam. qcdir [character] /path//directory results written . perIndividualQC conducted, directory qcdir specified perIndividualQC, .e. contains name.fail.IDs IIDs individuals failed QC. User needs writing permission qcdir. Per default, qcdir=indir. hweTh [double] Significance threshold deviation HWE. interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_hwe) via ggplot2::ggsave(p=p_hwe, other_arguments) pdf(outfile) print(p_hwe) dev.(). path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). verbose [logical] TRUE, progress info printed standard specifically, TRUE, plink log displayed. showPlinkOutput [logical] TRUE, plink log error messages printed standard . keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. title_size [integer] Size plot title.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_hwe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identification of SNPs showing a significant deviation from Hardy-Weinberg- equilibrium (HWE) — check_hwe","text":"Named list ) fail_hwe containing [data.frame] CHR (Chromosome code), SNP (Variant identifier), TEST (Type test: one {'', 'AFF', 'UNAFF', '(QT)', '(NP)'}), A1 (Allele 1; usually minor), A2 (Allele 2; usually major), GENO ('/'-separated genotype counts: A1 hom, het, A2 hom), O(HET) (Observed heterozygote frequency E(HET) (Expected heterozygote frequency), P (Hardy-Weinberg equilibrium exact test p-value) SNPs failed hweTh ii) p_hwe, ggplot2-object 'containing' HWE p-value distribution histogram can shown (print(p_hwe)).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_hwe.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identification of SNPs showing a significant deviation from Hardy-Weinberg- equilibrium (HWE) — check_hwe","text":"check_hwe uses plink –remove name.fail.IDs –hardy calculate observed expected heterozygote frequencies per SNP individuals passed perIndividualQC. without generating new dataset simply removes IDs calculating statistics. details output data.frame fail_hwe, check original description PLINK output format page: https://www.cog-genomics.org/plink/1.9/formats#hwe.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_hwe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identification of SNPs showing a significant deviation from Hardy-Weinberg- equilibrium (HWE) — check_hwe","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") qcdir <- tempdir() name <- \"data\" path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. if (FALSE) { # \\dontrun{ # run on all individuals and markers fail_hwe <- check_hwe(indir=indir, qcdir=qcdir, name=name, interactive=FALSE, verbose=TRUE, path2plink=path2plink)  # run on subset of individuals and markers remove_individuals_file <- system.file(\"extdata\", \"remove_individuals\", package=\"plinkQC\") extract_markers_file <- system.file(\"extdata\", \"extract_markers\", package=\"plinkQC\") fail_hwe <- check_hwe(qcdir=qcdir, indir=indir, name=name, interactive=FALSE, verbose=TRUE, path2plink=path2plink, remove_individuals=remove_individuals_file, extract_markers=extract_markers_file) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_maf.html","id":null,"dir":"Reference","previous_headings":"","what":"Identification of SNPs with low minor allele frequency — check_maf","title":"Identification of SNPs with low minor allele frequency — check_maf","text":"Runs evaluates results plink –freq. calculates minor allele frequencies variants individuals passed perIndividualQC. minor allele frequency distributions plotted histogram.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_maf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identification of SNPs with low minor allele frequency — check_maf","text":"","code":"check_maf(   indir,   name,   qcdir = indir,   macTh = 20,   mafTh = NULL,   verbose = FALSE,   interactive = FALSE,   path2plink = NULL,   showPlinkOutput = TRUE,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   title_size = 9 )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_maf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identification of SNPs with low minor allele frequency — check_maf","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam. qcdir [character] /path//directory results written . perIndividualQC conducted, directory qcdir specified perIndividualQC, .e. contains name.fail.IDs IIDs individuals failed QC. User needs writing permission qcdir. Per default, qcdir=indir. macTh [double] Threshold minor allele cut cut-, mafTh macTh specified, macTh used (macTh = mafTh\\*2\\*NrSamples). mafTh [double] Threshold minor allele frequency cut-. verbose [logical] TRUE, progress info printed standard specifically, TRUE, plink log displayed. interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_hwe) via ggplot2::ggsave(p=p_maf, other_arguments) pdf(outfile) print(p_maf) dev.(). path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). showPlinkOutput [logical] TRUE, plink log error messages printed standard . keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. title_size [integer] Size plot title.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_maf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identification of SNPs with low minor allele frequency — check_maf","text":"Named list ) fail_maf containing [data.frame] CHR (Chromosome code), SNP (Variant identifier), A1 (Allele 1; usually minor), A2 (Allele 2; usually major), MAF (Allele 1 frequency), NCHROBS (Number allele observations) SNPs failed mafTh/macTh ii) p_maf, ggplot2-object 'containing' MAF distribution histogram can shown (print(p_maf)).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_maf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identification of SNPs with low minor allele frequency — check_maf","text":"check_maf uses plink –remove name.fail.IDs –freq calculate minor allele frequencies variants individuals passed perIndividualQC. without generating new dataset simply removes IDs calculating statistics. details output data.frame fail_maf, check original description PLINK output format page: https://www.cog-genomics.org/plink/1.9/formats#frq.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_maf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identification of SNPs with low minor allele frequency — check_maf","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") qcdir <- tempdir() name <- \"data\" path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. if (FALSE) { # \\dontrun{ # run on all individuals and markers fail_maf <- check_maf(indir=indir, qcdir=qcdir, name=name, macTh=15, interactive=FALSE, verbose=TRUE, path2plink=path2plink)  # run on subset of individuals and markers keep_individuals_file <- system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\") exclude_markers_file <- system.file(\"extdata\", \"exclude_markers\", package=\"plinkQC\") fail_maf <- check_maf(qcdir=qcdir, indir=indir, name=name, interactive=FALSE, verbose=TRUE, path2plink=path2plink, keep_individuals=keep_individuals_file, exclude_markers=exclude_markers_file) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_relatedness.html","id":null,"dir":"Reference","previous_headings":"","what":"Identification of related individuals — check_relatedness","title":"Identification of related individuals — check_relatedness","text":"Runs evaluates results plink –genome. plink –genome calculates identity state (IBS) pair individuals based average proportion alleles shared genotyped SNPs. degree recent shared ancestry, .e. identity descent (IBD) can estimated genome-wide IBS. proportion IBD two individuals returned plink –genome PI_HAT. check_relatedness finds pairs samples whose proportion IBD larger specified highIBDTh. Subsequently, pairs individuals additional relatives dataset, individual greater genotype missingness rate selected returned individual failing relatedness check. complex family structures, unrelated individuals per family selected (e.g. parents-offspring trio, offspring marked fail, parents kept analysis). check_relatedness depicts pair-wise IBD-estimates histograms stratified value PI_HAT.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_relatedness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identification of related individuals — check_relatedness","text":"","code":"check_relatedness(   indir,   name,   qcdir = indir,   highIBDTh = 0.1875,   filter_high_ldregion = TRUE,   high_ldregion_file = NULL,   genomebuild = \"hg19\",   imissTh = 0.03,   run.check_relatedness = TRUE,   interactive = FALSE,   verbose = FALSE,   mafThRelatedness = 0.1,   path2plink = NULL,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   title_size = 9,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_relatedness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identification of related individuals — check_relatedness","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam, name.genome name.imiss. qcdir [character] /path//directory name.genome returned plink –genome saved.  Per default qcdir=indir. run.check_relatedness FALSE, assumed plink –missing plink –genome run qcdir/name.imiss qcdir/name.genome exist. User needs writing permission qcdir. highIBDTh [double] Threshold acceptable proportion IBD pair individuals. filter_high_ldregion [logical] high LD regions filtered IBD estimation; carried per default high LD regions hg19 provided default via genomebuild. alternative genome builds provided non-human data, high LD regions files can provided via high_ldregion_file. high_ldregion_file [character] Path file high LD regions used filtering IBD estimation filter_high_ldregion == TRUE, otherwise ignored; human genome data, high LD region files provided can simply chosen via genomebuild. Files space-delimited, column names following columns: chromosome, region-start, region-end, region number. Chromosomes specified without 'chr' prefix. instance: 1 48000000 52000000 1 2 86000000 100500000 2 genomebuild [character] Name genome build PLINK file annotations, ie mappings name.bim file. used remove high-LD regions based coordinates respective build. Options hg18, hg19 hg38. See @details. imissTh [double] Threshold acceptable missing genotype rate individual; proportion (0,1) run.check_relatedness [logical] plink –genome run determine pairwise IBD individuals; FALSE, assumed plink –genome plink –missing run qcdir/name.imiss qcdir/name.genome present; check_relatedness fail missing file error otherwise. interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_IBD() via ggplot2::ggsave(p=p_IBD, other_arguments) pdf(outfile) print(p_IBD) dev.(). verbose [logical] TRUE, progress info printed standard . mafThRelatedness [double] Threshold minor allele frequency filter selecting variants IBD estimation. path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. title_size [integer] Size plot title. showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_relatedness.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identification of related individuals — check_relatedness","text":"Named [list] ) fail_high_IBD containing [data.frame] IIDs FIDs individuals fail IBDTh columns FID1 IID1. addition, following columns returned (originally obtained plink –genome): FID2 (Family ID second sample), IID2 (Individual ID second sample), RT (Relationship type inferred .fam/.ped file), EZ (IBD sharing expected value, based just .fam/.ped relationship), Z0 (P(IBD=0)), Z1 (P(IBD=1)), Z2 (P(IBD=2)), PI_HAT (Proportion IBD, .e. P(IBD=2) + 0.5*P(IBD=1)), PHE (Pairwise phenotypic code (1, 0, -1 = AA, AU, UU pairs, respectively)), DST (IBS distance, .e. (IBS2 + 0.5*IBS1) / (IBS0 + IBS1 + IBS2)), PPC (IBS binomial test), RATIO (HETHET : IBS0 SNP ratio (expected value 2)). ii) failIDs containing [data.frame] individual IDs [IID] family IDs [FID] individuals failing highIBDTh iii) p_IBD, ggplot2-object 'containing' pair-wise IBD-estimates histograms stratified value PI_HAT, can shown print(p_IBD).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_relatedness.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identification of related individuals — check_relatedness","text":"check_relatedness wraps around run_check_relatedness evaluate_check_relatedness. run.check_relatedness TRUE, run_check_relatedness executed ; otherwise assumed plink –genome run externally qcdir/name.genome exists. check_relatedness  fail missing file error otherwise. details output data.frame fail_high_IBD, check original description PLINK output format page: https://www.cog-genomics.org/plink/1.9/formats#genome.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_relatedness.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identification of related individuals — check_relatedness","text":"","code":"if (FALSE) { # \\dontrun{ indir <- system.file(\"extdata\", package=\"plinkQC\") name <- 'data' path2plink <- \"path/to/plink\"  # whole dataset relatednessQC <- check_relatedness(indir=indir, name=name, interactive=FALSE, run.check_relatedness=FALSE, path2plink=path2plink)  # subset of dataset remove_individuals_file <- system.file(\"extdata\", \"remove_individuals\", package=\"plinkQC\") fail_relatedness <- check_relatedness(indir=qcdir, name=name, remove_individuals=remove_individuals_file, path2plink=path2plink) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_sex.html","id":null,"dir":"Reference","previous_headings":"","what":"Identification of individuals with discordant sex information — check_sex","title":"Identification of individuals with discordant sex information — check_sex","text":"Runs evaluates results plink –check-sex. check_sex returns IIDs individuals whose SNPSEX != PEDSEX (SNPSEX determined heterozygosity rate across X-chromosomal variants). Mismatching SNPSEX PEDSEX IDs can indicate plating errors, sample-mixup generally samples poor genotyping. latter case, IDs likely fail QC steps well. Optionally, extra data.frame (externalSex) sample IDs sex can provided double check external PEDSEX data (often processed different centers) match. mismatch PEDSEX SNPSEX detected, SNPSEX == Sex, PEDSEX individuals can optionally updated (fixMixup=TRUE). check_sex depicts X-chromosomal heterozygosity (SNPSEX) individuals split (PEDSEX).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_sex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identification of individuals with discordant sex information — check_sex","text":"","code":"check_sex(   indir,   name,   qcdir = indir,   maleTh = 0.8,   femaleTh = 0.2,   run.check_sex = TRUE,   externalSex = NULL,   externalFemale = \"F\",   externalMale = \"M\",   externalSexSex = \"Sex\",   externalSexID = \"IID\",   fixMixup = FALSE,   interactive = FALSE,   verbose = FALSE,   label_fail = TRUE,   highlight_samples = NULL,   highlight_type = c(\"text\", \"label\", \"color\", \"shape\"),   highlight_text_size = 3,   highlight_color = \"#c51b8a\",   highlight_shape = 17,   highlight_legend = FALSE,   path2plink = NULL,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   title_size = 9,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_sex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identification of individuals with discordant sex information — check_sex","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam name.sexcheck. qcdir [character] /path//directory save name.sexcheck returned plink –check-sex. Per default qcdir=indir. run.check_sex FALSE, assumed plink –check-sex run qcdir/name.sexcheck present. User needs writing permission qcdir. maleTh [double] Threshold X-chromosomal heterozygosity rate males. femaleTh [double] Threshold X-chromosomal heterozygosity rate females. run.check_sex [logical] plink –check-sex run? set FALSE, assumed plink –check-sex run qcdir/name.sexcheck present; check_sex  fail missing file error otherwise. externalSex [data.frame, optional] Dataframe sample IDs [externalSexID] sex [externalSexSex] double check external PEDSEX data (often processed different centers) match. externalFemale [integer/character] Identifier 'female' externalSex. externalMale [integer/character] Identifier 'male' externalSex. externalSexSex [character] Column identifier column containing sex information externalSex. externalSexID [character] Column identifier column containing ID information externalSex. fixMixup [logical] PEDSEX individuals mismatch PEDSEX Sex Sex==SNPSEX automatically corrected: directly change name.bim/.bed/.fam files! interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_sexcheck) via ggplot2::ggsave(p=p_sexcheck, other_arguments) pdf(outfile) print(p_sexcheck) dev.(). verbose [logical] TRUE, progress info printed standard . label_fail [logical] Set TRUE, add fail IDs text labels scatter plot. highlight_samples [character vector] Vector sample IIDs highlight plot (p_sexcheck); highlight_samples IIDs present IIDs name.fam file. highlight_type [character]  Type sample highlight, labeling IID (\"text\"/\"label\") /highlighting data points different \"color\" /\"shape\". \"text\" \"label\" use ggrepel minimal overlap text labels (\"text) label boxes (\"label\").  one \"text\" \"label\" can specified. Text/Label size can specified highlight_text_size, highlight color highlight_color, highlight shape highlight_shape. highlight_text_size [integer] Text/Label size samples specified highlighted (highlight_samples) \"text\" \"label\" (highlight_type). highlight_color [character] Color samples specified highlighted (highlight_samples) \"color\" (highlight_type). highlight_shape [integer] Shape samples specified highlighted (highlight_samples) \"shape\" (highlight_type). Possible shapes encoding can found : https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#sec:shape-spec highlight_legend [logical] separate legend highlighted samples provided; relevant highlight_type == \"color\" highlight_type == \"shape\". path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. title_size [integer] Size plot title. showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_sex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identification of individuals with discordant sex information — check_sex","text":"Named list ) fail_sex: [data.frame] FID, IID, PEDSEX, SNPSEX Sex (externalSex provided) individuals failing sex check, ii) mixup: dataframe FID, IID, PEDSEX, SNPSEX Sex (externalSex provided) individuals whose PEDSEX != Sex Sex == SNPSEX iii) p_sexcheck, ggplot2-object 'containing' scatter plot X-chromosomal heterozygosity (SNPSEX) sample split (PEDSEX), can shown print(p_sexcheck).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_sex.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identification of individuals with discordant sex information — check_sex","text":"check_sex wraps around run_check_sex  evaluate_check_sex. run.check_sex TRUE, run_check_sex executed ; otherwise assumed plink –check-sex run externally qcdir/name.sexcheck exists. check_sex  fail missing file error otherwise. details output data.frame fail_sex, check original description PLINK output format page: https://www.cog-genomics.org/plink/1.9/formats#sexcheck.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_sex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identification of individuals with discordant sex information — check_sex","text":"","code":"if (FALSE) { # \\dontrun{ indir <- system.file(\"extdata\", package=\"plinkQC\") name <- \"data\"  # whole dataset fail_sex <- check_sex(indir=indir, name=name, run.check_sex=FALSE, interactive=FALSE, verbose=FALSE)  # subset of dataset with sample highlighting highlight_samples <- read.table(system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\")) remove_individuals_file <- system.file(\"extdata\", \"remove_individuals\", package=\"plinkQC\") fail_sex <- check_sex(indir=indir, name=name, interactive=FALSE, path2plink=path2plink, remove_individuals=remove_individuals_file, highlight_samples=highlight_samples[,2], highlight_type = c(\"text\", \"shape\")) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_snp_missingness.html","id":null,"dir":"Reference","previous_headings":"","what":"Identification of SNPs with high missingness rate — check_snp_missingness","title":"Identification of SNPs with high missingness rate — check_snp_missingness","text":"Runs evaluates results plink –missing –freq. calculate rates missing genotype calls frequency variants individuals passed perIndividualQC. SNP missingness rates (stratified minor allele frequency) depicted histograms.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_snp_missingness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identification of SNPs with high missingness rate — check_snp_missingness","text":"","code":"check_snp_missingness(   indir,   name,   qcdir = indir,   lmissTh = 0.01,   interactive = FALSE,   path2plink = NULL,   verbose = FALSE,   showPlinkOutput = TRUE,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   title_size = 9 )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_snp_missingness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identification of SNPs with high missingness rate — check_snp_missingness","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam. qcdir [character] /path//directory results written . perIndividualQC conducted, directory qcdir specified perIndividualQC, .e. contains name.fail.IDs IIDs individuals failed QC. User needs writing permission qcdir. Per default, qcdir=indir. lmissTh [double] Threshold acceptable variant missing rate across samples. interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_lmiss) via ggplot2::ggsave(p=p_lmiss, other_arguments) pdf(outfile) print(p_lmiss) dev.(). path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). verbose [logical] TRUE, progress info printed standard specifically, TRUE, plink log displayed. showPlinkOutput [logical] TRUE, plink log error messages printed standard . keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. title_size [integer] Size plot title.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_snp_missingness.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identification of SNPs with high missingness rate — check_snp_missingness","text":"Named list ) fail_missingness containing [data.frame] CHR (Chromosome code), SNP (Variant identifier), CLST (Cluster identifier. present –within/–family), N_MISS (Number missing genotype call(s), counting obligatory missings), N_CLST  (Cluster size; include nonmales Ychr; present –within/–family), N_GENO (Number potentially valid call(s)), F_MISS (Missing call rate) SNPs failing lmissTh ii) p_lmiss, ggplot2-object 'containing' SNP missingness histogram can shown (print(p_lmiss)).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_snp_missingness.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identification of SNPs with high missingness rate — check_snp_missingness","text":"check_snp_missingness uses plink –remove name.fail.IDs –missing –freq calculate rates missing genotype calls frequency per SNP individuals passed perIndividualQC. without generating new dataset simply removes IDs calculating statistics. details output data.frame fail_missingness, check original description PLINK output format page: https://www.cog-genomics.org/plink/1.9/formats#lmiss.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/check_snp_missingness.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identification of SNPs with high missingness rate — check_snp_missingness","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") qcdir <- tempdir() name <- \"data\" path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. if (FALSE) { # \\dontrun{ # run on all individuals and markers fail_snp_missingness <- check_snp_missingness(qcdir=qcdir, indir=indir, name=name, interactive=FALSE, verbose=TRUE, path2plink=path2plink)  # run on subset of individuals and markers keep_individuals_file <- system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\") extract_markers_file <- system.file(\"extdata\", \"extract_markers\", package=\"plinkQC\") fail_snp_missingness <- check_snp_missingness(qcdir=qcdir, indir=indir, name=name, interactive=FALSE, verbose=TRUE, path2plink=path2plink, keep_individuals=keep_individuals_file, extract_markers=extract_markers_file) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/cleanData.html","id":null,"dir":"Reference","previous_headings":"","what":"Create plink dataset with individuals and markers passing quality control — cleanData","title":"Create plink dataset with individuals and markers passing quality control — cleanData","text":"Individuals fail per-individual QC markers fail per-marker QC removed indir/name.bim/.bed/.fam new, dataset remaining individuals markers created qcdir/name.clean.bim/.bed/.fam.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/cleanData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create plink dataset with individuals and markers passing quality control — cleanData","text":"","code":"cleanData(   indir,   name,   qcdir = indir,   filterSex = TRUE,   filterHeterozygosity = TRUE,   filterSampleMissingness = TRUE,   filterAncestry = TRUE,   filterRelated = TRUE,   filterSNPMissingness = TRUE,   lmissTh = 0.01,   filterHWE = TRUE,   hweTh = 1e-05,   filterMAF = TRUE,   macTh = 20,   mafTh = NULL,   path2plink = NULL,   verbose = FALSE,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/cleanData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create plink dataset with individuals and markers passing quality control — cleanData","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam. qcdir [character] /path//directory results written . perIndividualQC conducted, directory qcdir specified perIndividualQC, .e. contains name.fail.IDs IIDs individuals failed QC. User needs writing permission qcdir. Per default, qcdir=indir. filterSex [logical] Set exclude samples failed sex check (via check_sex perIndividualQC). Requires file qcdir/name.fail-sexcheck.IDs (automatically created perIndividualQC .evaluate_check_sex set TRUE). filterHeterozygosity [logical] Set exclude samples failed check outlying heterozygosity rates (via check_het_and_miss perIndividualQC). Requires file qcdir/name.fail-het.IDs (automatically created perIndividualQC .evaluate_check_het_and_miss set TRUE). filterSampleMissingness [logical] Set exclude samples failed check excessive missing genotype rates (via check_het_and_miss perIndividualQC). Requires file qcdir/name.fail-imiss.IDs (automatically created perIndividualQC .evaluate_check_het_and_miss set TRUE). filterAncestry [logical] Set exclude samples failed ancestry check (via check_ancestry perIndividualQC). Requires file qcdir/name.fail-ancestry.IDs (automatically created perIndividualQC .check_ancestry set TRUE). filterRelated [logical] Set exclude samples failed relatedness check (via check_relatedness perIndividualQC). Requires file qcdir/name.fail-IBD.IDs (automatically created perIndividualQC .evaluate_check_relatedness set TRUE). filterSNPMissingness [logical] Set exclude markers excessive missing rates across samples (via check_snp_missingness perMarkerQC). Requires lmissTh set. lmissTh [double] Threshold acceptable variant missing rate across samples. filterHWE [logical] Set exclude markers fail HWE exact test (via check_hwe perMarkerQC). Requires hweTh set. hweTh [double] Significance threshold deviation HWE. filterMAF [logical] Set exclude markers fail minor allele frequency minor allele count threshold (via check_maf perMarkerQC). Requires mafTh macTh set. macTh [double] Threshold minor allele cut cut-, mafTh macTh specified, macTh used (macTh = mafTh\\*2\\*NrSamples). mafTh [double] Threshold minor allele frequency cut-. path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). verbose [logical] TRUE, progress info printed standard . keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/cleanData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create plink dataset with individuals and markers passing quality control — cleanData","text":"names [list] ) passIDs, containing [data.frame] family [FID] individual [IID] IDs samples pass QC, ii) failIDs, containing [data.frame] family [FID] individual [IID] IDs samples fail QC.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/cleanData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create plink dataset with individuals and markers passing quality control — cleanData","text":"","code":"package.dir <- find.package('plinkQC') indir <- file.path(package.dir, 'extdata') qcdir <- tempdir() name <- \"data\" path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. if (FALSE) { # \\dontrun{ # Run qc on all samples and markers in the dataset ## Run individual QC checks fail_individuals <- perIndividualQC(indir=indir, qcdir=qcdir, name=name, refSamplesFile=paste(qcdir, \"/HapMap_ID2Pop.txt\",sep=\"\"), refColorsFile=paste(qcdir, \"/HapMap_PopColors.txt\", sep=\"\"), prefixMergedDataset=\"data.HapMapIII\", interactive=FALSE, verbose=FALSE, path2plink=path2plink)  ## Run marker QC checks fail_markers <- perMarkerQC(indir=indir, qcdir=qcdir, name=name, path2plink=path2plink)  ## Create new dataset of individuals and markers passing QC ids_all <- cleanData(indir=indir, qcdir=qcdir, name=name, macTh=15, verbose=TRUE, path2plink=path2plink, filterAncestry=FALSE, filterRelated=TRUE)  # Run qc on subset of samples and markers in the dataset highlight_samples <- read.table(system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\")) remove_individuals_file <- system.file(\"extdata\", \"remove_individuals\", package=\"plinkQC\")  fail_individuals <- perIndividualQC(indir=indir, qcdir=qcdir, name=name, dont.check_ancestry = TRUE, interactive=FALSE, verbose=FALSE, highlight_samples = highlight_samples[,2], highlight_type = \"label\", remove_individuals = remove_individuals_file, path2plink=path2plink)  ## Run marker QC checks fail_markers <- perMarkerQC(indir=indir, qcdir=qcdir, name=name, path2plink=path2plink)  ## Create new dataset of individuals and markers passing QC ids_all <- cleanData(indir=indir, qcdir=qcdir, name=name, macTh=15, verbose=TRUE, path2plink=path2plink, filterAncestry=FALSE, remove_individuals = remove_individuals_file) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/convert_to_plink2.html","id":null,"dir":"Reference","previous_headings":"","what":"Converting PLINK v1.9 data files into PLINK v2.0 data files — convert_to_plink2","title":"Converting PLINK v1.9 data files into PLINK v2.0 data files — convert_to_plink2","text":"converts files PLINK v1.9 format (.e. name.bim, name.fam, name.bed) PLINK v2.0 format (.e. name.pvar, name.psam, name.pgen)","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/convert_to_plink2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Converting PLINK v1.9 data files into PLINK v2.0 data files — convert_to_plink2","text":"","code":"convert_to_plink2(   indir,   name,   qcdir = indir,   verbose = FALSE,   path2plink2 = NULL,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/convert_to_plink2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Converting PLINK v1.9 data files into PLINK v2.0 data files — convert_to_plink2","text":"indir [character] /path//directory containing basic PLINK 1.9 data file name.bim, name.fam, name.bed name [character] Prefix PLINK 1.9 files, .e. name.bim, name.fam, name.bed qcdir [character] /path//directory plink2 data formations returned plink2 –make-pgen saved . User needs writing permission qcdir. Per default qcdir=indir. verbose [logical] TRUE, progress info printed standard . path2plink2 [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/2.0/) .e. plink 2 accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/convert_to_plink2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Converting PLINK v1.9 data files into PLINK v2.0 data files — convert_to_plink2","text":"Creates plink 2.0 datafiles","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/convert_to_plink2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Converting PLINK v1.9 data files into PLINK v2.0 data files — convert_to_plink2","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") qcdir <- tempdir() name <- \"data\" path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. if (FALSE) { # \\dontrun{ convert_to_plink2(indir=indir, qcdir=qcdir, name=name, path2plink2 = path2plink2) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_ancestry.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate results from PLINK PCA on combined study and reference data — evaluate_check_ancestry","title":"Evaluate results from PLINK PCA on combined study and reference data — evaluate_check_ancestry","text":"Evaluates depicts results plink –pca (via run_check_ancestry externally conducted pca) merged genotypes individuals QCed individuals reference population known genotypes. Currently, check ancestry supports automatic selection individuals European descent. uses information principal components 1 2 returned plink –pca find center European reference samples (mean(PC1_europeanRef), mean(PC2_europeanRef). computes maximum Euclidean distance (maxDist) European reference samples centre. study samples whose Euclidean distance centre falls outside circle described radius r=europeanTh* maxDist considered non-European IDs returned failing ancestry check. check_ancestry creates scatter plot PC1 versus PC2 colour-coded samples reference populations study population.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_ancestry.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate results from PLINK PCA on combined study and reference data — evaluate_check_ancestry","text":"","code":"evaluate_check_ancestry(   indir,   name,   prefixMergedDataset,   qcdir = indir,   europeanTh = 1.5,   defaultRefSamples = c(\"HapMap\", \"1000Genomes\"),   refSamples = NULL,   refColors = NULL,   refSamplesFile = NULL,   refColorsFile = NULL,   refSamplesIID = \"IID\",   refSamplesPop = \"Pop\",   refColorsColor = \"Color\",   refColorsPop = \"Pop\",   studyColor = \"#2c7bb6\",   refPopulation = c(\"CEU\", \"TSI\"),   legend_labels_per_row = 6,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   title_size = 9,   highlight_samples = NULL,   highlight_type = c(\"text\", \"label\", \"color\", \"shape\"),   highlight_text_size = 3,   highlight_color = \"#c51b8a\",   highlight_shape = 17,   highlight_legend = FALSE,   interactive = FALSE,   verbose = FALSE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_ancestry.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate results from PLINK PCA on combined study and reference data — evaluate_check_ancestry","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam. prefixMergedDataset [character] Prefix merged dataset (study reference samples) used plink –pca, resulting prefixMergedDataset.eigenvec. qcdir [character] /path//directory//QC/results containing prefixMergedDataset.eigenvec results returned plink –pca. Per default qcdir=indir. europeanTh [double] Scaling factor radius drawn around center European reference samples, study samples inside radius considered European descent samples outside radius non-European descent. radius computed maximum Euclidean distance European reference samples centre European reference samples. defaultRefSamples [character] Option use pre-downloaded individual population identifiers either 1000Genomes HapMap project. refSamples refSamplesFile provided, HapMap identifiers (1000Genomes specified) used default function fail reference samples prefixMergedDataset match reference samples. refColors refColorsFile provided, also sets default colors reference populations. refSamples [data.frame] Dataframe sample identifiers [refSamplesIID] corresponding IIDs prefixMergedDataset.eigenvec population identifier [refSamplesPop] corresponding population IDs [refColorsPop] refColorsfile/refColors. refSamples refSamplesFile specified, defaultRefSamples used reference. refColors [data.frame, optional] Dataframe population IDs column [refColorsPop] corresponding colour-code PCA plot column [refColorsColor].  refColors refColorsFile specified refSamples refSamplesFile specified, default colors determined defaultRefSamples option. refColors refColorsFile specified refSamples refSamplesFile given, ggplot default colors used. refSamplesFile [character] /path//File//reference samples. Needs columns sample identifiers [refSamplesIID] corresponding IIDs prefixMergedDataset.eigenvec population identifier [refSamplesPop] corresponding population IDs [refColorsPop] refColorsfile/refColors. refSamplesFile refSamples NULL, defaultRefSamples information used. refColorsFile [character, optional] /path//File//Population/Colors containing population IDs column [refColorsPop] corresponding colour-code PCA plot column [refColorsColor]. refColors refColorsFile specified refSamples refSamplesFile specified, default colors determined defaultRefSamples option. refColors refColorsFile specified refSamples refSamplesFile given, ggplot default colors used. refSamplesIID [character] Column name reference sample IDs refSamples/refSamplesFile. refSamplesPop [character] Column name reference sample population IDs refSamples/refSamplesFile. refColorsColor [character] Column name population colors refColors/refColorsFile refColorsPop [character] Column name reference sample population IDs refColors/refColorsFile. studyColor [character] Colour used study population plot TRUE. refPopulation [vector] Vector population identifiers European reference population. Identifiers corresponding population IDs [refColorsPop] refColorsfile/refColors. legend_labels_per_row [integer] Number population names per row PCA plot. legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. title_size [integer] Size plot title. highlight_samples [character vector] Vector sample IIDs highlight plot (p_ancestry); highlight_samples IIDs present IIDs prefixMergedDataset.fam file. highlight_type [character]  Type sample highlight, labeling IID (\"text\"/\"label\") /highlighting data points different \"color\" /\"shape\". \"text\" \"label\" use ggrepel minimal overlap text labels (\"text) label boxes (\"label\").  one \"text\" \"label\" can specified.Text/Label size can specified highlight_text_size, highlight color highlight_color, highlight shape highlight_shape. highlight_text_size [integer] Text/Label size samples specified highlighted (highlight_samples) \"text\" \"label\" (highlight_type). highlight_color [character] Color samples specified highlighted (highlight_samples) \"color\" (highlight_type). highlight_shape [integer] Shape samples specified highlighted (highlight_samples) \"shape\" (highlight_type). Possible shapes encoding can found : https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#sec:shape-spec highlight_legend [logical] separate legend highlighted samples provided; relevant highlight_type == \"color\" highlight_type == \"shape\". interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_ancestry) via ggplot2::ggsave(p=p_ancestry, other_arguments) pdf(outfile) print(p_ancestry) dev.(). verbose [logical] TRUE, progress info printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_ancestry.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate results from PLINK PCA on combined study and reference data — evaluate_check_ancestry","text":"Named [list] ) fail_ancestry, containing [data.frame] FID IID non-European individuals ii) p_ancestry, ggplot2-object 'containing' scatter plot PC1 versus PC2 colour-coded samples reference populations study population, can shown print(p_ancestry) iii) plot_data, data.frame data visualised p_ancestry (ii).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_ancestry.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Evaluate results from PLINK PCA on combined study and reference data — evaluate_check_ancestry","text":"run_check_ancestry evaluate_check_ancestry can simply invoked check_ancestry. 1000 Genomes samples downloaded https://www.internationalgenome.org/category/sample/, HapMap Phase 3 samples downloaded https://www.broadinstitute.org/medical--population-genetics/hapmap-3.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_ancestry.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluate results from PLINK PCA on combined study and reference data — evaluate_check_ancestry","text":"","code":"if (FALSE) { # \\dontrun{ qcdir <- system.file(\"extdata\", package=\"plinkQC\") name <- \"data\"  # whole dataset fail_ancestry <- evaluate_check_ancestry(indir=qcdir, name=name, refSamplesFile=paste(qcdir, \"/HapMap_ID2Pop.txt\",sep=\"\"), refColorsFile=paste(qcdir, \"/HapMap_PopColors.txt\", sep=\"\"), prefixMergedDataset=\"data.HapMapIII\", interactive=FALSE)  # highlight samples highlight_samples <- read.table(system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\")) fail_ancestry <- evaluate_check_ancestry(indir=qcdir, name=name, refSamplesFile=paste(qcdir, \"/HapMap_ID2Pop.txt\",sep=\"\"), refColorsFile=paste(qcdir, \"/HapMap_PopColors.txt\", sep=\"\"), prefixMergedDataset=\"data.HapMapIII\", interactive=FALSE, highlight_samples = highlight_samples[,2], highlight_type = c(\"text\", \"shape\")) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_het_and_miss.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate results from PLINK missing genotype and heterozygosity rate check. — evaluate_check_het_and_miss","title":"Evaluate results from PLINK missing genotype and heterozygosity rate check. — evaluate_check_het_and_miss","text":"Evaluates depicts results plink –missing (missing genotype rates per individual) plink –het (heterozygosity rates per individual) via run_check_heterozygosity run_check_missingness externally conducted check.) Non-systematic failures genotyping outlying heterozygosity (hz) rates per individual often proxies DNA sample quality. Larger expected heterozygosity can indicate possible DNA contamination. mean heterozygosity PLINK computed hz_mean = (N-O)/N, N: number non-missing genotypes O:observed number homozygous genotypes given individual. Mean heterozygosity can differ populations SNP genotyping panels. Within population genotyping panel, reduced heterozygosity rate can indicate inbreeding - individuals returned check_relatedness individuals fail relatedness filters. evaluate_check_het_and_miss creates scatter plot individuals' missingness rates x-axis heterozygosity rates y-axis.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_het_and_miss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate results from PLINK missing genotype and heterozygosity rate check. — evaluate_check_het_and_miss","text":"","code":"evaluate_check_het_and_miss(   qcdir,   name,   imissTh = 0.03,   hetTh = 3,   label_fail = TRUE,   highlight_samples = NULL,   highlight_type = c(\"text\", \"label\", \"color\", \"shape\"),   highlight_text_size = 3,   highlight_color = \"#c51b8a\",   highlight_shape = 17,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   title_size = 9,   highlight_legend = FALSE,   interactive = FALSE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_het_and_miss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate results from PLINK missing genotype and heterozygosity rate check. — evaluate_check_het_and_miss","text":"qcdir [character] path//directory//QC/results containing name.imiss name.het results returned plink –missing plink –het. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam, name.het name.imiss. imissTh [double] Threshold acceptable missing genotype rate individual; proportion (0,1) hetTh [double] Threshold acceptable deviation mean heterozygosity individual. Expressed multiples standard deviation heterozygosity (het), .e. individuals outside mean(het) +/- hetTh*sd(het) returned failing heterozygosity check; larger 0. label_fail [logical] Set TRUE, add fail IDs text labels scatter plot. highlight_samples [character vector] Vector sample IIDs highlight plot (p_het_imiss); highlight_samples IIDs present IIDs name.fam file. highlight_type [character]  Type sample highlight, labeling IID (\"text\"/\"label\") /highlighting data points different \"color\" /\"shape\". \"text\" \"label\" use ggrepel minimal overlap text labels (\"text) label boxes (\"label\").  one \"text\" \"label\" can specified.Text/Label size can specified highlight_text_size, highlight color highlight_color, highlight shape highlight_shape. highlight_text_size [integer] Text/Label size samples specified highlighted (highlight_samples) \"text\" \"label\" (highlight_type). highlight_color [character] Color samples specified highlighted (highlight_samples) \"color\" (highlight_type). highlight_shape [integer] Shape samples specified highlighted (highlight_samples) \"shape\" (highlight_type). Possible shapes encoding can found : https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#sec:shape-spec legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. title_size [integer] Size plot title. highlight_legend [logical] separate legend highlighted samples provided; relevant highlight_type == \"color\" highlight_type == \"shape\". interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_het_imiss) via ggplot2::ggsave(p=p_het_imiss , other_arguments) pdf(outfile) print(p_het_imiss) dev.().","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_het_and_miss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate results from PLINK missing genotype and heterozygosity rate check. — evaluate_check_het_and_miss","text":"named [list] ) fail_imiss dataframe containing FID (Family ID), IID (Within-family ID), MISS_PHENO (Phenotype missing? (Y/N)), N_MISS (Number missing genotype call(s), including obligatory missings), N_GENO ( Number potentially valid call(s)), F_MISS (Missing call rate) individuals failing missing genotype check ii) fail_het dataframe containing FID (Family ID), IID (Within-family ID), O(HOM) (Observed number homozygotes), E(HOM) (Expected number homozygotes), N(NM) (Number non-missing autosomal genotypes), F (Method--moments F coefficient estimate) individuals failing  outlying heterozygosity check; iii) p_het_imiss, ggplot2-object 'containing' scatter plot samples' missingness rates x-axis heterozygosity rates y-axis, can shown print(p_het_imiss) iv) plot_data, data.frame data visualised p_het_imiss (iii).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_het_and_miss.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Evaluate results from PLINK missing genotype and heterozygosity rate check. — evaluate_check_het_and_miss","text":", run_check_heterozygosity, run_check_missingness evaluate_check_het_and_miss can simply invoked check_het_and_miss. details output data.frame fail_imiss fail_het, check original description PLINK output format page: https://www.cog-genomics.org/plink/1.9/formats#imiss https://www.cog-genomics.org/plink/1.9/formats#het","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_het_and_miss.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluate results from PLINK missing genotype and heterozygosity rate check. — evaluate_check_het_and_miss","text":"","code":"qcdir <- system.file(\"extdata\", package=\"plinkQC\") name <- \"data\" if (FALSE) { # \\dontrun{ fail_het_miss <- evaluate_check_het_and_miss(qcdir=qcdir, name=name, interactive=FALSE)  #' # highlight samples highlight_samples <- read.table(system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\")) fail_het_miss <- evaluate_check_het_and_miss(qcdir=qcdir, name=name, interactive=FALSE, highlight_samples = highlight_samples[,2], highlight_type = c(\"text\", \"color\")) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_relatedness.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate results from PLINK IBD estimation. — evaluate_check_relatedness","title":"Evaluate results from PLINK IBD estimation. — evaluate_check_relatedness","text":"Evaluates depicts results plink –genome LD pruned dataset (via run_check_relatedness externally conducted IBD estimation). plink –genome calculates identity state (IBS) pair individuals based average proportion alleles shared genotyped SNPs. degree recent shared ancestry, .e. identity descent (IBD) can estimated genome-wide IBS. proportion IBD two individuals returned –genome PI_HAT. evaluate_check_relatedness finds pairs samples whose proportion IBD larger specified highIBDTh. Subsequently, pairs individual additional relatives dataset, individual greater genotype missingness rate selected returned individual failing relatedness check. complex family structures, unrelated individuals per family selected (e.g. parents-offspring trio, offspring marked fail, parents kept analysis). evaluate_check_relatedness depicts pair-wise IBD-estimates histograms stratified value PI_HAT.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_relatedness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate results from PLINK IBD estimation. — evaluate_check_relatedness","text":"","code":"evaluate_check_relatedness(   qcdir,   name,   highIBDTh = 0.1875,   imissTh = 0.03,   interactive = FALSE,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   title_size = 9,   verbose = FALSE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_relatedness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate results from PLINK IBD estimation. — evaluate_check_relatedness","text":"qcdir [character] path//directory//QC/results containing name.imiss name.genome results returned plink –missing plink –genome. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam, name.genome name.imiss. highIBDTh [double] Threshold acceptable proportion IBD pair individuals. imissTh [double] Threshold acceptable missing genotype rate individual; proportion (0,1) interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_IBD() via ggplot2::ggsave(p=p_IBD, other_arguments) pdf(outfile) print(p_IBD) dev.(). legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. title_size [integer] Size plot title. verbose [logical] TRUE, progress info printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_relatedness.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate results from PLINK IBD estimation. — evaluate_check_relatedness","text":"named [list] ) fail_high_IBD containing [data.frame] IIDs FIDs individuals fail IBDTh columns FID1 IID1. addition, following columns returned (originally obtained plink –genome): FID2 (Family ID second sample), IID2 (Individual ID second sample), RT (Relationship type inferred .fam/.ped file), EZ (IBD sharing expected value, based just .fam/.ped relationship), Z0 (P(IBD=0)), Z1 (P(IBD=1)), Z2 (P(IBD=2)), PI_HAT (Proportion IBD, .e. P(IBD=2) + 0.5*P(IBD=1)), PHE (Pairwise phenotypic code (1, 0, -1 = AA, AU, UU pairs, respectively)), DST (IBS distance, .e. (IBS2 + 0.5*IBS1) / (IBS0 + IBS1 + IBS2)), PPC (IBS binomial test), RATIO (HETHET : IBS0 SNP ratio (expected value 2)). ii) failIDs containing [data.frame] individual IDs [IID] family IDs [FID] individuals failing highIBDTh; iii) p_IBD, ggplot2-object 'containing' pair-wise IBD-estimates histograms stratified value PI_HAT, can shown print(p_IBD iv) plot_data, data.frame data visualised p_IBD (iii).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_relatedness.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Evaluate results from PLINK IBD estimation. — evaluate_check_relatedness","text":"run_check_relatedness evaluate_check_relatedness can simply invoked check_relatedness. details output data.frame fail_high_IBD, check original description PLINK output format page: https://www.cog-genomics.org/plink/1.9/formats#genome.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_relatedness.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluate results from PLINK IBD estimation. — evaluate_check_relatedness","text":"","code":"qcdir <- system.file(\"extdata\", package=\"plinkQC\") name <- 'data' if (FALSE) { # \\dontrun{ relatednessQC <- evaluate_check_relatedness(qcdir=qcdir, name=name, interactive=FALSE) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_sex.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate results from PLINK sex check. — evaluate_check_sex","title":"Evaluate results from PLINK sex check. — evaluate_check_sex","text":"Evaluates depicts results plink –check-sex (via run_check_sex externally conducted sex check). Takes file qcdir/name.sexcheck returns IIDs samples whose SNPSEX != PEDSEX (SNPSEX determined heterozygosity rate across X-chromosomal variants). Mismatching SNPSEX PEDSEX IDs can indicate plating errors, sample-mixup generally samples poor genotyping. latter case, IDs likely fail QC steps well. Optionally, extra data.frame (externalSex) sample IDs sex can provided double check external PEDSEX data (often processed different centers) match. mismatch PEDSEX SNPSEX detected SNPSEX == Sex, PEDSEX individuals can optionally updated (fixMixup=TRUE). evaluate_check_sex depicts X-chromosomal heterozygosity (SNPSEX) samples split (PEDSEX).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_sex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate results from PLINK sex check. — evaluate_check_sex","text":"","code":"evaluate_check_sex(   qcdir,   name,   maleTh = 0.8,   femaleTh = 0.2,   externalSex = NULL,   fixMixup = FALSE,   indir = qcdir,   externalFemale = \"F\",   externalMale = \"M\",   externalSexSex = \"Sex\",   externalSexID = \"IID\",   verbose = FALSE,   label_fail = TRUE,   highlight_samples = NULL,   highlight_type = c(\"text\", \"label\", \"color\", \"shape\"),   highlight_text_size = 3,   highlight_color = \"#c51b8a\",   highlight_shape = 17,   highlight_legend = FALSE,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   title_size = 9,   path2plink = NULL,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   showPlinkOutput = TRUE,   interactive = FALSE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_sex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate results from PLINK sex check. — evaluate_check_sex","text":"qcdir [character] /path//directory containing name.sexcheck returned plink –check-sex. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam name.sexcheck. maleTh [double] Threshold X-chromosomal heterozygosity rate males. femaleTh [double] Threshold X-chromosomal heterozygosity rate females. externalSex [data.frame, optional] sample IDs [externalSexID] sex [externalSexSex] double check external PEDSEX data (often processed different centers) match. fixMixup [logical] PEDSEX individuals mismatch PEDSEX Sex, Sex==SNPSEX automatically corrected: directly change name.bim/.bed/.fam files! indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files; required fixMixup==TRUE. User needs writing permission indir. externalFemale [integer/character] Identifier 'female' externalSex. externalMale [integer/character] Identifier 'male' externalSex. externalSexSex [character] Column identifier column containing sex information externalSex. externalSexID [character] Column identifier column containing ID information externalSex. verbose [logical] TRUE, progress info printed standard . label_fail [logical] Set TRUE, add fail IDs text labels scatter plot. highlight_samples [character vector] Vector sample IIDs highlight plot (p_sexcheck); highlight_samples IIDs present IIDs name.fam file. highlight_type [character]  Type sample highlight, labeling IID (\"text\"/\"label\") /highlighting data points different \"color\" /\"shape\". \"text\" \"label\" use ggrepel minimal overlap text labels (\"text) label boxes (\"label\").  one \"text\" \"label\" can specified. Text/Label size can specified highlight_text_size, highlight color highlight_color, highlight shape highlight_shape. highlight_text_size [integer] Text/Label size samples specified highlighted (highlight_samples) \"text\" \"label\" (highlight_type). highlight_color [character] Color samples specified highlighted (highlight_samples) \"color\" (highlight_type). highlight_shape [integer] Shape samples specified highlighted (highlight_samples) \"shape\" (highlight_type). Possible shapes encoding can found : https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#sec:shape-spec highlight_legend [logical] separate legend highlighted samples provided; relevant highlight_type == \"color\" highlight_type == \"shape\". legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. title_size [integer] Size plot title. path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. showPlinkOutput [logical] TRUE, plink log error messages printed standard . interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_sexcheck) via ggplot2::ggsave(p=p_sexcheck, other_arguments) pdf(outfile) print(p_sexcheck) dev.().","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_sex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate results from PLINK sex check. — evaluate_check_sex","text":"named list ) fail_sex: dataframe FID, IID, PEDSEX, SNPSEX Sex (externalSex provided) individuals failing sex check; ii) mixup: dataframe FID, IID, PEDSEX, SNPSEX Sex (externalSex provided) individuals whose PEDSEX != Sex Sex == SNPSEX; iii) p_sexcheck, ggplot2-object 'containing' scatter plot X-chromosomal heterozygosity (SNPSEX) individuals split (PEDSEX), can shown print(p_sexcheck) iv) plot_data, data.frame data visualised p_sexcheck (iii).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_sex.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Evaluate results from PLINK sex check. — evaluate_check_sex","text":"run_check_sex evaluate_check_sex can simply invoked check_sex. details output data.frame fail_sex, check original description PLINK output format page: https://www.cog-genomics.org/plink/1.9/formats#sexcheck.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/evaluate_check_sex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluate results from PLINK sex check. — evaluate_check_sex","text":"","code":"qcdir <- system.file(\"extdata\", package=\"plinkQC\") name <- \"data\" path2plink <- '/path/to/plink' if (FALSE) { # \\dontrun{ fail_sex <- evaluate_check_sex(qcdir=qcdir, name=name, interactive=FALSE, verbose=FALSE, path2plink=path2plink)  # highlight samples highlight_samples <- read.table(system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\")) fail_sex <- evaluate_check_sex(qcdir=qcdir, name=name, interactive=FALSE, verbose=FALSE, path2plink=path2plink, highlight_samples = highlight_samples[,2], highlight_type = c(\"label\", \"color\"), highlight_color = \"darkgreen\") } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/overviewPerIndividualQC.html","id":null,"dir":"Reference","previous_headings":"","what":"Overview of per sample QC — overviewPerIndividualQC","title":"Overview of per sample QC — overviewPerIndividualQC","text":"overviewPerIndividualQC depicts results perIndividualQC intersection plots (via upset) returns dataframes indicating QC checks individuals failed passed.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/overviewPerIndividualQC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Overview of per sample QC — overviewPerIndividualQC","text":"","code":"overviewPerIndividualQC(results_perIndividualQC, interactive = FALSE)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/overviewPerIndividualQC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Overview of per sample QC — overviewPerIndividualQC","text":"results_perIndividualQC [list] Output perIndividualQC .e. named [list] ) sample_missingness containing [vector] sample IIDs failing selected missingness threshold imissTh, ii) highIBD containing [vector] sample IIDs failing selected relatedness threshold highIBDTh, iii) outlying_heterozygosity containing [vector] sample IIDs failing selected heterozygosity threshold hetTh, iv) mismatched_sex containing [vector] sample IIDs failing sexcheck based SNPSEX selected femaleTh/maleTh, v) ancestry containing vector sample IIDs failing ancestry check based selected europeanTh vi) p_sampleQC, ggplot2-object 'containing' sub-paneled plot QC-plots check_sex, check_het_and_miss, check_relatedness check_ancestry. interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_overview) via ggplot2::ggsave(p=p_overview, other_arguments) pdf(outfile) print(p_overview) dev.().","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/overviewPerIndividualQC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Overview of per sample QC — overviewPerIndividualQC","text":"Named [list] ) nr_fail_samples: total number samples [integer] failing perIndividualQC, ii) fail_QC containing [data.frame] samples failed QC steps (excluding ancestry) IID, FID, QC steps applied perIndividualQC (max=4), entries=0 passing QC entries=1 failing particular QC iii) fail_QC_and_ancestry containing [data.frame] samples failed ancestry QC checks IID, FID, QC_fail Ancestry_fail, entries=0 passing entries=1 failing check, iii) p_overview, ggplot2-object 'containing' sub-paneled plot QC-plots.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/overviewPerIndividualQC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Overview of per sample QC — overviewPerIndividualQC","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") qcdir <- tempdir() name <- \"data\" if (FALSE) { # \\dontrun{ fail_individuals <- perIndividualQC(qcdir=qcdir, indir=indir, name=name, refSamplesFile=paste(qcdir, \"/HapMap_ID2Pop.txt\",sep=\"\"), refColorsFile=paste(qcdir, \"/HapMap_PopColors.txt\", sep=\"\"), prefixMergedDataset=\"data.HapMapIII\", interactive=FALSE, verbose=FALSE, do.run_check_het_and_miss=FALSE, do.run_check_relatedness=FALSE, do.run_check_sex=FALSE, do.run_check_ancestry=FALSE)  overview <- overviewPerIndividualQC(fail_individuals) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/overviewPerMarkerQC.html","id":null,"dir":"Reference","previous_headings":"","what":"Overview of per marker QC — overviewPerMarkerQC","title":"Overview of per marker QC — overviewPerMarkerQC","text":"overviewPerMarkerQC depicts results perMarkerQC intersection plot (via upset) returns dataframe indicating QC checks failed passed.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/overviewPerMarkerQC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Overview of per marker QC — overviewPerMarkerQC","text":"","code":"overviewPerMarkerQC(results_perMarkerQC, interactive = FALSE)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/overviewPerMarkerQC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Overview of per marker QC — overviewPerMarkerQC","text":"results_perMarkerQC [list] Output perIndividualQC .e. named [list] ) fail_list, named [list] 1. SNP_missingness, containing SNP IDs failing missingness threshold lmissTh, 2. hwe, containing SNP IDs failing HWE exact test threshold hweTh 3. maf, containing SNPs failing MAF threshold mafTh/MAC threshold macTh ii) p_markerQC, ggplot2-object 'containing' sub-paneled plot QC-plots check_snp_missingness, check_hwe check_maf interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_overview) via ggplot2::ggsave(p=p_overview, other_arguments) pdf(outfile) print(p_overview) dev.().","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/overviewPerMarkerQC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Overview of per marker QC — overviewPerMarkerQC","text":"Named [list] ) nr_fail_markers: total number markers [integer] failing perMarkerQC, ii) fail_QC containing [data.frame] markers failed QC steps: marker rsIDs rows, columns QC steps applied perMarkerQC (max=3), entries=0 passing QC entries=1 failing particular QC.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/overviewPerMarkerQC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Overview of per marker QC — overviewPerMarkerQC","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") qcdir <- tempdir() name <- \"data\" path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. # All quality control checks if (FALSE) { # \\dontrun{ fail_markers <- perMarkerQC(qcdir=qcdir, indir=indir, name=name, interactive=FALSE, verbose=TRUE, path2plink=path2plink) overview <- overviewPerMarkerQC(fail_markers) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/perIndividualQC.html","id":null,"dir":"Reference","previous_headings":"","what":"Quality control for all individuals in plink-dataset — perIndividualQC","title":"Quality control for all individuals in plink-dataset — perIndividualQC","text":"perIndividualQC checks samples plink dataset total missingness heterozygosity rates, concordance assigned sex SNP sex, relatedness study individuals genetic ancestry.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/perIndividualQC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quality control for all individuals in plink-dataset — perIndividualQC","text":"","code":"perIndividualQC(   indir,   name,   qcdir = indir,   dont.check_sex = FALSE,   do.run_check_sex = TRUE,   do.evaluate_check_sex = TRUE,   maleTh = 0.8,   femaleTh = 0.2,   externalSex = NULL,   externalMale = \"M\",   externalSexSex = \"Sex\",   externalSexID = \"IID\",   externalFemale = \"F\",   fixMixup = FALSE,   dont.check_het_and_miss = FALSE,   do.run_check_het_and_miss = TRUE,   do.evaluate_check_het_and_miss = TRUE,   imissTh = 0.03,   hetTh = 3,   dont.check_relatedness = FALSE,   do.run_check_relatedness = TRUE,   do.evaluate_check_relatedness = TRUE,   highIBDTh = 0.1875,   mafThRelatedness = 0.1,   filter_high_ldregion = TRUE,   high_ldregion_file = NULL,   genomebuild = \"hg19\",   dont.check_ancestry = FALSE,   do.run_check_ancestry = TRUE,   do.evaluate_check_ancestry = TRUE,   prefixMergedDataset,   europeanTh = 1.5,   defaultRefSamples = c(\"HapMap\", \"1000Genomes\"),   refSamples = NULL,   refColors = NULL,   refSamplesFile = NULL,   refColorsFile = NULL,   refSamplesIID = \"IID\",   refSamplesPop = \"Pop\",   refColorsColor = \"Color\",   refColorsPop = \"Pop\",   studyColor = \"#2c7bb6\",   label_fail = TRUE,   highlight_samples = NULL,   highlight_type = c(\"text\", \"label\", \"color\", \"shape\"),   highlight_text_size = 3,   highlight_color = \"#c51b8a\",   highlight_shape = 17,   highlight_legend = FALSE,   interactive = FALSE,   verbose = TRUE,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   subplot_label_size = 9,   title_size = 9,   path2plink = NULL,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/perIndividualQC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quality control for all individuals in plink-dataset — perIndividualQC","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam. qcdir [character] /path//directory results saved. Per default, qcdir=indir. .evaluate_[analysis] set TRUE .run_[analysis] FALSE, perIndividualQC expects analysis-specific plink output files qcdir .e. .check_sex expects name.sexcheck, .evaluate_check_het_and_miss expects name.het name.imiss, .evaluate_check_relatedness expects name.genome name.imiss .evaluate_check_ancestry expects prefixMergeData.eigenvec. files present perIndividualQC fail missing file error. Setting .run_[analysis] TRUE execute checks create required files. User needs writing permission qcdir. dont.check_sex [logical] TRUE, sex check conducted; short .run_check_sex=FALSE .evaluate_check_sex=FALSE. Takes precedence .run_check_sex .evaluate_check_sex. .run_check_sex [logical] TRUE, run run_check_sex .evaluate_check_sex [logical] TRUE, run evaluate_check_sex maleTh [double] Threshold X-chromosomal heterozygosity rate males. femaleTh [double] Threshold X-chromosomal heterozygosity rate females. externalSex [data.frame, optional] Dataframe sample IDs [externalSexID] sex [externalSexSex] double check external PEDSEX data (often processed different centers) match. externalMale [integer/character] Identifier 'male' externalSex. externalSexSex [character] Column identifier column containing sex information externalSex. externalSexID [character] Column identifier column containing ID information externalSex. externalFemale [integer/character] Identifier 'female' externalSex. fixMixup [logical] PEDSEX individuals mismatch PEDSEX Sex Sex==SNPSEX automatically corrected: directly change name.bim/.bed/.fam files! dont.check_het_and_miss [logical] TRUE, heterozygosity missingness check conducted; short .run_check_heterozygosity=FALSE, .run_check_missingness=FALSE .evaluate_check_het_and_miss=FALSE. Takes precedence .run_check_heterozygosity, .run_check_missingness .evaluate_check_het_and_miss. .run_check_het_and_miss [logical] TRUE, run run_check_heterozygosity run_check_missingness .evaluate_check_het_and_miss [logical] TRUE, run evaluate_check_het_and_miss. imissTh [double] Threshold acceptable missing genotype rate individual; proportion (0,1) hetTh [double] Threshold acceptable deviation mean heterozygosity per individual. Expressed multiples standard deviation heterozygosity (het), .e. individuals outside mean(het) +/- hetTh*sd(het) returned failing heterozygosity check; larger 0. dont.check_relatedness [logical] TRUE, relatedness check conducted; short .run_check_relatedness=FALSE .evaluate_check_relatedness=FALSE. Takes precedence .run_check_relatedness .evaluate_check_relatedness. .run_check_relatedness [logical] TRUE, run run_check_relatedness. .evaluate_check_relatedness [logical] TRUE, run evaluate_check_relatedness. highIBDTh [double] Threshold acceptable proportion IBD pair individuals. mafThRelatedness [double] Threshold minor allele frequency filter selecting variants IBD estimation. filter_high_ldregion [logical] high LD regions filtered IBD estimation; carried per default high LD regions hg19 provided default via genomebuild. alternative genome builds provided non-human data, high LD regions files can provided via high_ldregion_file. high_ldregion_file [character] Path file high LD regions used filtering IBD estimation filter_high_ldregion == TRUE, otherwise ignored; human genome data, high LD region files provided can simply chosen via genomebuild. Files space-delimited, column names following columns: chromosome, region-start, region-end, region number. Chromosomes specified without 'chr' prefix. instance: 1 48000000 52000000 1 2 86000000 100500000 2 genomebuild [character] Name genome build PLINK file annotations, ie mappings name.bim file. used remove high-LD regions based coordinates respective build. Options hg18, hg19 hg38. See @details. dont.check_ancestry [logical] TRUE, ancestry check conducted; short .run_check_ancestry=FALSE .evaluate_check_ancestry=FALSE. Takes precedence .run_check_ancestry .evaluate_check_ancestry. .run_check_ancestry [logical] TRUE, run run_check_ancestry. .evaluate_check_ancestry [logical] TRUE, run evaluate_check_ancestry. prefixMergedDataset [character] Prefix merged dataset (study reference samples) used plink –pca, resulting prefixMergedDataset.eigenvec. europeanTh [double] Scaling factor radius drawn around center European reference samples, study samples inside radius considered European descent samples outside radius non-European descent. radius computed maximum Euclidean distance European reference samples centre European reference samples. defaultRefSamples [character] Option use pre-downloaded individual population identifiers either 1000Genomes HapMap project. refSamples refSamplesFile provided, HapMap identifiers (1000Genomes specified) used default function fail reference samples prefixMergedDataset match reference samples. refColors refColorsFile provided, also sets default colors reference populations. refSamples [data.frame] Dataframe sample identifiers [refSamplesIID] corresponding IIDs prefixMergedDataset.eigenvec population identifier [refSamplesPop] corresponding population IDs [refColorsPop] refColorsfile/refColors. Either refSamples refSamplesFile specified. refColors [data.frame, optional] Dataframe population IDs column [refColorsPop] corresponding colour-code PCA plot column [refColorsColor]. provided .null(refColorsFile) default colors used. refSamplesFile [character] /path//File//reference samples. Needs columns sample identifiers [refSamplesIID] corresponding IIDs prefixMergedDataset.eigenvec population identifier [refSamplesPop] corresponding population IDs [refColorsPop] refColorsfile/refColors. refColorsFile [character, optional] /path//File//Population/Colors containing population IDs column [refColorsPop] corresponding colour-code PCA plot column [refColorsColor].provided .null(refColors) default colors used. refSamplesIID [character] Column name reference sample IDs refSamples/refSamplesFile. refSamplesPop [character] Column name reference sample population IDs refSamples/refSamplesFile. refColorsColor [character] Column name population colors refColors/refColorsFile refColorsPop [character] Column name reference sample population IDs refColors/refColorsFile. studyColor [character] Colour used study population. label_fail [logical] Set TRUE, add fail IDs text labels scatter plot. highlight_samples [character vector] Vector sample IIDs highlight plot (p_sexcheck); highlight_samples IIDs present IIDs name.fam file. highlight_type [character]  Type sample highlight, labeling IID (\"text\"/\"label\") /highlighting data points different \"color\" /\"shape\". \"text\" \"label\" use ggrepel minimal overlap text labels (\"text) label boxes (\"label\").  one \"text\" \"label\" can specified. Text/Label size can specified highlight_text_size, highlight color highlight_color, highlight shape highlight_shape. highlight_text_size [integer] Text/Label size samples specified highlighted (highlight_samples) \"text\" \"label\" (highlight_type). highlight_color [character] Color samples specified highlighted (highlight_samples) \"color\" (highlight_type). highlight_shape [integer] Shape samples specified highlighted (highlight_samples) \"shape\" (highlight_type). Possible shapes encoding can found : https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#sec:shape-spec highlight_legend [logical] separate legend highlighted samples provided; relevant highlight_type == \"color\" highlight_type == \"shape\". interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_sampleQC) via ggplot2::ggsave(p=p_sampleQC, other_arguments) pdf(outfile) print(p_sampleQC) dev.(). TRUE, ) depicts X-chromosomal heterozygosity (SNPSEX) samples split PEDSEX (.evaluate_check_sex TRUE), ii) creates scatter plot samples' missingness rates x-axis heterozygosity rates y-axis (.evaluate_check_het_and_miss TRUE), iii) depicts pair-wise IBD-estimates histogram (.evaluate_check_relatedness TRUE) iv) creates scatter plot PC1 versus PC2 color-coded samples reference populations study population (.check_ancestry set TRUE). verbose [logical] TRUE, progress info printed standard . keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. subplot_label_size [integer] Size subplot labeling. title_size [integer] Size plot title. path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/perIndividualQC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quality control for all individuals in plink-dataset — perIndividualQC","text":"Named [list] ) fail_list, named [list] 1. sample_missingness containing [vector] sample IIDs failing missingness threshold imissTh, 2. highIBD containing [vector] sample IIDs failing relatedness threshold highIBDTh, 3. outlying_heterozygosity containing [vector] sample IIDs failing heterozygosity threshold hetTh, 4. mismatched_sex containing [vector] sample IIDs failing sexcheck based SNPSEX femaleTh/maleTh 5. ancestry containing vector sample IIDs failing ancestry check based europeanTh ii) p_sampleQC, ggplot2-object 'containing' sub-paneled plot QC-plots check_sex, check_het_and_miss, check_relatedness check_ancestry, can shown print(p_sampleQC). List entries contain NULL specific check chosen.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/perIndividualQC.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quality control for all individuals in plink-dataset — perIndividualQC","text":"perIndividualQC wraps around individual QC functions check_sex, check_het_and_miss, check_relatedness check_ancestry. details parameters outputs, check function documentations. detailed output fail IIDs (instead simple IID lists), run function individually.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/perIndividualQC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quality control for all individuals in plink-dataset — perIndividualQC","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") qcdir <- tempdir() name <- \"data\" # All quality control checks if (FALSE) { # \\dontrun{ # whole dataset fail_individuals <- perIndividualQC(indir=indir, qcdir=qcdir, name=name, refSamplesFile=paste(qcdir, \"/HapMap_ID2Pop.txt\",sep=\"\"), refColorsFile=paste(qcdir, \"/HapMap_PopColors.txt\", sep=\"\"), prefixMergedDataset=\"data.HapMapIII\", interactive=FALSE, verbose=FALSE, do.run_check_het_and_miss=FALSE, do.run_check_relatedness=FALSE, do.run_check_sex=FALSE, do.run_check_ancestry=FALSE)  # Only check sex and missingness/heterozygosity fail_sex_het_miss <- perIndividualQC(indir=indir, qcdir=qcdir, name=name, dont.check_ancestry=TRUE, dont.check_relatedness=TRUE, interactive=FALSE, verbose=FALSE)  # subset of dataset with sample highlighting highlight_samples <- read.table(system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\")) remove_individuals_file <- system.file(\"extdata\", \"remove_individuals\", package=\"plinkQC\") individual_qc <- perIndividualQC(indir=indir, qcdir=qcdir, name=name, refSamplesFile=paste(qcdir, \"/HapMap_ID2Pop.txt\",sep=\"\"), refColorsFile=paste(qcdir, \"/HapMap_PopColors.txt\", sep=\"\"), prefixMergedDataset=\"data.HapMapIII\", interactive=FALSE, verbose=FALSE, do.run_check_ancestry=FALSE, do.evaluate_check_ancestry=TRUE, path2plink=path2plink, remove_individuals=remove_individuals_file, highlight_samples=highlight_samples[,2], highlight_type = c(\"text\", \"color\"), highlight_color=\"goldenrod\") } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/perMarkerQC.html","id":null,"dir":"Reference","previous_headings":"","what":"Quality control for all markers in plink-dataset — perMarkerQC","title":"Quality control for all markers in plink-dataset — perMarkerQC","text":"perMarkerQC checks markers plink dataset missingness rates across samples, deviation Hardy-Weinberg-Equilibrium (HWE) minor allele frequencies (MAF). Per default, assumes IDs individuals failed perIndividualQC written qcdir/name.fail.IDs removes individuals computing missingness rates, HWE p-values MAF. qcdir/name.fail.IDs file exist, message written stdout analyses continue samples name.fam/name.bed/name.bim dataset. Depicts ) SNP missingness rates (stratified minor allele frequency) histograms, ii) p-values HWE exact test (stratified low p-values) histograms iii) minor allele frequency distribution histogram.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/perMarkerQC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quality control for all markers in plink-dataset — perMarkerQC","text":"","code":"perMarkerQC(   indir,   qcdir = indir,   name,   do.check_snp_missingness = TRUE,   lmissTh = 0.01,   do.check_hwe = TRUE,   hweTh = 1e-05,   do.check_maf = TRUE,   macTh = 20,   mafTh = NULL,   interactive = FALSE,   verbose = TRUE,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   legend_text_size = 5,   legend_title_size = 7,   axis_text_size = 5,   axis_title_size = 7,   title_size = 9,   subplot_label_size = 9,   path2plink = NULL,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/perMarkerQC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quality control for all markers in plink-dataset — perMarkerQC","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. qcdir [character] /path//directory results written . perIndividualQC conducted, directory qcdir specified perIndividualQC, .e. contains name.fail.IDs IIDs individuals failed QC. User needs writing permission qcdir. Per default, qcdir=indir. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam. .check_snp_missingness [logical] TRUE, run check_snp_missingness. lmissTh [double] Threshold acceptable variant missing rate across samples. .check_hwe [logical] TRUE, run check_hwe. hweTh [double] Significance threshold deviation HWE. .check_maf [logical] TRUE, run check_maf. macTh [double] Threshold minor allele cut cut-, mafTh macTh specified, macTh used (macTh = mafTh\\*2\\*NrSamples). mafTh [double] Threshold minor allele frequency cut-. interactive [logical] plots shown interactively? choosing option, make sure X-forwarding/graphical interface available interactive plotting. Alternatively, set interactive=FALSE save returned plot object (p_marker) via ggplot2::ggsave(p=p_marker, other_arguments) pdf(outfile) print(p_marker) dev.(). verbose [logical] TRUE, progress info printed standard . keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. legend_text_size [integer] Size legend text. legend_title_size [integer] Size legend title. axis_text_size [integer] Size axis text. axis_title_size [integer] Size axis title. title_size [integer] Size plot title. subplot_label_size [integer] Size subplot labeling. path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/perMarkerQC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quality control for all markers in plink-dataset — perMarkerQC","text":"Named [list] ) fail_list, named [list] 1. SNP_missingness, containing SNP IDs [vector] failing missingness threshold lmissTh, 2. hwe, containing SNP IDs [vector] failing HWE exact test threshold hweTh 3. maf, containing SNPs Ids [vector] failing MAF threshold mafTh/MAC threshold macTh ii) p_markerQC, ggplot2-object 'containing' sub-paneled plot QC-plots check_snp_missingness, check_hwe check_maf, can shown print(p_markerQC). List entries contain NULL specific check chosen.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/perMarkerQC.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quality control for all markers in plink-dataset — perMarkerQC","text":"perMarkerQC wraps around marker QC functions check_snp_missingness, check_hwe check_maf. details parameters outputs, check function documentations.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/perMarkerQC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quality control for all markers in plink-dataset — perMarkerQC","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") qcdir <- tempdir() name <- \"data\" path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. # All quality control checks if (FALSE) { # \\dontrun{ # run on all markers and individuals fail_markers <- perMarkerQC(indir=indir, qcdir=qcdir, name=name, interactive=FALSE, verbose=TRUE, path2plink=path2plink)  # run on subset of individuals and markers keep_individuals_file <- system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\") extract_markers_file <- system.file(\"extdata\", \"extract_markers\", package=\"plinkQC\") fail_markers <- perMarkerQC(qcdir=qcdir, indir=indir, name=name, interactive=FALSE, verbose=TRUE, path2plink=path2plink, keep_individuals=keep_individuals_file, extract_markers=extract_markers_file) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/plinkQC-package.html","id":null,"dir":"Reference","previous_headings":"","what":"plinkQC: Genotype Quality Control with 'PLINK' — plinkQC-package","title":"plinkQC: Genotype Quality Control with 'PLINK' — plinkQC-package","text":"Genotyping arrays enable direct measurement individuals genotype thousands markers. 'plinkQC' facilitates genotype quality control genetic association studies described Anderson colleagues (2010) doi:10.1038/nprot.2010.116 . makes 'PLINK' basic statistics (e.g. missing genotyping rates per individual, allele frequencies per genetic marker) relationship functions accessible 'R' generates per-individual per-marker quality control report. Individuals markers fail quality control can subsequently removed generate new, clean dataset. Removal individuals based relationship status optimised retain many individuals possible study.","code":""},{"path":[]},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/plinkQC-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"plinkQC: Genotype Quality Control with 'PLINK' — plinkQC-package","text":"Maintainer: Hannah Meyer hannah.v.meyer@gmail.com (ORCID) contributors: Caroline Walter carowalter26@hotmail.com [contributor] Maha Syed maha.s.syed@gmail.com [contributor]","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/relatednessFilter.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove related individuals while keeping maximum number of individuals — relatednessFilter","title":"Remove related individuals while keeping maximum number of individuals — relatednessFilter","text":"relatednessFilter takes data.frame pair-wise relatedness measures samples returns pairs individual IDs related well list suggested individual IDs remove. relatednessFilter finds pairs samples whose relatedness estimate larger specified relatednessTh. Subsequently, pairs individual additional relatives dataset, individual worse otherCriterionMeasure (provided) arbitrarily individual 1 pair selected returned individual failing relatedness check. complex family structures, unrelated individuals per family selected (e.g. simple case parents-offspring trio, offspring marked fail, parents kept analysis). Selection achieved constructing subgraphs clusters individuals related. relatednessFilter finds maximum independent set vertices subgraphs related individuals. individuals related (.e. maximum independent sets 0), one individual cluster kept others listed failIDs.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/relatednessFilter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove related individuals while keeping maximum number of individuals — relatednessFilter","text":"","code":"relatednessFilter(   relatedness,   otherCriterion = NULL,   relatednessTh,   otherCriterionTh = NULL,   otherCriterionThDirection = c(\"gt\", \"ge\", \"lt\", \"le\", \"eq\"),   relatednessIID1 = \"IID1\",   relatednessIID2 = \"IID2\",   relatednessFID1 = NULL,   relatednessFID2 = NULL,   relatednessRelatedness = \"PI_HAT\",   otherCriterionIID = \"IID\",   otherCriterionMeasure = NULL,   verbose = FALSE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/relatednessFilter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove related individuals while keeping maximum number of individuals — relatednessFilter","text":"relatedness [data.frame] containing pair-wise relatedness estimates (column [relatednessRelatedness]) individual 1 (column [relatednessIID1] individual 2 (column [relatednessIID1]). Columns relatednessIID1, relatednessIID2 relatednessRelatedness present, additional columns family IDs can present. Default column names correspond column names output plink –genome (https://www.cog-genomics.org/plink/1.9/ibd). original columns pair-wise highIBDTh fails returned fail_IBD. otherCriterion [data.frame] containing QC measure (column [otherCriterionMeasure]) per individual (column [otherCriterionIID]). otherCriterionMeasure otherCriterionIID present, additional columns family IDs can present. IIDs relatednessIID1 present otherCriterionIID. relatednessTh [double] Threshold filtering related individuals. Individuals, whose pair-wise relatedness estimates greater threshold considered related. otherCriterionTh [double] Threshold filtering individuals based otherCriterionMeasure. related individuals fail threshold automatically excluded. otherCriterionThDirection [character] Used determine direction failing otherCriterionTh. 'gt', individuals whose otherCriterionMeasure > otherCriterionTh automatically excluded. pairs individuals related samples cohort: otherCriterionMeasure < otherCriterionTh, individual larger otherCriterionMeasure excluded. relatednessIID1 [character] Column name column containing IDs first individual. relatednessIID2 [character] Column name column containing IDs second individual. relatednessFID1 [character, optional] Column name column containing family IDs first individual; relatednessFID1 relatednessFID2 provided, none provided even though present relatedness, FIDs returned. relatednessFID2 [character, optional] Column name column containing family IDs second individual; relatednessFID2 relatednessFID1 provided, none provided even though present relatedness, FIDs returned. relatednessRelatedness [character] Column name column containing relatedness estimate. otherCriterionIID [character] Column name column containing individual IDs. otherCriterionMeasure [character] Column name column containing measure otherCriterion (instance SNP missingness rate). verbose [logical] TRUE, progress info printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/relatednessFilter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove related individuals while keeping maximum number of individuals — relatednessFilter","text":"named [list] ) relatednessFails, [data.frame] containing data.frame relatedness filtering pairs individuals relatednessIID1 relatednessIID2, fail relatedness QC; data.frame reordered fail individuals column 1 related individuals column 2 ii) failIDs, [data.frame] [IID]s ([FID]s provided) individuals fail relatednessTh.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/rename_variant_identifiers.html","id":null,"dir":"Reference","previous_headings":"","what":"Renaming variants — rename_variant_identifiers","title":"Renaming variants — rename_variant_identifiers","text":"Changes format variant identifier. default format chr1:12345[hg38].","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/rename_variant_identifiers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Renaming variants — rename_variant_identifiers","text":"","code":"rename_variant_identifiers(   indir,   name,   qcdir = indir,   verbose = FALSE,   path2plink2 = NULL,   format = \"@:#[hg38]\",   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/rename_variant_identifiers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Renaming variants — rename_variant_identifiers","text":"indir [character] /path//directory containing basic PLINK 2.0 data file name.pgen, name.pvar, name.psam name [character] Prefix PLINK 2.0 files, .e. name.pgen, name.pvar, name.psam qcdir [character] /path//directory name.sscore returned plink2 –score saved . User needs writing permission qcdir. Per default qcdir=indir. verbose [logical] TRUE, progress info printed standard . path2plink2 [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/2.0/) .e. plink 2 accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). format [character] gives template rewrite variant identifier. '@' represents chromosome code, '#' represents base-pair position. showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/rename_variant_identifiers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Renaming variants — rename_variant_identifiers","text":"Files .renamed renamed variants","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/rename_variant_identifiers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Renaming variants — rename_variant_identifiers","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") qcdir <- tempdir() name <- \"data.hg38\" path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. if (FALSE) { # \\dontrun{ rename_variant_identifiers(indir=indir, qcdir=qcdir, name=name, path2plink2 = path2plink2) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_ancestry.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PLINK principal component analysis — run_check_ancestry","title":"Run PLINK principal component analysis — run_check_ancestry","text":"Run plink –pca calculate principal components merged genotypes study reference dataset.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_ancestry.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PLINK principal component analysis — run_check_ancestry","text":"","code":"run_check_ancestry(   indir,   prefixMergedDataset,   qcdir = indir,   verbose = FALSE,   path2plink = NULL,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_ancestry.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PLINK principal component analysis — run_check_ancestry","text":"indir [character] /path//directory containing basic PLINK data files prefixMergedDataset.bim,prefixMergedDataset.fam prefixMergedDataset.bed. prefixMergedDataset [character] Prefix merged study reference data files, .e. prefixMergedDataset.bed, prefixMergedDataset.bim, prefixMergedDataset.fam. qcdir [character] /path//directory save prefixMergedDataset.eigenvec returned plink –pca. User needs writing permission qcdir. Per default qcdir=indir. verbose [logical] TRUE, progress info printed standard . path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_ancestry.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run PLINK principal component analysis — run_check_ancestry","text":", run_check_ancestry evaluation evaluate_check_ancestry can simply invoked check_ancestry.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_ancestry.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run PLINK principal component analysis — run_check_ancestry","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") qcdir <- tempdir() prefixMergedDataset <- 'data.HapMapIII' path2plink <- 'path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. if (FALSE) { # \\dontrun{ # ancestry check on all individuals in dataset run <- run_check_ancestry(indir=indir, qcdir=qcdir, prefixMergedDataset, path2plink=path2plink)  # ancestry check on subset of dataset remove_individuals_file <- system.file(\"extdata\", \"remove_individuals\", package=\"plinkQC\") run <- run_check_ancestry(indir=indir, qcdir=qcdir, name=name, remove_individuals=remove_individuals_file, path2plink=path2plink) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_heterozygosity.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PLINK heterozygosity rate calculation — run_check_heterozygosity","title":"Run PLINK heterozygosity rate calculation — run_check_heterozygosity","text":"Run plink –het calculate heterozygosity rates per individual.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_heterozygosity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PLINK heterozygosity rate calculation — run_check_heterozygosity","text":"","code":"run_check_heterozygosity(   indir,   name,   qcdir = indir,   verbose = FALSE,   path2plink = NULL,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_heterozygosity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PLINK heterozygosity rate calculation — run_check_heterozygosity","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam. qcdir [character] /path//directory save name.het returned plink –het. User needs writing permission qcdir. Per default qcdir=indir. verbose [logical] TRUE, progress info printed standard . path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_heterozygosity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run PLINK heterozygosity rate calculation — run_check_heterozygosity","text":", run_check_heterozygosity, run_check_missingness evaluation evaluate_check_het_and_miss can simply invoked check_het_and_miss.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_heterozygosity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run PLINK heterozygosity rate calculation — run_check_heterozygosity","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") name <- 'data' qcdir <- tempdir() path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. if (FALSE) { # \\dontrun{ # heterozygosity check on all individuals in dataset run <- run_check_heterozygosity(indir=indir, qcdir=qcdir, name=name, path2plink=path2plink)  #' # heterozygosity on subset of dataset remove_individuals_file <- system.file(\"extdata\", \"remove_individuals\", package=\"plinkQC\") run <- run_check_heterozygosity(indir=indir, qcdir=qcdir, name=name, remove_individuals=remove_individuals_file,path2plink=path2plink) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_missingness.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PLINK missingness rate calculation — run_check_missingness","title":"Run PLINK missingness rate calculation — run_check_missingness","text":"Run  plink –missing calculate missing genotype rates per individual.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_missingness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PLINK missingness rate calculation — run_check_missingness","text":"","code":"run_check_missingness(   indir,   name,   qcdir = indir,   verbose = FALSE,   path2plink = NULL,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_missingness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PLINK missingness rate calculation — run_check_missingness","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam. qcdir [character] /path//directory save name.imiss returned plink –missing. User needs writing permission qcdir. Per default qcdir=indir. verbose [logical] TRUE, progress info printed standard . path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_missingness.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run PLINK missingness rate calculation — run_check_missingness","text":", run_check_heterozygosity, run_check_missingness evaluation evaluate_check_het_and_miss can simply invoked check_het_and_miss.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_missingness.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run PLINK missingness rate calculation — run_check_missingness","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") name <- 'data' qcdir <- tempdir() path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. if (FALSE) { # \\dontrun{ # missingness check on all individuals in dataset run <- run_check_missingness(indir=indir, qcdir=qcdir, name=name, path2plink=path2plink)  # missingness on subset of dataset remove_individuals_file <- system.file(\"extdata\", \"remove_individuals\", package=\"plinkQC\") run <- run_check_missingness(indir=indir, qcdir=qcdir, name=name, remove_individuals=remove_individuals_file, path2plink=path2plink) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_relatedness.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PLINK IBD estimation — run_check_relatedness","title":"Run PLINK IBD estimation — run_check_relatedness","text":"Run LD pruning dataset plink –exclude range highldfile –indep-pairwise 50 5 0.2, highldfile contains regions high LD provided Anderson et (2010) Nature Protocols. Subsequently, plink –genome run LD pruned, maf-filtered data. plink –genome calculates identity state (IBS) pair individuals based average proportion alleles shared genotyped SNPs. degree recent shared ancestry,.e. identity descent (IBD) can estimated genome-wide IBS. proportion IBD two individuals returned –genome PI_HAT.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_relatedness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PLINK IBD estimation — run_check_relatedness","text":"","code":"run_check_relatedness(   indir,   name,   qcdir = indir,   highIBDTh = 0.185,   mafThRelatedness = 0.1,   path2plink = NULL,   filter_high_ldregion = TRUE,   high_ldregion_file = NULL,   genomebuild = \"hg19\",   showPlinkOutput = TRUE,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   verbose = FALSE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_relatedness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PLINK IBD estimation — run_check_relatedness","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam. qcdir [character] /path//directory save name.genome returned plink –genome. User needs writing permission qcdir. Per default qcdir=indir. highIBDTh [double] Threshold acceptable proportion IBD pair individuals; pairwise relationship estimates larger threshold recorded. mafThRelatedness [double] Threshold minor allele frequency filter selecting variants IBD estimation. path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). filter_high_ldregion [logical] high LD regions filtered IBD estimation; carried per default high LD regions hg19 provided default via genomebuild. alternative genome builds provided non-human data, high LD regions files can provided via high_ldregion_file. high_ldregion_file [character] Path file high LD regions used filtering IBD estimation filter_high_ldregion == TRUE, otherwise ignored; human genome data, high LD region files provided can simply chosen via genomebuild. Files space-delimited, column names following columns: chromosome, region-start, region-end, region number. Chromosomes specified without 'chr' prefix. instance: 1 48000000 52000000 1 2 86000000 100500000 2 genomebuild [character] Name genome build PLINK file annotations, ie mappings name.bim file. used remove high-LD regions based coordinates respective build. Options hg18, hg19 hg38. See @details. showPlinkOutput [logical] TRUE, plink log error messages printed standard . keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. verbose [logical] TRUE, progress info printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_relatedness.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run PLINK IBD estimation — run_check_relatedness","text":"run_check_relatedness evaluation via evaluate_check_relatedness can simply invoked check_relatedness. IBD estimation conducted LD pruned data first step, high LD regions excluded. regions derived high-LD-regions file provided Anderson et (2010) Nature Protocols. regions NCBI36 (hg18) coordinates lifted GRCh37 (hg19) GRC38 (hg38) coordinates using liftOver tool available : https://genome.ucsc.edu/cgi-bin/hgLiftOver. 'Minimum ratio bases must remap' set 0.5 'Allow multiple output regions' box ticked; parameters, default options selected. LiftOver files generated July 9,2019. commands formatting files provided system.file(\"extdata\", 'liftOver.cmd', package=\"plinkQC\").","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_relatedness.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run PLINK IBD estimation — run_check_relatedness","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") name <- 'data' qcdir <- tempdir() path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. if (FALSE) { # \\dontrun{ # Relatedness estimation based in all markers in dataset run <- run_check_relatedness(indir=indir, qcdir=qcdir, name=name, path2plink=path2plink)  # relatedness estimation on subset of dataset keep_individuals_file <- system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\") run <- run_check_relatedness(indir=indir, qcdir=qcdir, name=name, keep_individuals=keep_individuals_file, path2plink=path2plink) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_sex.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PLINK sexcheck — run_check_sex","title":"Run PLINK sexcheck — run_check_sex","text":"Run  plink –sexcheck calculate heterozygosity rate across X-chromosomal variants.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_sex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PLINK sexcheck — run_check_sex","text":"","code":"run_check_sex(   indir,   name,   qcdir = indir,   verbose = FALSE,   path2plink = NULL,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_sex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PLINK sexcheck — run_check_sex","text":"indir [character] /path//directory containing basic PLINK data files name.bim, name.bed, name.fam files. name [character] Prefix PLINK files, .e. name.bed, name.bim, name.fam. qcdir [character] /path//directory save name.sexcheck returned plink –check-sex. User needs writing permission qcdir. Per default qcdir=indir. verbose [logical] TRUE, progress info printed standard . path2plink [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/1.9/) .e. plink accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_sex.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run PLINK sexcheck — run_check_sex","text":"run_check_sex evaluation evaluate_check_sex can simply invoked check_sex.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/run_check_sex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run PLINK sexcheck — run_check_sex","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") name <- 'data' qcdir <- tempdir() path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. if (FALSE) { # \\dontrun{ # simple sexcheck on all individuals in dataset run <- run_check_sex(indir=indir, qcdir=qcdir, name=name)  # sexcheck on subset of dataset keep_individuals_file <- system.file(\"extdata\", \"keep_individuals\", package=\"plinkQC\") run <- run_check_sex(indir=indir, qcdir=qcdir, name=name, keep_individuals=keep_individuals_file, path2plink=path2plink) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/superpop_classification.html","id":null,"dir":"Reference","previous_headings":"","what":"Predicting sample superpopualation ancestry — superpop_classification","title":"Predicting sample superpopualation ancestry — superpop_classification","text":"Predicts ancestry inputted samples using plink2. program utilizes random forest algorithm trained 1000 genomes dataset predict ancestry samples. five possible ancestral superpopulation categories: AFR, AMR, EAS, EUR, SAS. Genomic data version hg38 variant identifiers format 1:12345[hg38] needed function work","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/superpop_classification.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predicting sample superpopualation ancestry — superpop_classification","text":"","code":"superpop_classification(   indir,   name,   qcdir = indir,   verbose = FALSE,   path2plink2 = NULL,   path2load_mat = NULL,   keep_individuals = NULL,   remove_individuals = NULL,   exclude_markers = NULL,   extract_markers = NULL,   showPlinkOutput = TRUE )"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/superpop_classification.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predicting sample superpopualation ancestry — superpop_classification","text":"indir [character] /path//directory containing basic PLINK 2.0 data file name.pgen, name.pvar, name.psam name [character] Prefix PLINK 2.0 files, .e. name.pgen, name.pvar, name.psam qcdir [character] /path//directory name.sscore returned plink2 –score saved . User needs writing permission qcdir. Per default qcdir=indir. verbose [logical] TRUE, progress info printed standard . path2plink2 [character] Absolute path PLINK executable (https://www.cog-genomics.org/plink/2.0/) .e. plink 2 accessible path2plink -h. full name executable specified: windows OS, means path/plink.exe, unix platforms path/plink. provided, assumed PATH set-works PLINK found exec('plink'). path2load_mat [character] /path//directory loading matrices kept. can downloaded : https://github.com/meyer-lab-cshl/plinkQCAncestryData keep_individuals [character] Path file individuals retained analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. remove_individuals [character] Path file individuals removed analysis. file space/tab-delimited text file family IDs first column within-family IDs second column. samples listed file removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#indiv. Default: NULL, .e. filtering individuals. exclude_markers [character] Path file makers removed analysis. file text file list variant IDs (usually one per line, okay just separated spaces). listed variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. extract_markers [character] Path file makers included analysis. file text file list variant IDs (usually one per line, okay just separated spaces). unlisted variants removed current analysis. See https://www.cog-genomics.org/plink/1.9/filter#snp. Default: NULL, .e. filtering markers. showPlinkOutput [logical] TRUE, plink log error messages printed standard .","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/superpop_classification.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predicting sample superpopualation ancestry — superpop_classification","text":"named [factor] five different levels AFR, AMR, EAS, EUR, SAS correspond ancestry sample comes names corresponds IDs.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/superpop_classification.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predicting sample superpopualation ancestry — superpop_classification","text":"","code":"indir <- system.file(\"extdata\", package=\"plinkQC\") qcdir <- tempdir() name <- \"data.hg38\" path2plink <- '/path/to/plink' # the following code is not run on package build, as the path2plink on the # user system is not known. if (FALSE) { # \\dontrun{ superpop_classification(indir=indir, qcdir=qcdir, name=name, path2plink2 = path2plink2) } # }"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/testNumerics.html","id":null,"dir":"Reference","previous_headings":"","what":"Test lists for different properties of numerics — testNumerics","title":"Test lists for different properties of numerics — testNumerics","text":"Test elements list numeric, positive numbers, integers proportions (range 0-1).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/testNumerics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test lists for different properties of numerics — testNumerics","text":"","code":"testNumerics(numbers, positives = NULL, integers = NULL, proportions = NULL)"},{"path":"https://meyer-lab-cshl.github.io/plinkQC/reference/testNumerics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test lists for different properties of numerics — testNumerics","text":"numbers [list] whose elements tested numeric. positives [list] whose elements tested positive numbers. integers [list] whose elements tested integers. proportions [list] whose elements tested proportions. 0 1.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"plinkqc-034","dir":"Changelog","previous_headings":"","what":"plinkQC 0.3.4","title":"plinkQC 0.3.4","text":"CRAN release: 2021-07-15","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"major-changes-0-3-4","dir":"Changelog","previous_headings":"","what":"major changes","title":"plinkQC 0.3.4","text":"Add flag removing high LD regions add option user provided file, allowing removal high LD regions non-human organisms; fix missing flag 19bc569 #42 Fixed failing data.no_failIDs.lmiss file check_snp_missingness function failIDs present 86adc39 #43","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"plinkqc-033","dir":"Changelog","previous_headings":"","what":"plinkQC 0.3.3","title":"plinkQC 0.3.3","text":"CRAN release: 2021-02-08","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"major-changes-0-3-3","dir":"Changelog","previous_headings":"","what":"major changes","title":"plinkQC 0.3.3","text":"Output IBD estimates run_check_relatedness just fail IBD estimates d009da90 Add midp modifier –hwe –hardy recommended plink hwe documentation discussed issue #27; 43230a6c Provide HapMap 1000Genomes individual population identifiers default ancestry check functions; include optional color mapping reference populations; raised #37, incorporated 65cfcba individual QC functions return data.frame FID, IID measure used filtering #5 incorporated 295505b allow user-supplied individual marker filtering perIndividualQC, perMarkerQC cleanData #33 individual highlighting perIndividualQC plots; several highlight modalities (text/label, shape, color) #38","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"minor-changes-0-3-3","dir":"Changelog","previous_headings":"","what":"minor changes","title":"plinkQC 0.3.3","text":"Add checks cleanData can distinguish miss-specified filters non-failing samples 7432b1ee; addresses issue #31 Add checks tests check_snp_missingness, check_maf check_hwe cases samples pass perIndividualQC. 31ed6f65; related issue #31 Add checks tests evaluate_check_sex evaluate_check_het_imiss passing samples accordingly, fail samples label plot. d071a43 Update dropbox links add note vignette 9bae988 additional plotting parameters evaluate_* functions, controlling text title sizes (b38a348, f25b8d0)","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"plinkqc-032","dir":"Changelog","previous_headings":"","what":"plinkQC 0.3.2","title":"plinkQC 0.3.2","text":"CRAN release: 2020-07-07","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"minor-changes-0-3-2","dir":"Changelog","previous_headings":"","what":"minor changes","title":"plinkQC 0.3.2","text":"Add checks tests evaluate_check_ancestry missing non-reference samples 5c03971 R internal file.copy instead systems cp command make run windows: 6c91ef3, fixes #26 Add additional filter ->T, C->G variants suggested #24; 11e0375 allow supplying names European reference population ae09e64 provide argument specify number populations per legend row c7fe85d Ensure correct ordering population colors reference population HapMap 86275b7","code":""},{"path":[]},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"minor-changes-0-3-1","dir":"Changelog","previous_headings":"","what":"minor changes","title":"plinkQC 0.3.1","text":"Fixed dead links vignettes (caused migration repository): da987d8 Added note chrY Hapmap data (vignette): e8afbb9 Added note recommended use plink1.9 (vs 2.0): b69d3d7","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"plinkqc-030","dir":"Changelog","previous_headings":"","what":"plinkQC 0.3.0","title":"plinkQC 0.3.0","text":"CRAN release: 2019-10-19","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"major-changes-0-3-0","dir":"Changelog","previous_headings":"","what":"major changes","title":"plinkQC 0.3.0","text":"Relationship filter can handle complicated relationship scenarios observed plant genotype sets (fixed #11) code moved meyer-lab repository: https://github.com/meyer-lab-cshl/plinkQC","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"plinkqc-023","dir":"Changelog","previous_headings":"","what":"plinkQC 0.2.3","title":"plinkQC 0.2.3","text":"CRAN release: 2019-09-25","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"major-changes-0-2-3","dir":"Changelog","previous_headings":"","what":"major changes","title":"plinkQC 0.2.3","text":"Enable return overview plots ggplot object (fixes #6 ab2e840 101e74e) Relationship filter now deals complicated relationship scenarios observed plant genotype sets (addresses #11)","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"minor-changes-0-2-3","dir":"Changelog","previous_headings":"","what":"minor changes","title":"plinkQC 0.2.3","text":"give user option choose maf threshold relatedness filtering (relates #3)","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"bug-fixes-0-2-3","dir":"Changelog","previous_headings":"","what":"bug fixes","title":"plinkQC 0.2.3","text":"Include check zero related individuals fixing #3 1445a88 Include check case samples fail perIndividual QC 894acc1 0464224) Include checks diagonal derived relationship estimates, estimate data containing related individuals; addresses #11 Fix command genotype conversion 1000Genomes vignette, addressing issue #10 fix missing rownames error overviewPerIndividualQC, relatedness check included (issue #16, fc7a38b) fix vignette mismatch (issue #16, 09dcd59)","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"plinkqc-022","dir":"Changelog","previous_headings":"","what":"plinkQC 0.2.2","title":"plinkQC 0.2.2","text":"CRAN release: 2019-06-19","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"minor-changes-0-2-2","dir":"Changelog","previous_headings":"","what":"minor changes","title":"plinkQC 0.2.2","text":"Fix IDs written fail.IDs file: previous versions wrote IID,IID, now fixed FID, IID (fixes #2).","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"plinkqc-021","dir":"Changelog","previous_headings":"","what":"plinkQC 0.2.1","title":"plinkQC 0.2.1","text":"CRAN release: 2019-03-01","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"minor-changes-0-2-1","dir":"Changelog","previous_headings":"","what":"minor changes","title":"plinkQC 0.2.1","text":"Fix path check bug checkPlink Include test data build!","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"plinkqc-020","dir":"Changelog","previous_headings":"","what":"plinkQC 0.2.0","title":"plinkQC 0.2.0","text":"CRAN release: 2018-11-09","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"major-changes-0-2-0","dir":"Changelog","previous_headings":"","what":"major changes","title":"plinkQC 0.2.0","text":"system calls plink conducted sys::exec_wait - solve platform dependent issues, mainly compatibility windows. Make path construction compatible windows. path2plink now requires full path plink executable, tilde expansion simple pointer directory supported. Fix bug return cleanData function: list now contains keep fail IDs. Fix bug return maf computation: fail.IDs exist, set fail_samples zero.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"minor-changes-0-2-0","dir":"Changelog","previous_headings":"","what":"minor changes","title":"plinkQC 0.2.0","text":"IBD-fail.IDs now saved without column names consistent xxx-fail.IDs files. Include additional progress messages cleanData() Remove default double-specification mafTh macTh use checkPlink return correct path2plink export make checkPlink directly accesible user.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"plinkqc-011","dir":"Changelog","previous_headings":"","what":"plinkQC 0.1.1","title":"plinkQC 0.1.1","text":"CRAN release: 2018-11-06","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"major-changes-0-1-1","dir":"Changelog","previous_headings":"","what":"major changes","title":"plinkQC 0.1.1","text":"run_check_relatedness save IBD estimates individuals whose estimates higher threshold.","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"minor-changes-0-1-1","dir":"Changelog","previous_headings":"","what":"minor changes","title":"plinkQC 0.1.1","text":"Fix examples vignettes 1000 Genomes HapMap III reference. Change file access function examples Add additional checks check_ancestry fix missing refSamplesFile test","code":""},{"path":"https://meyer-lab-cshl.github.io/plinkQC/news/index.html","id":"plinkqc-010","dir":"Changelog","previous_headings":"","what":"plinkQC 0.1.0","title":"plinkQC 0.1.0","text":"CRAN release: 2018-11-04 Added NEWS.md file track changes package.","code":""}]
